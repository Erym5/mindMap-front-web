(this.webpackJsonp=this.webpackJsonp||[]).push([[2],{"/csM":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_less_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_headerLink_vue_vue_type_style_index_0_id_0b0a62fe_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("QX8r");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_less_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_headerLink_vue_vue_type_style_index_0_id_0b0a62fe_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_less_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_headerLink_vue_vue_type_style_index_0_id_0b0a62fe_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/components/common/headerLink.vue?')},"/fdn":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var runtimes = [];\n\n  function assemble(runtime) {\n    runtimes.push(runtime);\n  }\n\n  function KMEditor(selector) {\n    console.info("selector====", selector);\n    this.selector = selector;\n    for (var i = 0; i < runtimes.length; i++) {\n      if (typeof runtimes[i] == \'function\') {\n        runtimes[i].call(this, this);\n      }\n    }\n  }\n\n  KMEditor.assemble = assemble;\n\n  assemble(__webpack_require__("dkMl"));\n  assemble(__webpack_require__("dSb+"));\n  assemble(__webpack_require__("RIOO"));\n  assemble(__webpack_require__("vaHd"));\n  assemble(__webpack_require__("bSn8"));\n  assemble(__webpack_require__("RVn+"));\n  assemble(__webpack_require__("JAA7"));\n  assemble(__webpack_require__("lrL8"));\n  assemble(__webpack_require__("cxy/"));\n  assemble(__webpack_require__("BR1M"));\n  assemble(__webpack_require__("Ashh"));\n  assemble(__webpack_require__("iIxm"));\n  assemble(__webpack_require__("JTCX"));\n  assemble(__webpack_require__("MPEW"));\n  assemble(__webpack_require__("oOAV"));\n\n  return module.exports = KMEditor;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/editor.js?')},"/qK9":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var keymap = __webpack_require__(\"8uhi\");\n\n  var CTRL_MASK = 0x1000;\n  var ALT_MASK = 0x2000;\n  var SHIFT_MASK = 0x4000;\n\n  function hash(unknown) {\n    if (typeof unknown == 'string') {\n      return hashKeyExpression(unknown);\n    }\n    return hashKeyEvent(unknown);\n  }\n\n  function is(a, b) {\n    return a && b && hash(a) == hash(b);\n  }\n  exports.hash = hash;\n  exports.is = is;\n\n  function hashKeyEvent(keyEvent) {\n    var hashCode = 0;\n    if (keyEvent.ctrlKey || keyEvent.metaKey) {\n      hashCode |= CTRL_MASK;\n    }\n    if (keyEvent.altKey) {\n      hashCode |= ALT_MASK;\n    }\n    if (keyEvent.shiftKey) {\n      hashCode |= SHIFT_MASK;\n    }\n    if ([16, 17, 18, 91].indexOf(keyEvent.keyCode) === -1) {\n      if (keyEvent.keyCode === 229 && keyEvent.keyIdentifier) {\n        return hashCode |= parseInt(keyEvent.keyIdentifier.substr(2), 16);\n      }\n      hashCode |= keyEvent.keyCode;\n    }\n    return hashCode;\n  }\n\n  function hashKeyExpression(keyExpression) {\n    var hashCode = 0;\n    keyExpression.toLowerCase().split(/\\s*\\+\\s*/).forEach(function (name) {\n      switch (name) {\n        case 'ctrl':\n        case 'cmd':\n          hashCode |= CTRL_MASK;\n          break;\n        case 'alt':\n          hashCode |= ALT_MASK;\n          break;\n        case 'shift':\n          hashCode |= SHIFT_MASK;\n          break;\n        default:\n          hashCode |= keymap[name];\n      }\n    });\n    return hashCode;\n  }\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/tool/key.js?")},"0rPY":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_find_vue_vue_type_style_index_0_id_23ef0bd2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("ws/B");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_find_vue_vue_type_style_index_0_id_23ef0bd2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_find_vue_vue_type_style_index_0_id_23ef0bd2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/views/find.vue?')},"403d":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportMarkdown\", function() { return exportMarkdown; });\nvar LINE_ENDING_SPLITER = /\\r\\n|\\r|\\n/;\nvar EMPTY_LINE = '';\nvar NOTE_MARK_START = '\x3c!--Note--\x3e';\nvar NOTE_MARK_CLOSE = '\x3c!--/Note--\x3e';\n\nfunction exportMarkdown(minder) {\n  var minds = minder.exportJson();\n  try {\n    var link = document.createElement('a');\n    var blob = new Blob(['\\uFEFF' + encode(minds.root, 0)], {\n      type: 'markdown'\n    });\n    link.href = window.URL.createObjectURL(blob);\n    link.download = minds.root.data.text + '.md';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\nfunction encode(json) {\n  return _build(json, 1).join('\\n');\n}\n\nfunction _build(node, level) {\n  var lines = [];\n\n  level = level || 1;\n\n  var sharps = _generateHeaderSharp(level);\n  lines.push(sharps + ' ' + node.data.text);\n  lines.push(EMPTY_LINE);\n\n  var note = node.data.note;\n  if (note) {\n    var hasSharp = /^#/.test(note);\n    if (hasSharp) {\n      lines.push(NOTE_MARK_START);\n      note = note.replace(/^#+/gm, function ($0) {\n        return sharps + $0;\n      });\n    }\n    lines.push(note);\n    if (hasSharp) {\n      lines.push(NOTE_MARK_CLOSE);\n    }\n    lines.push(EMPTY_LINE);\n  }\n\n  if (node.children) node.children.forEach(function (child) {\n    lines = lines.concat(_build(child, level + 1));\n  });\n\n  return lines;\n}\n\nfunction _generateHeaderSharp(level) {\n  var sharps = '';\n  while (level--) {\n    sharps += '#';\n  }return sharps;\n}\n\nfunction decode(markdown) {\n\n  var json,\n      parentMap = {},\n      lines,\n      line,\n      lineInfo,\n      level,\n      node,\n      parent,\n      noteProgress,\n      codeBlock;\n\n  // 一级标题转换 `{title}\\n===` => `# {title}`\n  markdown = markdown.replace(/^(.+)\\n={3,}/, function ($0, $1) {\n    return '# ' + $1;\n  });\n\n  lines = markdown.split(LINE_ENDING_SPLITER);\n\n  // 按行分析\n  for (var i = 0; i < lines.length; i++) {\n    line = lines[i];\n\n    lineInfo = _resolveLine(line);\n\n    // 备注标记处理\n    if (lineInfo.noteClose) {\n      noteProgress = false;\n      continue;\n    } else if (lineInfo.noteStart) {\n      noteProgress = true;\n      continue;\n    }\n\n    // 代码块处理\n    codeBlock = lineInfo.codeBlock ? !codeBlock : codeBlock;\n\n    // 备注条件：备注标签中，非标题定义，或标题越位\n    if (noteProgress || codeBlock || !lineInfo.level || lineInfo.level > level + 1) {\n      if (node) _pushNote(node, line);\n      continue;\n    }\n\n    // 标题处理\n    level = lineInfo.level;\n    node = _initNode(lineInfo.content, parentMap[level - 1]);\n    parentMap[level] = node;\n  }\n\n  _cleanUp(parentMap[1]);\n  return parentMap[1];\n}\n\nfunction _initNode(text, parent) {\n  var node = {\n    data: {\n      text: text,\n      note: ''\n    }\n  };\n  if (parent) {\n    if (parent.children) parent.children.push(node);else parent.children = [node];\n  }\n  return node;\n}\n\nfunction _pushNote(node, line) {\n  node.data.note += line + '\\n';\n}\n\nfunction _isEmpty(line) {\n  return !/\\S/.test(line);\n}\n\nfunction _resolveLine(line) {\n  var match = /^(#+)?\\s*(.*)$/.exec(line);\n  return {\n    level: match[1] && match[1].length || null,\n    content: match[2],\n    noteStart: line == NOTE_MARK_START,\n    noteClose: line == NOTE_MARK_CLOSE,\n    codeBlock: /^\\s*```/.test(line)\n  };\n}\n\nfunction _cleanUp(node) {\n  if (!/\\S/.test(node.data.note)) {\n    node.data.note = null;\n    delete node.data.note;\n  } else {\n    var notes = node.data.note.split('\\n');\n    while (notes.length && !/\\S/.test(notes[0])) {\n      notes.shift();\n    }while (notes.length && !/\\S/.test(notes[notes.length - 1])) {\n      notes.pop();\n    }node.data.note = notes.join('\\n');\n  }\n  if (node.children) node.children.forEach(_cleanUp);\n}\n\n\n\n//# sourceURL=webpack:///./src/script/protocol/markdown.js?")},"4bJk":function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/components/common/Nav.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},"85aE":function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__.p + "static/img/userLogo.b08eecb.png";\n\n//# sourceURL=webpack:///./src/assets/img/userLogo.png?')},"8uhi":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var keymap = {\n\n    'Shift': 16,\n    'Control': 17,\n    'Alt': 18,\n    'CapsLock': 20,\n\n    'BackSpace': 8,\n    'Tab': 9,\n    'Enter': 13,\n    'Esc': 27,\n    'Space': 32,\n\n    'PageUp': 33,\n    'PageDown': 34,\n    'End': 35,\n    'Home': 36,\n\n    'Insert': 45,\n\n    'Left': 37,\n    'Up': 38,\n    'Right': 39,\n    'Down': 40,\n\n    'Direction': {\n      37: 1,\n      38: 1,\n      39: 1,\n      40: 1\n    },\n\n    'Del': 46,\n\n    'NumLock': 144,\n\n    'Cmd': 91,\n    'CmdFF': 224,\n    'F1': 112,\n    'F2': 113,\n    'F3': 114,\n    'F4': 115,\n    'F5': 116,\n    'F6': 117,\n    'F7': 118,\n    'F8': 119,\n    'F9': 120,\n    'F10': 121,\n    'F11': 122,\n    'F12': 123,\n\n    '`': 192,\n    '=': 187,\n    '-': 189,\n\n    '/': 191,\n    '.': 190\n  };\n\n  for (var key in keymap) {\n    if (keymap.hasOwnProperty(key)) {\n      keymap[key.toLowerCase()] = keymap[key];\n    }\n  }\n  var aKeyCode = 65;\n  var aCharCode = 'a'.charCodeAt(0);\n\n  'abcdefghijklmnopqrstuvwxyz'.split('').forEach(function (letter) {\n    keymap[letter] = aKeyCode + (letter.charCodeAt(0) - aCharCode);\n  });\n\n  var n = 9;\n  do {\n    keymap[n.toString()] = n + 48;\n  } while (--n);\n\n  module.exports = keymap;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/tool/keymap.js?")},"8zQj":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var format = __webpack_require__(\"FNhY\");\n\n  function noop() {}\n\n  function stringHash(str) {\n    var hash = 0;\n    for (var i = 0; i < str.length; i++) {\n      hash += str.charCodeAt(i);\n    }\n    return hash;\n  }\n\n  function Debug(flag) {\n    var debugMode = this.flaged = window.location.search.indexOf(flag) != -1;\n\n    if (debugMode) {\n      var h = stringHash(flag) % 360;\n\n      var flagStyle = format('background: hsl({0}, 50%, 80%); ' + 'color: hsl({0}, 100%, 30%); ' + 'padding: 2px 3px; ' + 'margin: 1px 3px 0 0;' + 'border-radius: 2px;', h);\n\n      var textStyle = 'background: none; color: black;';\n      this.log = function () {\n        var output = format.apply(null, arguments);\n        console.log(format('%c{0}%c{1}', flag, output), flagStyle, textStyle);\n      };\n    } else {\n      this.log = noop;\n    }\n  }\n\n  return module.exports = Debug;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/tool/debug.js?")},"A0++":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("f1rw");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/App.vue?')},AsA8:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportSVG\", function() { return exportSVG; });\nfunction exportSVG(minder) {\n\n  var paper = minder.getPaper();\n  var paperTransform = paper.shapeNode.getAttribute('transform');\n  var svgXml;\n  var $svg;\n\n  var renderContainer = minder.getRenderContainer();\n  var renderBox = renderContainer.getRenderBox();\n  var transform = renderContainer.getTransform();\n  var width = renderBox.width;\n  var height = renderBox.height;\n  var padding = 20;\n\n  paper.shapeNode.setAttribute('transform', 'translate(0.5, 0.5)');\n  svgXml = paper.container.innerHTML;\n  console.log(svgXml);\n  paper.shapeNode.setAttribute('transform', paperTransform);\n\n  $svg = $(svgXml).filter('svg');\n  $svg.attr({\n    width: width + padding * 2 | 0,\n    height: height + padding * 2 | 0,\n    style: 'font-family: Arial, \"Microsoft Yahei\",  \"Heiti SC\"; background: ' + minder.getStyle('background')\n  });\n  $svg[0].setAttribute('viewBox', [renderBox.x - padding | 0, renderBox.y - padding | 0, width + padding * 2 | 0, height + padding * 2 | 0].join(' '));\n\n  svgXml = $('<div></div>').append($svg).html();\n  svgXml = $('<div></div>').append($svg).html();\n  svgXml = svgXml.replace(/&nbsp;/g, '&#xa0;');\n\n  var blob = new Blob([svgXml], {\n    type: 'image/svg+xml'\n  });\n\n  var DOMURL = window.URL || window.webkitURL || window;\n  var svgUrl = DOMURL.createObjectURL(blob);\n\n  var mind = editor.minder.exportJson();\n  downloadSVG(svgUrl, mind.root.data.text);\n}\n\nfunction downloadSVG(fileURI, fileName) {\n  try {\n    var link = document.createElement('a');\n    link.href = fileURI;\n    link.download = fileName + '.svg';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(\"xeH2\")))\n\n//# sourceURL=webpack:///./src/script/protocol/svg.js?")},Ashh:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  function HistoryRuntime() {\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n\n    var MAX_HISTORY = 100;\n\n    var lastSnap;\n    var patchLock;\n    var undoDiffs;\n    var redoDiffs;\n\n    function reset() {\n      undoDiffs = [];\n      redoDiffs = [];\n      lastSnap = minder.exportJson();\n    }\n\n    var _objectKeys = function () {\n      if (Object.keys) return Object.keys;\n\n      return function (o) {\n        var keys = [];\n        for (var i in o) {\n          if (o.hasOwnProperty(i)) {\n            keys.push(i);\n          }\n        }\n        return keys;\n      };\n    }();\n\n    function escapePathComponent(str) {\n      if (str.indexOf('/') === -1 && str.indexOf('~') === -1) return str;\n      return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n    }\n\n    function deepClone(obj) {\n      if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === \"object\") {\n        return JSON.parse(JSON.stringify(obj));\n      } else {\n        return obj;\n      }\n    }\n\n    function _generate(mirror, obj, patches, path) {\n      var newKeys = _objectKeys(obj);\n      var oldKeys = _objectKeys(mirror);\n      var changed = false;\n      var deleted = false;\n\n      for (var t = oldKeys.length - 1; t >= 0; t--) {\n        var key = oldKeys[t];\n        var oldVal = mirror[key];\n        if (obj.hasOwnProperty(key)) {\n          var newVal = obj[key];\n          if ((typeof oldVal === 'undefined' ? 'undefined' : _typeof(oldVal)) == \"object\" && oldVal != null && (typeof newVal === 'undefined' ? 'undefined' : _typeof(newVal)) == \"object\" && newVal != null) {\n            _generate(oldVal, newVal, patches, path + \"/\" + escapePathComponent(key));\n          } else {\n            if (oldVal != newVal) {\n              changed = true;\n              patches.push({\n                op: \"replace\",\n                path: path + \"/\" + escapePathComponent(key),\n                value: deepClone(newVal)\n              });\n            }\n          }\n        } else {\n          patches.push({\n            op: \"remove\",\n            path: path + \"/\" + escapePathComponent(key)\n          });\n          deleted = true; // property has been deleted\n        }\n      }\n\n      if (!deleted && newKeys.length == oldKeys.length) {\n        return;\n      }\n\n      for (var t = 0; t < newKeys.length; t++) {\n        var key = newKeys[t];\n        if (!mirror.hasOwnProperty(key)) {\n          patches.push({\n            op: \"add\",\n            path: path + \"/\" + escapePathComponent(key),\n            value: deepClone(obj[key])\n          });\n        }\n      }\n    }\n\n    function jsonDiff(tree1, tree2) {\n      var patches = [];\n      _generate(tree1, tree2, patches, '');\n      return patches;\n    }\n\n    function makeUndoDiff() {\n      var headSnap = minder.exportJson();\n      var diff = jsonDiff(headSnap, lastSnap);\n      if (diff.length) {\n        undoDiffs.push(diff);\n        while (undoDiffs.length > MAX_HISTORY) {\n          undoDiffs.shift();\n        }\n        lastSnap = headSnap;\n        return true;\n      }\n    }\n\n    function makeRedoDiff() {\n      var revertSnap = minder.exportJson();\n      redoDiffs.push(jsonDiff(revertSnap, lastSnap));\n      lastSnap = revertSnap;\n    }\n\n    function undo() {\n      patchLock = true;\n      var undoDiff = undoDiffs.pop();\n      if (undoDiff) {\n        minder.applyPatches(undoDiff);\n        makeRedoDiff();\n      }\n      patchLock = false;\n    }\n\n    function redo() {\n      patchLock = true;\n      var redoDiff = redoDiffs.pop();\n      if (redoDiff) {\n        minder.applyPatches(redoDiff);\n        makeUndoDiff();\n      }\n      patchLock = false;\n    }\n\n    function changed() {\n      if (patchLock) return;\n      if (makeUndoDiff()) redoDiffs = [];\n    }\n\n    function hasUndo() {\n      return !!undoDiffs.length;\n    }\n\n    function hasRedo() {\n      return !!redoDiffs.length;\n    }\n\n    function updateSelection(e) {\n      if (!patchLock) return;\n      var patch = e.patch;\n      switch (patch.express) {\n        case 'node.add':\n          minder.select(patch.node.getChild(patch.index), true);\n          break;\n        case 'node.remove':\n        case 'data.replace':\n        case 'data.remove':\n        case 'data.add':\n          minder.select(patch.node, true);\n          break;\n      }\n    }\n\n    this.history = {\n      reset: reset,\n      undo: undo,\n      redo: redo,\n      hasUndo: hasUndo,\n      hasRedo: hasRedo\n    };\n    reset();\n    minder.on('contentchange', changed);\n    minder.on('import', reset);\n    minder.on('patch', updateSelection);\n\n    var main = hotbox.state('main');\n    main.button({\n      position: 'bottom',\n      label: '撤销',\n      key: 'Ctrl + Z',\n      enable: hasUndo,\n      action: undo,\n      next: 'idle'\n    });\n    main.button({\n      position: 'bottom',\n      label: '重做',\n      key: 'Ctrl + Y',\n      enable: hasRedo,\n      action: redo,\n      next: 'idle'\n    });\n  }\n\n  // window.diff = jsonDiff;\n\n  return module.exports = HistoryRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/history.js?")},BR1M:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  function NodeRuntime() {\n    var runtime = this;\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n    var fsm = this.fsm;\n\n    var main = hotbox.state('main');\n\n    var buttons = ['前移:Alt+Up:ArrangeUp', '下级:Tab|Insert:AppendChildNode', '同级:Enter:AppendSiblingNode', '后移:Alt+Down:ArrangeDown', '删除:Delete|Backspace:RemoveNode', '上级:Shift+Tab|Shift+Insert:AppendParentNode'];\n\n    var AppendLock = 0;\n\n    buttons.forEach(function (button) {\n      var parts = button.split(':');\n      var label = parts.shift();\n      var key = parts.shift();\n      var command = parts.shift();\n      main.button({\n        position: 'ring',\n        label: label,\n        key: key,\n        action: function action() {\n          if (command.indexOf('Append') === 0) {\n            var afterAppend = function afterAppend() {\n              if (! --AppendLock) {\n                runtime.editText();\n              }\n              minder.off('layoutallfinish', afterAppend);\n            };\n\n            AppendLock++;\n            minder.execCommand(command, '分支主题');\n\n            minder.on('layoutallfinish', afterAppend);\n          } else {\n            minder.execCommand(command);\n            fsm.jump('normal', 'command-executed');\n          }\n        },\n        enable: function enable() {\n          return minder.queryCommandState(command) != -1;\n        }\n      });\n    });\n\n    main.button({\n      position: 'ring',\n      key: '/',\n      action: function action() {\n        if (!minder.queryCommandState('expand')) {\n          minder.execCommand('expand');\n        } else if (!minder.queryCommandState('collapse')) {\n          minder.execCommand('collapse');\n        }\n      },\n      enable: function enable() {\n        return minder.queryCommandState('expand') != -1 || minder.queryCommandState('collapse') != -1;\n      },\n      beforeShow: function beforeShow() {\n        if (!minder.queryCommandState('expand')) {\n          this.$button.children[0].innerHTML = '展开';\n        } else {\n          this.$button.children[0].innerHTML = '收起';\n        }\n      }\n    });\n  }\n\n  return module.exports = NodeRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/node.js?")},Bbjp:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  if (!('innerText' in document.createElement('a')) && 'getSelection' in window) {\n    HTMLElement.prototype.__defineGetter__('innerText', function () {\n      var selection = window.getSelection(),\n          ranges = [],\n          str,\n          i;\n\n      for (i = 0; i < selection.rangeCount; i++) {\n        ranges[i] = selection.getRangeAt(i);\n      }\n\n      selection.removeAllRanges();\n      selection.selectAllChildren(this);\n      str = selection.toString();\n      selection.removeAllRanges();\n      for (i = 0; i < ranges.length; i++) {\n        selection.addRange(ranges[i]);\n      }\n      return str;\n    });\n    HTMLElement.prototype.__defineSetter__('innerText', function (text) {\n      this.innerHTML = (text || '').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\\n/g, '<br>');\n    });\n  }\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/tool/innertext.js?")},CYm2:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportFreeMind\", function() { return exportFreeMind; });\nvar priorities = [{ jp: 1, mp: 'full-1' }, { jp: 2, mp: 'full-2' }, { jp: 3, mp: 'full-3' }, { jp: 4, mp: 'full-4' }, { jp: 5, mp: 'full-5' }, { jp: 6, mp: 'full-6' }, { jp: 7, mp: 'full-7' }, { jp: 8, mp: 'full-8' }];\nvar mmVersion = '<map version=\"1.0.1\">\\n';\nvar iconTextPrefix = '<icon BUILTIN=\"';\nvar iconTextSuffix = '\"/>\\n';\nvar nodeCreated = '<node CREATED=\"';\nvar nodeId = '\" ID=\"';\nvar nodeText = '\" TEXT=\"';\nvar nodeSuffix = '\">\\n';\nvar entityNode = '</node>\\n';\nvar entityMap = '</map>';\n\nfunction exportFreeMind(minder) {\n  var minds = minder.exportJson();\n  var mmContent = mmVersion + traverseJson(minds.root) + entityNode + entityMap;\n  try {\n    var link = document.createElement('a');\n    var blob = new Blob(['\\uFEFF' + mmContent], {\n      type: 'text/xml'\n    });\n    link.href = window.URL.createObjectURL(blob);\n    link.download = minds.root.data.text + '.mm';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\nfunction traverseJson(node) {\n  var result = \"\";\n  if (!node) {\n    return;\n  }\n  result += concatNodes(node);\n  if (node.children && node.children.length > 0) {\n    for (var i = 0; i < node.children.length; i++) {\n      result += traverseJson(node.children[i]);\n      result += entityNode;\n    }\n  }\n  return result;\n}\n\nfunction concatNodes(node) {\n  var result = \"\";\n  var datas = node.data;\n  result += nodeCreated + datas.created + nodeId + datas.id + nodeText + datas.text + nodeSuffix;\n  if (datas.priority) {\n    var mapped = priorities.find(function (d) {\n      return d.jp == datas.priority;\n    });\n    if (mapped) {\n      result += iconTextPrefix + mapped.mp + iconTextSuffix;\n    }\n  }\n  return result;\n}\n\n\n\n//# sourceURL=webpack:///./src/script/protocol/freemind.js?")},FNhY:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "format", function() { return format; });\nvar _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };\n\nfunction format(template, args) {\n  if ((typeof args === \'undefined\' ? \'undefined\' : _typeof(args)) != \'object\') {\n    args = [].slice.call(arguments, 1);\n  }\n  return String(template).replace(/\\{(\\w+)\\}/ig, function (match, $key) {\n    return args[$key] || $key;\n  });\n}\n\n\n//# sourceURL=webpack:///./src/script/tool/format.js?')},GPq9:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_Nav_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("4bJk");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_Nav_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_Nav_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/components/common/Nav.vue?')},GX2X:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportTextTree\", function() { return exportTextTree; });\nvar LINE_ENDING = '\\r';\nvar LINE_ENDING_SPLITER = /\\r\\n|\\r|\\n/;\nvar TAB_CHAR = '\\t';\n\nfunction exportTextTree(minder) {\n  var minds = minder.exportJson();\n  try {\n    var link = document.createElement('a');\n    var blob = new Blob(['\\uFEFF' + encode(minds.root, 0)], {\n      type: 'text/plain'\n    });\n    link.href = window.URL.createObjectURL(blob);\n    link.download = minds.root.data.text + '.txt';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\nfunction repeat(s, n) {\n  var result = '';\n  while (n--) {\n    result += s;\n  }return result;\n}\n\nfunction encode(json, level) {\n  var local = '';\n  level = level || 0;\n  local += repeat(TAB_CHAR, level);\n  local += json.data.text + LINE_ENDING;\n  if (json.children) {\n    json.children.forEach(function (child) {\n      local += encode(child, level + 1);\n    });\n  }\n  return local;\n}\n\nfunction isEmpty(line) {\n  return !/\\S/.test(line);\n}\n\nfunction getLevel(line) {\n  var level = 0;\n  while (line.charAt(level) === TAB_CHAR) {\n    level++;\n  }return level;\n}\n\nfunction getNode(line) {\n  return {\n    data: {\n      text: line.replace(new RegExp('^' + TAB_CHAR + '*'), '')\n    }\n  };\n}\n\n/**\r\n * 文本解码\r\n *\r\n * @param {string} local 文本内容\r\n * @param {=boolean} root 自动根节点\r\n * @return {Object} 返回解析后节点\r\n */\nfunction decode(local, root) {\n  var json,\n      offset,\n      parentMap = {},\n      lines = local.split(LINE_ENDING_SPLITER),\n      line,\n      level,\n      node;\n\n  function addChild(parent, child) {\n    var children = parent.children || (parent.children = []);\n    children.push(child);\n  }\n  if (root) {\n    parentMap[0] = json = getNode('root');\n    offset = 1;\n  } else {\n    offset = 0;\n  }\n\n  for (var i = 0; i < lines.length; i++) {\n    line = lines[i];\n    if (isEmpty(line)) continue;\n\n    level = getLevel(line) + offset;\n    node = getNode(line);\n\n    if (level === 0) {\n      if (json) {\n        throw new Error('Invalid local format');\n      }\n      json = node;\n    } else {\n      if (!parentMap[level - 1]) {\n        throw new Error('Invalid local format');\n      }\n      addChild(parentMap[level - 1], node);\n    }\n    parentMap[level] = node;\n  }\n  return json;\n}\n\n\n\n//# sourceURL=webpack:///./src/script/protocol/plain.js?")},HRQ7:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportPNGImage\", function() { return exportPNGImage; });\nvar DOMURL = window.URL || window.webkitURL || window;\n\nfunction downloadImage(fileURI, fileName) {\n  try {\n    var link = document.createElement('a');\n    link.href = fileURI;\n    link.download = fileName + '.png';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\nfunction loadImage(url, callback) {\n  return new Promise(function (resolve, reject) {\n    var image = document.createElement('img');\n    image.onload = function () {\n      resolve(this);\n    };\n    image.onerror = function (err) {\n      reject(err);\n    };\n    image.crossOrigin = '';\n    image.src = url;\n  });\n}\n\nfunction getSVGInfo(minder) {\n  var paper = minder.getPaper(),\n      paperTransform,\n      domContainer = paper.container,\n      svgXml,\n      $svg,\n      renderContainer = minder.getRenderContainer(),\n      renderBox = renderContainer.getRenderBox(),\n      width = renderBox.width + 1,\n      height = renderBox.height + 1,\n      blob,\n      svgUrl,\n      img;\n\n  // 保存原始变换，并且移动到合适的位置\n  paperTransform = paper.shapeNode.getAttribute('transform');\n  paper.shapeNode.setAttribute('transform', 'translate(0.5, 0.5)');\n  renderContainer.translate(-renderBox.x, -renderBox.y);\n\n  // 获取当前的 XML 代码\n  svgXml = paper.container.innerHTML;\n\n  // 回复原始变换及位置\n  renderContainer.translate(renderBox.x, renderBox.y);\n  paper.shapeNode.setAttribute('transform', paperTransform);\n\n  // 过滤内容\n  $svg = $(svgXml).filter('svg');\n  $svg.attr({\n    width: renderBox.width + 1,\n    height: renderBox.height + 1,\n    style: 'font-family: Arial, \"Microsoft Yahei\",\"Heiti SC\";'\n  });\n\n  svgXml = $('<div></div>').append($svg).html();\n\n  // Dummy IE\n  svgXml = svgXml.replace(' xmlns=\"http://www.w3.org/2000/svg\" xmlns:NS1=\"\" NS1:ns1:xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:NS2=\"\" NS2:xmlns:ns1=\"\"', '');\n\n  // svg 含有 &nbsp; 符号导出报错 Entity 'nbsp' not defined\n  svgXml = svgXml.replace(/&nbsp;/g, '&#xa0;');\n\n  blob = new Blob([svgXml], {\n    type: 'image/svg+xml'\n  });\n\n  svgUrl = DOMURL.createObjectURL(blob);\n\n  return {\n    width: width,\n    height: height,\n    dataUrl: svgUrl,\n    xml: svgXml\n  };\n}\n\nfunction exportPNGImage(minder) {\n\n  /* 绘制 PNG 的画布及上下文 */\n  var canvas = document.createElement('canvas');\n  var ctx = canvas.getContext('2d');\n\n  /* 尝试获取背景图片 URL 或背景颜色 */\n  var bgDeclare = minder.getStyle('background').toString();\n  var bgUrl = /url\\((.+)\\)/.exec(bgDeclare);\n  var bgColor = kity.Color.parse(bgDeclare);\n\n  /* 获取 SVG 文件内容 */\n  var svgInfo = getSVGInfo(minder);\n  var width = svgInfo.width;\n  var height = svgInfo.height;\n  var svgDataUrl = svgInfo.dataUrl;\n\n  /* 画布的填充大小 */\n  var padding = 20;\n\n  canvas.width = width + padding * 2;\n  canvas.height = height + padding * 2;\n\n  function fillBackground(ctx, style) {\n    ctx.save();\n    ctx.fillStyle = style;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.restore();\n  }\n\n  function drawImage(ctx, image, x, y) {\n    ctx.drawImage(image, x, y);\n  }\n\n  function generateDataUrl(canvas) {\n    try {\n      var url = canvas.toDataURL('png');\n      return url;\n    } catch (e) {\n      throw new Error('当前浏览器版本不支持导出 PNG 功能，请尝试升级到最新版本！');\n    }\n  }\n\n  function drawSVG(minder) {\n    var mind = editor.minder.exportJson();\n    if (typeof window.canvg != 'undefined') {\n      return new Promise(function (resolve) {\n        window.canvg(canvas, svgInfo.xml, {\n          ignoreMouse: true,\n          ignoreAnimation: true,\n          ignoreDimensions: true,\n          ignoreClear: true,\n          offsetX: padding,\n          offsetY: padding,\n          renderCallback: function renderCallback() {\n            downloadImage(generateDataUrl(canvas), mind.root.data.text);\n          }\n        });\n      });\n    } else {\n      return loadImage(svgDataUrl).then(function (svgImage) {\n        drawImage(ctx, svgImage, padding, padding);\n        DOMURL.revokeObjectURL(svgDataUrl);\n        downloadImage(generateDataUrl(canvas), mind.root.data.text);\n      });\n    }\n  }\n\n  if (bgUrl) {\n    loadImage(bgUrl[1]).then(function (image) {\n      fillBackground(ctx, ctx.createPattern(image, 'repeat'));\n      drawSVG(minder);\n    });\n  } else {\n    fillBackground(ctx, bgColor.toString());\n    drawSVG(minder);\n  }\n}\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(\"xeH2\")))\n\n//# sourceURL=webpack:///./src/script/protocol/png.js?")},I0VB:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_home_vue_vue_type_style_index_0_id_181c3921_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("cfRE");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_home_vue_vue_type_style_index_0_id_181c3921_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_home_vue_vue_type_style_index_0_id_181c3921_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/views/home.vue?')},JAA7:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  function MimeType() {\n    var SPLITOR = '\\uFEFF';\n    var MIMETYPE = {\n      'application/km': '\\uFFFF'\n    };\n    var SIGN = {\n      '\\uFEFF': 'SPLITOR',\n      '\\uFFFF': 'application/km'\n    };\n\n    function process(mimetype, text) {\n      if (!this.isPureText(text)) {\n        var _mimetype = this.whichMimeType(text);\n        if (!_mimetype) {\n          throw new Error('unknow mimetype!');\n        };\n        text = this.getPureText(text);\n      };\n      if (mimetype === false) {\n        return text;\n      };\n      return mimetype + SPLITOR + text;\n    }\n\n    this.registMimeTypeProtocol = function (type, sign) {\n      if (sign && SIGN[sign]) {\n        throw new Error('sing has registed!');\n      }\n      if (type && !!MIMETYPE[type]) {\n        throw new Error('mimetype has registed!');\n      };\n      SIGN[sign] = type;\n      MIMETYPE[type] = sign;\n    };\n\n    this.getMimeTypeProtocol = function (type, text) {\n      var mimetype = MIMETYPE[type] || false;\n\n      if (text === undefined) {\n        return process.bind(this, mimetype);\n      };\n\n      return process(mimetype, text);\n    };\n\n    this.getSpitor = function () {\n      return SPLITOR;\n    };\n\n    this.getMimeType = function (sign) {\n      if (sign !== undefined) {\n        return SIGN[sign] || null;\n      };\n      return MIMETYPE;\n    };\n  }\n\n  MimeType.prototype.isPureText = function (text) {\n    return !~text.indexOf(this.getSpitor());\n  };\n\n  MimeType.prototype.getPureText = function (text) {\n    if (this.isPureText(text)) {\n      return text;\n    };\n    return text.split(this.getSpitor())[1];\n  };\n\n  MimeType.prototype.whichMimeType = function (text) {\n    if (this.isPureText(text)) {\n      return null;\n    };\n    return this.getMimeType(text.split(this.getSpitor())[0]);\n  };\n\n  function MimeTypeRuntime() {\n    if (this.minder.supportClipboardEvent && !kity.Browser.gecko) {\n      this.MimeType = new MimeType();\n    };\n  }\n\n  return module.exports = MimeTypeRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/clipboard-mimetype.js?")},JTCX:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  function PriorityRuntime() {\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n\n    var main = hotbox.state('main');\n\n    main.button({\n      position: 'top',\n      label: '用例级别',\n      key: 'P',\n      next: 'priority',\n      enable: function enable() {\n        return minder.queryCommandState('priority') != -1;\n      }\n    });\n\n    /*    var priority = hotbox.state('priority');\r\n        '123456789'.replace(/./g, function (p) {\r\n          priority.button({\r\n            position: 'ring',\r\n            label: 'P' + p,\r\n            key: p,\r\n            action: function () {\r\n              minder.execCommand('Priority', p);\r\n            }\r\n          });\r\n        });*/\n    var priority = hotbox.state('priority');\n    '0123'.replace(/./g, function (p) {\n      priority.button({\n        position: 'ring',\n        label: 'P' + p,\n        key: p,\n        action: function action() {\n          minder.execCommand('Priority', Number(p) + 1);\n        }\n      });\n    });\n\n    priority.button({\n      position: 'center',\n      label: '移除',\n      key: 'Del',\n      action: function action() {\n        minder.execCommand('Priority', 0);\n      }\n    });\n\n    priority.button({\n      position: 'top',\n      label: '返回',\n      key: 'esc',\n      next: 'back'\n    });\n  }\n  return module.exports = PriorityRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/priority.js?")},JqqP:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"exportJson\", function() { return exportJson; });\nfunction exportJson(minder) {\n  var minds = minder.exportJson();\n  try {\n    var link = document.createElement('a');\n    var blob = new Blob(['\\uFEFF' + JSON.stringify(minds)], {\n      type: 'text/json'\n    });\n    link.href = window.URL.createObjectURL(blob);\n    link.download = minds.root.data.text + '.json';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  } catch (err) {\n    alert(err);\n  }\n}\n\n\n\n//# sourceURL=webpack:///./src/script/protocol/json.js?")},LbPw:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/components/common/headerLink.vue?vue&type=template&id=0b0a62fe&scoped=true&\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'div\',{staticClass:"user"},[_c(\'el-button\',{on:{"click":_vm.login}},[_vm._v("登录")]),_vm._v(" "),_c(\'el-button\',{on:{"click":_vm.logout}},[_vm._v("登出")])],1),_vm._v(" "),_c(\'el-dropdown\',{staticClass:"header-link",on:{"command":_vm.handleCommand}},[_c(\'span\',{staticClass:"el-dropdown-link"},[_c(\'img\',{staticClass:"user-logo",attrs:{"src":__webpack_require__("85aE"),"alt":""}}),_vm._v(" "),_c(\'i\',{staticClass:"el-icon-arrow-down el-icon--right"})]),_vm._v(" "),_c(\'el-dropdown-menu\',{attrs:{"slot":"dropdown"},slot:"dropdown"},[_c(\'el-dropdown-item\',{attrs:{"command":"/home"}},[_vm._v("首页")]),_vm._v(" "),_c(\'el-dropdown-item\',{attrs:{"command":"/search"}},[_vm._v("搜索")]),_vm._v(" "),_c(\'el-dropdown-item\',{attrs:{"command":"/edit"}},[_vm._v("工具台")]),_vm._v(" "),_c(\'el-dropdown-item\',{attrs:{"command":"/bookshelf"}},[_vm._v("藏书")]),_vm._v(" "),_c(\'el-dropdown-item\',{attrs:{"command":"/find"}},[_vm._v("发现")])],1)],1)],1)}\nvar staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/components/common/headerLink.vue?vue&type=template&id=0b0a62fe&scoped=true&\n\n// EXTERNAL MODULE: ./src/utils/auth.js\nvar auth = __webpack_require__("X4fA");\n\n// EXTERNAL MODULE: external "ELEMENT"\nvar external_ELEMENT_ = __webpack_require__("X3IP");\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/components/common/headerLink.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ var headerLinkvue_type_script_lang_js_ = ({\n  name: "headerLink",\n  methods: {\n    handleCommand: function handleCommand(command) {\n      this.$router.push({\n        path: command\n      });\n    },\n    login: function login() {\n      this.$router.push({\n        path: "/login"\n      });\n    },\n    logout: function logout() {\n      Object(auth["b" /* removeToken */])();\n      Object(auth["c" /* removeUid */])();\n      external_ELEMENT_["Message"].info("账户已退出");\n    }\n  }\n});\n// CONCATENATED MODULE: ./src/components/common/headerLink.vue?vue&type=script&lang=js&\n /* harmony default export */ var common_headerLinkvue_type_script_lang_js_ = (headerLinkvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/components/common/headerLink.vue?vue&type=style&index=0&id=0b0a62fe&lang=less&scoped=true&\nvar headerLinkvue_type_style_index_0_id_0b0a62fe_lang_less_scoped_true_ = __webpack_require__("/csM");\n\n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__("KHd+");\n\n// CONCATENATED MODULE: ./src/components/common/headerLink.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar component = Object(componentNormalizer["a" /* default */])(\n  common_headerLinkvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  "0b0a62fe",\n  null\n  \n)\n\n/* harmony default export */ var headerLink = __webpack_exports__["a"] = (component.exports);\n\n//# sourceURL=webpack:///./src/components/common/headerLink.vue_+_4_modules?')},MPEW:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  function ProgressRuntime() {\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n\n    var main = hotbox.state('main');\n\n    main.button({\n      position: 'top',\n      label: '进度',\n      key: 'G',\n      next: 'progress',\n      enable: function enable() {\n        return minder.queryCommandState('progress') != -1;\n      }\n    });\n\n    var progress = hotbox.state('progress');\n    '012345678'.replace(/./g, function (p) {\n      progress.button({\n        position: 'ring',\n        label: 'G' + p,\n        key: p,\n        action: function action() {\n          minder.execCommand('Progress', parseInt(p) + 1);\n        }\n      });\n    });\n\n    progress.button({\n      position: 'center',\n      label: '移除',\n      key: 'Del',\n      action: function action() {\n        minder.execCommand('Progress', 0);\n      }\n    });\n\n    progress.button({\n      position: 'top',\n      label: '返回',\n      key: 'esc',\n      next: 'back'\n    });\n  }\n\n  return module.exports = ProgressRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/progress.js?")},MfdG:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return mindMapCreate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return mindMapSave; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return updateMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return getMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return getMaps; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return deleteMapById; });\n/* harmony import */ var _utils_request__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("t3Un");\n\n\nfunction mindMapCreate(id) {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].get(\'/api/mind_map/\' + id);\n}\n\nfunction mindMapSave(params) {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].post(\'/api/mind_map/save\', params);\n}\n\nfunction updateMap(params) {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].post(\'/api/mind_map/update\', params);\n}\n\nfunction getMap(mapId) {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].get(\'/api/mind_map/get/\' + mapId);\n}\n\nfunction getMaps() {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].get(\'/api/mind_map/getAll\');\n}\n\nfunction deleteMapById(id) {\n  return _utils_request__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"].delete(\'/api/mind_map/delete\', { params: { mapId: id } });\n}\n\n//# sourceURL=webpack:///./src/api/mindMap.js?')},OHcd:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n    return module.exports = window.kityminder.Minder;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/minder.js?")},QX8r:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/components/common/headerLink.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/less-loader/dist/cjs.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},RIOO:function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_RESULT__;/**\r\n * @fileOverview\r\n *\r\n * 脑图示例运行时\r\n *\r\n * @author: techird\r\n * @copyright: Baidu FEX, 2014\r\n */\n!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var Minder = __webpack_require__("OHcd");\n  console.log("----this -minder-----", this.minder);\n  console.log("----this.selector-----", this.selector);\n\n  function MinderRuntime() {\n    console.log(\'00000Minder00000\', Minder);\n    // 不使用 kityminder 的按键处理，由 ReceiverRuntime 统一处理\n    var minder = new Minder({\n      enableKeyReceiver: false,\n      enableAnimation: true\n    });\n    console.info(\'minder instance\', minder);\n    console.log("----this.selector-----", this.selector);\n\n    // 渲染，初始化\n    minder.renderTo(this.selector);\n    minder.setTheme(null);\n    minder.select(minder.getRoot(), true);\n    minder.execCommand(\'text\', \'中心主题\');\n    console.log("-----minder-----", minder);\n    // 导出给其它 Runtime 使用\n    this.minder = minder;\n    console.log("----this -minder-----", this.minder);\n  }\n\n  return module.exports = MinderRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/minder.js?')},"RVn+":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;/**\r\n * @fileOverview\r\n *\r\n * 文本输入支持\r\n *\r\n * @author: techird\r\n * @copyright: Baidu FEX, 2014\r\n */\n!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  __webpack_require__(\"Bbjp\");\n\n  var Debug = __webpack_require__(\"8zQj\");\n  var debug = new Debug('input');\n\n  function InputRuntime() {\n    var fsm = this.fsm;\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n    var receiver = this.receiver;\n    var receiverElement = receiver.element;\n    var isGecko = window.kity.Browser.gecko;\n\n    // setup everything to go\n    setupReciverElement();\n    setupFsm();\n    setupHotbox();\n\n    // expose editText()\n    this.editText = editText;\n\n    // listen the fsm changes, make action.\n    function setupFsm() {\n\n      // when jumped to input mode, enter\n      fsm.when('* -> input', enterInputMode);\n\n      // when exited, commit or exit depends on the exit reason\n      fsm.when('input -> *', function (exit, enter, reason) {\n        switch (reason) {\n          case 'input-cancel':\n            return exitInputMode();\n          case 'input-commit':\n          default:\n            return commitInputResult();\n        }\n      });\n\n      // lost focus to commit\n      receiver.onblur(function (e) {\n        if (fsm.state() == 'input') {\n          fsm.jump('normal', 'input-commit');\n        }\n      });\n\n      minder.on('beforemousedown', function () {\n        if (fsm.state() == 'input') {\n          fsm.jump('normal', 'input-commit');\n        }\n      });\n\n      minder.on('dblclick', function () {\n        if (minder.getSelectedNode() && minder._status !== 'readonly') {\n          editText();\n        }\n      });\n    }\n\n    // let the receiver follow the current selected node position\n    function setupReciverElement() {\n      if (debug.flaged) {\n        receiverElement.classList.add('debug');\n      }\n\n      receiverElement.onmousedown = function (e) {\n        e.stopPropagation();\n      };\n\n      minder.on('layoutallfinish viewchange viewchanged selectionchange', function (e) {\n\n        // viewchange event is too frequenced, lazy it\n        if (e.type == 'viewchange' && fsm.state() != 'input') return;\n\n        updatePosition();\n      });\n\n      updatePosition();\n    }\n\n    // edit entrance in hotbox\n    function setupHotbox() {\n      hotbox.state('main').button({\n        position: 'center',\n        label: '编辑',\n        key: 'F2',\n        enable: function enable() {\n          return minder.queryCommandState('text') != -1;\n        },\n        action: editText\n      });\n    }\n\n    /**\r\n     * 增加对字体的鉴别，以保证用户在编辑状态ctrl/cmd + b/i所触发的加粗斜体与显示一致\r\n     * @editor Naixor\r\n     * @Date 2015-12-2\r\n     */\n    // edit for the selected node\n    function editText() {\n      var node = minder.getSelectedNode();\n      if (!node) {\n        return;\n      }\n      var textContainer = receiverElement;\n      receiverElement.innerText = \"\";\n      if (node.getData('font-weight') === 'bold') {\n        var b = document.createElement('b');\n        textContainer.appendChild(b);\n        textContainer = b;\n      }\n      if (node.getData('font-style') === 'italic') {\n        var i = document.createElement('i');\n        textContainer.appendChild(i);\n        textContainer = i;\n      }\n      textContainer.innerText = minder.queryCommandValue('text');\n\n      if (isGecko) {\n        receiver.fixFFCaretDisappeared();\n      };\n      fsm.jump('input', 'input-request');\n      receiver.selectAll();\n    }\n\n    /**\r\n     * 增加对字体的鉴别，以保证用户在编辑状态ctrl/cmd + b/i所触发的加粗斜体与显示一致\r\n     * @editor Naixor\r\n     * @Date 2015-12-2\r\n     */\n    function enterInputMode() {\n      var node = minder.getSelectedNode();\n      if (node) {\n        var fontSize = node.getData('font-size') || node.getStyle('font-size');\n        receiverElement.style.fontSize = fontSize + 'px';\n        receiverElement.style.minWidth = 0;\n        receiverElement.style.minWidth = receiverElement.clientWidth + 'px';\n        receiverElement.style.fontWeight = node.getData('font-weight') || '';\n        receiverElement.style.fontStyle = node.getData('font-style') || '';\n        receiverElement.classList.add('input');\n        receiverElement.focus();\n      }\n    }\n\n    /**\r\n     * 按照文本提交操作处理\r\n     * @Desc: 从其他节点复制文字到另一个节点时部分浏览器(chrome)会自动包裹一个span标签，这样试用一下逻辑出来的就不是text节点二是span节点因此导致undefined的情况发生\r\n     * @Warning: 下方代码使用[].slice.call来将HTMLDomCollection处理成为Array，ie8及以下会有问题\r\n     * @Editor: Naixor\r\n     * @Date: 2015.9.16\r\n     */\n    function commitInputText(textNodes) {\n      var text = '';\n      var TAB_CHAR = '\\t',\n          ENTER_CHAR = '\\n',\n          STR_CHECK = /\\S/,\n          SPACE_CHAR = ' ',\n\n      // 针对FF,SG,BD,LB,IE等浏览器下SPACE的charCode存在为32和160的情况做处理\n      SPACE_CHAR_REGEXP = new RegExp('( |' + String.fromCharCode(160) + ')'),\n          BR = document.createElement('br');\n      var isBold = false,\n          isItalic = false;\n\n      for (var str, _divChildNodes, space_l, space_num, tab_num, i = 0, l = textNodes.length; i < l; i++) {\n        str = textNodes[i];\n\n        switch (Object.prototype.toString.call(str)) {\n          // 正常情况处理\n          case '[object HTMLBRElement]':\n            {\n              text += ENTER_CHAR;\n              break;\n            }\n          case '[object Text]':\n            {\n              // SG下会莫名其妙的加上&nbsp;影响后续判断，干掉！\n              /**\r\n               * FF下的wholeText会导致如下问题：\r\n               *     |123| -> 在一个节点中输入一段字符，此时TextNode为[#Text 123]\r\n               *     提交并重新编辑，在后面追加几个字符\r\n               *     |123abc| -> 此时123为一个TextNode为[#Text 123, #Text abc]，但是对这两个任意取值wholeText均为全部内容123abc\r\n               * 上述BUG仅存在在FF中，故将wholeText更改为textContent\r\n               */\n              str = str.textContent.replace(\"&nbsp;\", \" \");\n\n              if (!STR_CHECK.test(str)) {\n                space_l = str.length;\n                while (space_l--) {\n                  if (SPACE_CHAR_REGEXP.test(str[space_l])) {\n                    text += SPACE_CHAR;\n                  } else if (str[space_l] === TAB_CHAR) {\n                    text += TAB_CHAR;\n                  }\n                }\n              } else {\n                text += str;\n              }\n              break;\n            }\n          // ctrl + b/i 会给字体加上<b>/<i>标签来实现黑体和斜体\n          case '[object HTMLElement]':\n            {\n              switch (str.nodeName) {\n                case \"B\":\n                  {\n                    isBold = true;\n                    break;\n                  }\n                case \"I\":\n                  {\n                    isItalic = true;\n                    break;\n                  }\n                default:\n                  {}\n              }\n              [].splice.apply(textNodes, [i, 1].concat([].slice.call(str.childNodes)));\n              l = textNodes.length;\n              i--;\n              break;\n            }\n          // 被增加span标签的情况会被处理成正常情况并会推交给上面处理\n          case '[object HTMLSpanElement]':\n            {\n              [].splice.apply(textNodes, [i, 1].concat([].slice.call(str.childNodes)));\n              l = textNodes.length;\n              i--;\n              break;\n            }\n          // 若标签为image标签，则判断是否为合法url，是将其加载进来\n          case '[object HTMLImageElement]':\n            {\n              if (str.src) {\n                if (/http(|s):\\/\\//.test(str.src)) {\n                  minder.execCommand(\"Image\", str.src, str.alt);\n                } else {\n                  // data:image协议情况\n                }\n              };\n              break;\n            }\n          // 被增加div标签的情况会被处理成正常情况并会推交给上面处理\n          case '[object HTMLDivElement]':\n            {\n              _divChildNodes = [];\n              for (var di = 0, l = str.childNodes.length; di < l; di++) {\n                _divChildNodes.push(str.childNodes[di]);\n              }\n              _divChildNodes.push(BR);\n              [].splice.apply(textNodes, [i, 1].concat(_divChildNodes));\n              l = textNodes.length;\n              i--;\n              break;\n            }\n          default:\n            {\n              if (str && str.childNodes.length) {\n                _divChildNodes = [];\n                for (var di = 0, l = str.childNodes.length; di < l; di++) {\n                  _divChildNodes.push(str.childNodes[di]);\n                }\n                _divChildNodes.push(BR);\n                [].splice.apply(textNodes, [i, 1].concat(_divChildNodes));\n                l = textNodes.length;\n                i--;\n              } else {\n                if (str && str.textContent !== undefined) {\n                  text += str.textContent;\n                } else {\n                  text += \"\";\n                }\n              }\n              // // 其他带有样式的节点被粘贴进来，则直接取textContent，若取不出来则置空\n            }\n        }\n      };\n\n      text = text.replace(/^\\n*|\\n*$/g, '');\n      text = text.replace(new RegExp('(\\n|\\r|\\n\\r)( |' + String.fromCharCode(160) + '){4}', 'g'), '$1\\t');\n      minder.getSelectedNode().setText(text);\n      if (isBold) {\n        minder.queryCommandState('bold') || minder.execCommand('bold');\n      } else {\n        minder.queryCommandState('bold') && minder.execCommand('bold');\n      }\n\n      if (isItalic) {\n        minder.queryCommandState('italic') || minder.execCommand('italic');\n      } else {\n        minder.queryCommandState('italic') && minder.execCommand('italic');\n      }\n      exitInputMode();\n      return text;\n    }\n\n    /**\r\n     * 判断节点的文本信息是否是\r\n     * @Desc: 从其他节点复制文字到另一个节点时部分浏览器(chrome)会自动包裹一个span标签，这样使用以下逻辑出来的就不是text节点二是span节点因此导致undefined的情况发生\r\n     * @Notice: 此处逻辑应该拆分到 kityminder-core/core/data中去，单独增加一个对某个节点importJson的事件\r\n     * @Editor: Naixor\r\n     * @Date: 2015.9.16\r\n     */\n    function commitInputNode(node, text) {\n      try {\n        minder.decodeData('text', text).then(function (json) {\n          function importText(node, json, minder) {\n            var data = json.data;\n\n            node.setText(data.text || '');\n\n            var childrenTreeData = json.children || [];\n            for (var i = 0; i < childrenTreeData.length; i++) {\n              var childNode = minder.createNode(null, node);\n              importText(childNode, childrenTreeData[i], minder);\n            }\n            return node;\n          }\n          importText(node, json, minder);\n          minder.fire(\"contentchange\");\n          minder.getRoot().renderTree();\n          minder.layout(300);\n        });\n      } catch (e) {\n        minder.fire(\"contentchange\");\n        minder.getRoot().renderTree();\n\n        // 无法被转换成脑图节点则不处理\n        if (e.toString() !== 'Error: Invalid local format') {\n          throw e;\n        }\n      }\n    }\n\n    function commitInputResult() {\n      /**\r\n       * @Desc: 进行如下处理：\r\n       *             根据用户的输入判断是否生成新的节点\r\n       *        fix #83 https://github.com/fex-team/kityminder-editor/issues/83\r\n       * @Editor: Naixor\r\n       * @Date: 2015.9.16\r\n       */\n      var textNodes = [].slice.call(receiverElement.childNodes);\n\n      /**\r\n       * @Desc: 增加setTimeout的原因：ie下receiverElement.innerHTML=\"\"会导致后\r\n       * \t\t  面commitInputText中使用textContent报错，不要问我什么原因！\r\n       * @Editor: Naixor\r\n       * @Date: 2015.12.14\r\n       */\n      setTimeout(function () {\n        // 解决过大内容导致SVG窜位问题\n        receiverElement.innerHTML = \"\";\n      }, 0);\n      var node = minder.getSelectedNode();\n\n      textNodes = commitInputText(textNodes);\n      commitInputNode(node, textNodes);\n\n      if (node.type == 'root') {\n        var rootText = minder.getRoot().getText();\n        minder.fire('initChangeRoot', {\n          text: rootText\n        });\n      }\n    }\n\n    function exitInputMode() {\n      receiverElement.classList.remove('input');\n      receiver.selectAll();\n    }\n\n    function updatePosition() {\n      var planed = updatePosition;\n\n      var focusNode = minder.getSelectedNode();\n      if (!focusNode) return;\n\n      if (!planed.timer) {\n        planed.timer = setTimeout(function () {\n          var box = focusNode.getRenderBox('TextRenderer');\n          receiverElement.style.left = Math.round(box.x) + 'px';\n          receiverElement.style.top = (debug.flaged ? Math.round(box.bottom + 30) : Math.round(box.y)) + 'px';\n          //receiverElement.focus();\n          planed.timer = 0;\n        });\n      }\n    }\n  }\n\n  return module.exports = InputRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/input.js?")},Vtdi:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// NAMESPACE OBJECT: ./src/store/getters.js\nvar getters_namespaceObject = {};\n__webpack_require__.r(getters_namespaceObject);\n__webpack_require__.d(getters_namespaceObject, "count", function() { return count; });\n__webpack_require__.d(getters_namespaceObject, "working", function() { return working; });\n__webpack_require__.d(getters_namespaceObject, "config", function() { return config; });\n__webpack_require__.d(getters_namespaceObject, "getMinder", function() { return getMinder; });\n__webpack_require__.d(getters_namespaceObject, "getEditor", function() { return getEditor; });\n\n// EXTERNAL MODULE: external "Vue"\nvar external_Vue_ = __webpack_require__("i7/w");\nvar external_Vue_default = /*#__PURE__*/__webpack_require__.n(external_Vue_);\n\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/App.vue?vue&type=template&id=399547b4&\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',{attrs:{"id":"app"}},[_c(\'router-view\')],1)}\nvar staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/App.vue?vue&type=template&id=399547b4&\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/App.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var Appvue_type_script_lang_js_ = ({\n  name: \'app\'\n});\n// CONCATENATED MODULE: ./src/App.vue?vue&type=script&lang=js&\n /* harmony default export */ var src_Appvue_type_script_lang_js_ = (Appvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/App.vue?vue&type=style&index=0&lang=css&\nvar Appvue_type_style_index_0_lang_css_ = __webpack_require__("A0++");\n\n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__("KHd+");\n\n// CONCATENATED MODULE: ./src/App.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar component = Object(componentNormalizer["a" /* default */])(\n  src_Appvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var App = (component.exports);\n// EXTERNAL MODULE: ./node_modules/vue-router/dist/vue-router.esm.js\nvar vue_router_esm = __webpack_require__("jE9Z");\n\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/home.vue?vue&type=template&id=181c3921&scoped=true&\nvar homevue_type_template_id_181c3921_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'el-container\',[_c(\'el-aside\',{attrs:{"width":"300px"}},[_c(\'Nav\')],1),_vm._v(" "),_c(\'el-container\',[_c(\'el-header\',[_c(\'headerLink\'),_vm._v(" "),_c(\'a\',{staticStyle:{"font-size":"larger"},attrs:{"href":"https://github.com/Erym5/mindMap","target":"_blank"}},[_vm._v("项目地址")])],1),_vm._v(" "),_c(\'el-main\',[_c(\'div\',{attrs:{"id":"backgroundImg"}})])],1)],1)],1)}\nvar homevue_type_template_id_181c3921_scoped_true_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/views/home.vue?vue&type=template&id=181c3921&scoped=true&\n\n// EXTERNAL MODULE: ./src/components/common/headerLink.vue + 4 modules\nvar headerLink = __webpack_require__("LbPw");\n\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/components/common/Nav.vue?vue&type=template&id=4c5d770b&\nvar Navvue_type_template_id_4c5d770b_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'el-col\',{attrs:{"span":24}},[_c(\'el-menu\',{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"$route.path","router":"","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{"open":_vm.handleOpen,"close":_vm.handleClose}},[_c(\'el-menu-item\',{attrs:{"index":"/home"}},[_c(\'i\',{staticClass:"el-icon-location"}),_vm._v("\\n      首页\\n    ")]),_vm._v(" "),_c(\'el-menu-item\',{attrs:{"index":"/search"}},[_c(\'i\',{staticClass:"el-icon-search"}),_vm._v("\\n      搜索\\n    ")]),_vm._v(" "),_c(\'el-menu-item\',{attrs:{"index":"/edit"}},[_c(\'i\',{staticClass:"el-icon-edit"}),_vm._v(" "),_c(\'span\',{attrs:{"slot":"title"},slot:"title"},[_vm._v("工作台")])]),_vm._v(" "),_c(\'el-menu-item\',{attrs:{"index":"/bookshelf"}},[_c(\'i\',{staticClass:"el-icon-files"}),_vm._v(" "),_c(\'span\',{attrs:{"slot":"title"},slot:"title"},[_vm._v("藏书")])]),_vm._v(" "),_c(\'el-menu-item\',{attrs:{"index":"/find"}},[_c(\'i\',{staticClass:"el-icon-aim"}),_vm._v("\\n      发现\\n    ")])],1)],1)}\nvar Navvue_type_template_id_4c5d770b_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/components/common/Nav.vue?vue&type=template&id=4c5d770b&\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/components/common/Nav.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var Navvue_type_script_lang_js_ = ({\n  name: "Nav",\n  methods: {\n    handleOpen: function handleOpen(key, keyPath) {\n      console.log(key, keyPath);\n    },\n    handleClose: function handleClose(key, keyPath) {\n      console.log(key, keyPath);\n    }\n  }\n});\n// CONCATENATED MODULE: ./src/components/common/Nav.vue?vue&type=script&lang=js&\n /* harmony default export */ var common_Navvue_type_script_lang_js_ = (Navvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/components/common/Nav.vue?vue&type=style&index=0&lang=css&\nvar Navvue_type_style_index_0_lang_css_ = __webpack_require__("GPq9");\n\n// CONCATENATED MODULE: ./src/components/common/Nav.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar Nav_component = Object(componentNormalizer["a" /* default */])(\n  common_Navvue_type_script_lang_js_,\n  Navvue_type_template_id_4c5d770b_render,\n  Navvue_type_template_id_4c5d770b_staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var Nav = (Nav_component.exports);\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/views/home.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ var homevue_type_script_lang_js_ = ({\n  name: "home",\n  components: {\n    headerLink: headerLink["a" /* default */],\n    Nav: Nav\n  }\n});\n// CONCATENATED MODULE: ./src/views/home.vue?vue&type=script&lang=js&\n /* harmony default export */ var views_homevue_type_script_lang_js_ = (homevue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/views/home.vue?vue&type=style&index=0&id=181c3921&scoped=true&lang=css&\nvar homevue_type_style_index_0_id_181c3921_scoped_true_lang_css_ = __webpack_require__("I0VB");\n\n// CONCATENATED MODULE: ./src/views/home.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar home_component = Object(componentNormalizer["a" /* default */])(\n  views_homevue_type_script_lang_js_,\n  homevue_type_template_id_181c3921_scoped_true_render,\n  homevue_type_template_id_181c3921_scoped_true_staticRenderFns,\n  false,\n  null,\n  "181c3921",\n  null\n  \n)\n\n/* harmony default export */ var home = (home_component.exports);\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/login.vue?vue&type=template&id=0e4042e2&scoped=true&\nvar loginvue_type_template_id_0e4042e2_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'el-card\',{staticClass:"login-form-layout"},[_c(\'el-form\',{ref:"loginForm",attrs:{"autoComplete":"on","model":_vm.loginForm,"rules":_vm.loginRules,"label-position":"left"}},[_c(\'div\',{staticStyle:{"text-align":"center"}},[_c(\'svg-icon\',{staticStyle:{"width":"56px","height":"56px","color":"#409EFF"},attrs:{"icon-class":"login-mall"}})],1),_vm._v(" "),_c(\'h2\',{staticClass:"login-title color-main"},[_vm._v("mall-admin-web")]),_vm._v(" "),_c(\'el-form-item\',{attrs:{"prop":"name"}},[_c(\'el-input\',{attrs:{"name":"name","type":"text","autoComplete":"on","placeholder":"admin"},model:{value:(_vm.loginForm.name),callback:function ($$v) {_vm.$set(_vm.loginForm, "name", $$v)},expression:"loginForm.name"}},[_c(\'span\',{attrs:{"slot":"prefix"},slot:"prefix"},[_c(\'svg-icon\',{staticClass:"color-main",attrs:{"icon-class":"user"}})],1)])],1),_vm._v(" "),_c(\'el-form-item\',{attrs:{"prop":"pwd"}},[_c(\'el-input\',{attrs:{"name":"pwd","type":_vm.pwdType,"autoComplete":"on","placeholder":"admin"},nativeOn:{"keyup":function($event){if(!$event.type.indexOf(\'key\')&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){ return null; }return _vm.handleLogin($event)}},model:{value:(_vm.loginForm.pwd),callback:function ($$v) {_vm.$set(_vm.loginForm, "pwd", $$v)},expression:"loginForm.pwd"}},[_c(\'span\',{attrs:{"slot":"prefix"},slot:"prefix"},[_c(\'svg-icon\',{staticClass:"color-main",attrs:{"icon-class":"pwd"}})],1),_vm._v(" "),_c(\'span\',{attrs:{"slot":"suffix"},on:{"click":_vm.showPwd},slot:"suffix"},[_c(\'svg-icon\',{staticClass:"color-main",attrs:{"icon-class":"eye"}})],1)])],1),_vm._v(" "),_c(\'el-form-item\',{staticStyle:{"margin-bottom":"60px","text-align":"center"}},[_c(\'el-button\',{staticStyle:{"width":"45%"},attrs:{"type":"primary","loading":_vm.loading},nativeOn:{"click":function($event){$event.preventDefault();return _vm.handleLogin($event)}}},[_vm._v("\\n          登录\\n        ")])],1)],1)],1)],1)}\nvar loginvue_type_template_id_0e4042e2_scoped_true_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/views/login.vue?vue&type=template&id=0e4042e2&scoped=true&\n\n// EXTERNAL MODULE: ./src/utils/request.js\nvar request = __webpack_require__("t3Un");\n\n// CONCATENATED MODULE: ./src/api/user.js\n\n\nfunction login(params) {\n  return request["a" /* default */].post(\'/api/user/login\', params);\n}\n// EXTERNAL MODULE: ./src/utils/auth.js\nvar auth = __webpack_require__("X4fA");\n\n// EXTERNAL MODULE: external "ELEMENT"\nvar external_ELEMENT_ = __webpack_require__("X3IP");\nvar external_ELEMENT_default = /*#__PURE__*/__webpack_require__.n(external_ELEMENT_);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/views/login.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n/* harmony default export */ var loginvue_type_script_lang_js_ = ({\n  name: \'login\',\n  data: function data() {\n    var validateUsername = function validateUsername(rule, value, callback) {\n      if (value.length < 3) {\n        callback(new Error(\'密码不能小于3位\'));\n      } else {\n        callback();\n      }\n    };\n    var validatePass = function validatePass(rule, value, callback) {\n      if (value.length < 3) {\n        callback(new Error(\'密码不能小于3位\'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      loginForm: {\n        name: \'\',\n        pwd: \'\'\n      },\n      loginRules: {\n        name: [{ required: true, trigger: \'blur\', validator: validateUsername }],\n        pwd: [{ required: true, trigger: \'blur\', validator: validatePass }]\n      },\n      loading: false,\n      pwdType: \'pwd\',\n      dialogVisible: false,\n      supportDialogVisible: false\n    };\n  },\n  created: function created() {\n    if (this.loginForm.name === undefined || this.loginForm.name == null || this.loginForm.name === \'\') {\n      this.loginForm.name = \'admin\';\n    }\n    if (this.loginForm.pwd === undefined || this.loginForm.pwd == null) {\n      this.loginForm.pwd = \'\';\n    }\n  },\n\n  methods: {\n    showPwd: function showPwd() {\n      if (this.pwdType === \'pwd\') {\n        this.pwdType = \'\';\n      } else {\n        this.pwdType = \'pwd\';\n      }\n    },\n    handleLogin: function handleLogin() {\n      // this.$refs.loginForm.validate(valid => {\n      //   if (valid) {\n      //     // let isSupport = getSupport();\n      //     // if(isSupport===undefined||isSupport==null){\n      //     //   this.dialogVisible =true;\n      //     //   return;\n      //     // }\n      //     this.loading = true;\n      //     this.$store.dispatch(\'Login\', this.loginForm).then(() => {\n      //       this.loading = false;\n      //       setCookie("name",this.loginForm.name,15);\n      //       setCookie("pwd",this.loginForm.pwd,15);\n      //       this.$router.push({path: \'/\'})\n      //     }).catch(() => {\n      //       this.loading = false\n      //     })\n      //   } else {\n      //     console.log(\'参数验证不合法！\');\n      //     return false\n      //   }\n      // })\n      login(this.loginForm).then(function (res) {\n        console.log(res);\n\n        Object(auth["d" /* setToken */])(res.data.token);\n        Object(auth["e" /* setUid */])(res.data.uid);\n      });\n      this.$router.push({ path: "/home" });\n    }\n  }\n});\n// CONCATENATED MODULE: ./src/views/login.vue?vue&type=script&lang=js&\n /* harmony default export */ var views_loginvue_type_script_lang_js_ = (loginvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/views/login.vue?vue&type=style&index=0&id=0e4042e2&scoped=true&lang=css&\nvar loginvue_type_style_index_0_id_0e4042e2_scoped_true_lang_css_ = __webpack_require__("Xw8o");\n\n// CONCATENATED MODULE: ./src/views/login.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar login_component = Object(componentNormalizer["a" /* default */])(\n  views_loginvue_type_script_lang_js_,\n  loginvue_type_template_id_0e4042e2_scoped_true_render,\n  loginvue_type_template_id_0e4042e2_scoped_true_staticRenderFns,\n  false,\n  null,\n  "0e4042e2",\n  null\n  \n)\n\n/* harmony default export */ var views_login = (login_component.exports);\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/search.vue?vue&type=template&id=a4d5f150&xmlns%3Av-on=http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml&\nvar searchvue_type_template_id_a4d5f150_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'el-container\',[_c(\'el-aside\',{staticClass:"el-aside",attrs:{"width":"300px"}},[_c(\'Nav\')],1),_vm._v(" "),_c(\'el-main\',[_c(\'headerLink\'),_vm._v(" "),_c(\'div\',{staticClass:"search",staticStyle:{"overflow":"hidden"}},[_c(\'el-row\',[_c(\'el-col\',{attrs:{"span":4}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":14}},[_c(\'input\',{directives:[{name:"model",rawName:"v-model",value:(_vm.keyword),expression:"keyword"}],staticClass:"search-input",attrs:{"type":"text","placeholder":"请输入关键字","maxlength":"20","width":"100px"},domProps:{"value":(_vm.keyword)},on:{"keyup":function($event){if(!$event.type.indexOf(\'key\')&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){ return null; }return _vm.searchByK($event)},"input":function($event){if($event.target.composing){ return; }_vm.keyword=$event.target.value}}})]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":2}},[_c(\'el-button\',{attrs:{"type":"primary","icon":"el-icon-search"},on:{"click":function($event){return _vm.searchByK()}}},[_vm._v("搜索")])],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":1}},[_vm._v("\\n                 \\n              ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":3}},[_c(\'a\',{attrs:{"href":"https://book.douban.com/","target":"_blank"}},[_vm._v("豆瓣发现更多")])])],1),_vm._v(" "),_vm._l((_vm.books.slice (0, 4)),function(item,index){return _c(\'el-row\',{key:index,staticClass:"bookList"},[_c(\'el-col\',{attrs:{"span":2}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":3}},[_c(\'a\',{attrs:{"href":"javascript:void(0)"},on:{"click":function($event){return _vm.bookDetail(item.id)}}},[_c(\'el-image\',{staticClass:"demonstration",staticStyle:{"width":"100px","height":"100px"},attrs:{"src":item.picUrl}})],1)]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":13}},[_c(\'span\',{staticClass:"demonstration"},[_c(\'br\'),_vm._v(" "),_c(\'a\',{attrs:{"href":"javascript:void(0)"},on:{"click":function($event){return _vm.bookDetail(item.id)}}},[_vm._v(_vm._s(item.bookName))]),_vm._v(" "),_c(\'br\'),_c(\'br\'),_vm._v(" "),_c(\'p\',[_vm._v(_vm._s(item.authorName))])])]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":6}},[_c(\'el-button\',{staticClass:"demonstration",on:{"click":function($event){return _vm.bookDetail(item.id)}}},[_vm._v("转存")])],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":24}},[_c(\'br\')])],1)})],2),_vm._v(" "),_c(\'div\',{staticStyle:{"display":"none"},attrs:{"id":"test"}})],1)],1),_vm._v(" "),_c(\'div\')],1)}\nvar searchvue_type_template_id_a4d5f150_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/views/search.vue?vue&type=template&id=a4d5f150&xmlns%3Av-on=http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml&\n\n// EXTERNAL MODULE: ./node_modules/axios/index.js\nvar axios = __webpack_require__("vDqi");\n\n// CONCATENATED MODULE: ./src/api/book.js\n\n\n\nfunction findBookByText(params) {\n  return request["a" /* default */].get(\'/api/book/search\', { params: { keyword: params } });\n}\n// EXTERNAL MODULE: ./src/api/mindMap.js\nvar mindMap = __webpack_require__("MfdG");\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/views/search.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n\n// import Editor from "../script/editor";\n/* harmony default export */ var searchvue_type_script_lang_js_ = ({\n  name: "search",\n  components: {\n    Nav: Nav,\n    headerLink: headerLink["a" /* default */]\n  },\n  data: function data() {\n    return {\n      keyword: "",\n      books: [],\n      jsonOfMap: [],\n      jsonOfDetail: []\n    };\n  },\n\n  methods: {\n    searchByK: function searchByK() {\n      var _this = this;\n\n      findBookByText(this.keyword).then(function (res) {\n        _this.books = JSON.parse(JSON.stringify(res.data));\n      });\n    },\n    bookDetail: function bookDetail(bookId) {\n      var _this2 = this;\n\n      var that = this;\n      Object(mindMap["d" /* mindMapCreate */])(bookId).then(function (res) {\n        that.jsonOfMap = JSON.stringify(res.data);\n        console.log(that.jsonOfMap);\n        that.jsonOfMap = JSON.parse(that.jsonOfMap);\n        console.log(that.jsonOfMap);\n      });\n      setTimeout(function () {\n        _this2.$set(_this2.jsonOfMap.root.data, "id", (+new Date() * 1e6 + Math.floor(Math.random() * 1e6)).toString(36));\n        console.log(_this2.jsonOfMap);\n        Object(mindMap["e" /* mindMapSave */])(_this2.jsonOfMap);\n        console.log(_this2.jsonOfMap);\n        external_ELEMENT_["Message"].success("转存完成");\n      }, 1000);\n    }\n  },\n  mounted: function mounted() {}\n});\n// CONCATENATED MODULE: ./src/views/search.vue?vue&type=script&lang=js&\n /* harmony default export */ var views_searchvue_type_script_lang_js_ = (searchvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/views/search.vue?vue&type=style&index=0&lang=css&\nvar searchvue_type_style_index_0_lang_css_ = __webpack_require__("j2um");\n\n// CONCATENATED MODULE: ./src/views/search.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar search_component = Object(componentNormalizer["a" /* default */])(\n  views_searchvue_type_script_lang_js_,\n  searchvue_type_template_id_a4d5f150_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_render,\n  searchvue_type_template_id_a4d5f150_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var search = (search_component.exports);\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/bookshelf.vue?vue&type=template&id=13ddeb17&scoped=true&xmlns%3Av-on=http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml&\nvar bookshelfvue_type_template_id_13ddeb17_scoped_true_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'el-container\',[_c(\'el-aside\',{attrs:{"width":"300px"}},[_c(\'Nav\')],1),_vm._v(" "),_c(\'el-container\',[_c(\'el-header\',[_c(\'headerLink\'),_vm._v(" "),_c(\'el-row\',{staticClass:"heading"},[_c(\'el-col\',{attrs:{"span":1}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":23}},[_c(\'h3\',[_vm._v("我的书架")])])],1),_vm._v(" "),_c(\'el-row\',[_c(\'el-col\',{attrs:{"span":1}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":3}},[_c(\'el-button\',{attrs:{"type":"primary"},on:{"click":function($event){return _vm.deleteByChoices()}}},[_vm._v("选中删除")])],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":14}},[_c(\'input\',{directives:[{name:"model",rawName:"v-model",value:(_vm.keyword),expression:"keyword"}],staticClass:"search-input",attrs:{"type":"text","placeholder":"请输入关键字","maxlength":"20","width":"100px"},domProps:{"value":(_vm.keyword)},on:{"keyup":function($event){if(!$event.type.indexOf(\'key\')&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){ return null; }return _vm.searchByK($event)},"input":function($event){if($event.target.composing){ return; }_vm.keyword=$event.target.value}}})]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":2}},[_c(\'el-button\',{attrs:{"type":"primary","icon":"el-icon-search"},on:{"click":function($event){return _vm.searchByK()}}},[_vm._v("搜索")])],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":1}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":3}},[_c(\'el-button\',{attrs:{"type":"primary"},on:{"click":function($event){return _vm.reset()}}},[_vm._v("重置搜索库")])],1)],1)],1),_vm._v(" "),_c(\'el-main\',[_vm._l((_vm.dataShow),function(item,index){return _c(\'el-row\',{key:index,staticClass:"mapList"},[_c(\'el-col\',{attrs:{"span":2}},[_vm._v(" ")]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":1}},[_c(\'el-checkbox\',{directives:[{name:"modol",rawName:"v-modol",value:(_vm.checked),expression:"checked"}],on:{"change":function($event){return _vm.push2Queue(item)}}})],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":15}},[_c(\'a\',{attrs:{"href":"javascript:void(0)"},on:{"click":function($event){return _vm.mapDetail(item)}}},[_vm._v(_vm._s(item.title))])]),_vm._v(" "),_c(\'el-col\',{attrs:{"span":6}},[_c(\'el-button\',{staticClass:"demonstration",on:{"click":function($event){return _vm.deleteMap(item.mapId)}}},[_vm._v("删除")])],1),_vm._v(" "),_c(\'el-col\',{attrs:{"span":24}},[_c(\'br\')])],1)}),_vm._v(" "),_c(\'el-row\',{staticClass:"pageControl"},[_c(\'input\',{attrs:{"type":"button","value":"首页"},on:{"click":_vm.firstPage}}),_vm._v(" "),_c(\'input\',{attrs:{"type":"button","value":"上一页"},on:{"click":_vm.prevPage}}),_vm._v(" "),_c(\'input\',{attrs:{"type":"button","value":"下一页"},on:{"click":_vm.nextPage}}),_vm._v(" "),_c(\'input\',{attrs:{"type":"button","value":"尾页"},on:{"click":_vm.lastPage}})])],2)],1)],1)],1)}\nvar bookshelfvue_type_template_id_13ddeb17_scoped_true_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/views/bookshelf.vue?vue&type=template&id=13ddeb17&scoped=true&xmlns%3Av-on=http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml&\n\n// CONCATENATED MODULE: ./src/utils/event.js\n\n/* harmony default export */ var utils_event = (new external_Vue_default.a());\n// CONCATENATED MODULE: ./src/api/elasticsearch.js\n\n\nfunction findMapByText(params) {\n  return request["a" /* default */].get(\'/api/es/getByKeyword\', { params: { keyword: params } });\n}\n\nfunction saveAll() {\n  return request["a" /* default */].post(\'/api/es/importAll\');\n}\n\nfunction deleteAll() {\n  return request["a" /* default */].delete(\'/api/es/deleteAll\');\n}\n// CONCATENATED MODULE: ./src/api/rabbitmq.js\n\n\nfunction deletebychoices(params) {\n  return request["a" /* default */].post(\'/api/mind_map/deletebychoices\', params);\n}\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/views/bookshelf.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n\n\n\n/* harmony default export */ var bookshelfvue_type_script_lang_js_ = ({\n  name: "bookshelf",\n  data: function data() {\n    return {\n      //rabbitMQ队列\n      queue: [],\n      //选择框\n      checked: false,\n      //搜索关键字\n      keyword: "",\n      data: [],\n      // 所有页面的数据\n      totalPage: [],\n      // 每页显示数量\n      pageSize: 8,\n      // 共几页\n      pageNum: 0,\n      // 当前显示的数据\n      dataShow: "",\n      // 默认当前显示第一页\n      currentPage: 0\n    };\n  },\n  provide: function provide() {\n    return {\n      data: this.data\n    };\n  },\n\n  components: {\n    headerLink: headerLink["a" /* default */],\n    Nav: Nav\n  },\n  methods: {\n    deleteByChoices: function deleteByChoices() {\n      var _this = this;\n\n      deletebychoices(this.queue);\n      setTimeout(function () {\n        _this.getData();\n      }, 1000);\n    },\n    push2Queue: function push2Queue(item) {\n      this.queue.push(item.mapId);\n    },\n    reset: function reset() {\n      deleteAll();\n      saveAll();\n      setTimeout(function () {\n        external_ELEMENT_["Message"].success("重置完成");\n      }, 2000);\n    },\n    searchByK: function searchByK() {\n      var _this2 = this;\n\n      findMapByText(this.keyword).then(function (res) {\n        _this2.data = res.data.data;\n        console.log(_this2.data);\n        _this2.initData();\n      });\n    },\n    mapDetail: function mapDetail(item) {\n      this.$router.push({ path: "/edit/" + item.mapId });\n    },\n    nextPage: function nextPage() {\n      if (this.currentPage === this.pageNum - 1) return;\n      this.dataShow = this.totalPage[++this.currentPage];\n    },\n\n    // 上一页\n    prevPage: function prevPage() {\n      if (this.currentPage === 0) return;\n      this.dataShow = this.totalPage[--this.currentPage];\n    },\n    firstPage: function firstPage() {\n      if (this.currentPage === 0) return;\n      this.dataShow = this.totalPage[0];\n    },\n    lastPage: function lastPage() {\n      if (this.currentPage === 0) return;\n      this.dataShow = this.totalPage[this.pageNum];\n    },\n    deleteMap: function deleteMap(id) {\n      Object(mindMap["a" /* deleteMapById */])(id).then(this.getData);\n    },\n    getData: function getData() {\n      var _this3 = this;\n\n      Object(mindMap["c" /* getMaps */])().then(function (res) {\n        _this3.data = res.data;\n        _this3.initData();\n      });\n    },\n    initData: function initData() {\n      this.pageNum = Math.ceil(this.data.length / this.pageSize) || 1;\n      for (var i = 0; i < this.pageNum; i++) {\n        //分组数据\n        this.totalPage[i] = this.data.slice(this.pageSize * i, this.pageSize * (i + 1));\n        console.log(this.totalPage[i]);\n      }\n      // 获取到数据后显示第一页内容\n      this.dataShow = this.totalPage[this.currentPage];\n    }\n  },\n  mounted: function mounted() {\n    this.getData();\n  }\n});\n// CONCATENATED MODULE: ./src/views/bookshelf.vue?vue&type=script&lang=js&\n /* harmony default export */ var views_bookshelfvue_type_script_lang_js_ = (bookshelfvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/views/bookshelf.vue?vue&type=style&index=0&id=13ddeb17&scoped=true&lang=css&\nvar bookshelfvue_type_style_index_0_id_13ddeb17_scoped_true_lang_css_ = __webpack_require__("dlRp");\n\n// CONCATENATED MODULE: ./src/views/bookshelf.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar bookshelf_component = Object(componentNormalizer["a" /* default */])(\n  views_bookshelfvue_type_script_lang_js_,\n  bookshelfvue_type_template_id_13ddeb17_scoped_true_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_render,\n  bookshelfvue_type_template_id_13ddeb17_scoped_true_xmlns_3Av_on_http_3A_2F_2Fwww_w3_org_2F1999_2Fxhtml_staticRenderFns,\n  false,\n  null,\n  "13ddeb17",\n  null\n  \n)\n\n/* harmony default export */ var bookshelf = (bookshelf_component.exports);\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/find.vue?vue&type=template&id=23ef0bd2&scoped=true&\nvar findvue_type_template_id_23ef0bd2_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',[_c(\'el-container\',[_c(\'el-aside\',{attrs:{"width":"300px"}},[_c(\'Nav\')],1),_vm._v(" "),_c(\'el-container\',[_c(\'el-header\',[_c(\'headerLink\')],1),_vm._v(" "),_c(\'el-main\',[_c(\'div\',{attrs:{"id":"backgroundImg"}})])],1)],1)],1)}\nvar findvue_type_template_id_23ef0bd2_scoped_true_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/views/find.vue?vue&type=template&id=23ef0bd2&scoped=true&\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/views/find.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ var findvue_type_script_lang_js_ = ({\n  name: "find",\n  components: {\n    headerLink: headerLink["a" /* default */],\n    Nav: Nav\n  }\n});\n// CONCATENATED MODULE: ./src/views/find.vue?vue&type=script&lang=js&\n /* harmony default export */ var views_findvue_type_script_lang_js_ = (findvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./src/views/find.vue?vue&type=style&index=0&id=23ef0bd2&scoped=true&lang=css&\nvar findvue_type_style_index_0_id_23ef0bd2_scoped_true_lang_css_ = __webpack_require__("0rPY");\n\n// CONCATENATED MODULE: ./src/views/find.vue\n\n\n\n\n\n\n/* normalize component */\n\nvar find_component = Object(componentNormalizer["a" /* default */])(\n  views_findvue_type_script_lang_js_,\n  findvue_type_template_id_23ef0bd2_scoped_true_render,\n  findvue_type_template_id_23ef0bd2_scoped_true_staticRenderFns,\n  false,\n  null,\n  "23ef0bd2",\n  null\n  \n)\n\n/* harmony default export */ var find = (find_component.exports);\n// CONCATENATED MODULE: ./src/router/index.js\n\n\n// import edit from \'../views/edit\';\n\n\n\n\n\nexternal_Vue_default.a.use(vue_router_esm["a" /* default */]);\n\n/* harmony default export */ var router = (new vue_router_esm["a" /* default */]({\n  routes: [{\n    path: \'/\',\n    redirect: \'home\'\n  }, {\n    path: \'/home\',\n    name: \'home\',\n    component: home\n  }, {\n    path: \'/search\',\n    name: \'search\',\n    component: search\n  }, {\n    path: \'/bookshelf\',\n    name: \'bookshelf\',\n    component: bookshelf\n  }, {\n    path: \'/login\',\n    name: \'login\',\n    component: views_login\n  }, {\n    path: \'/find\',\n    name: \'find\',\n    component: find\n  }, {\n    path: \'/edit:id\',\n    name: \'editor\',\n    component: function component() {\n      return Promise.all(/* import() */[__webpack_require__.e(0), __webpack_require__.e(1)]).then(__webpack_require__.bind(null, "osYL"));\n    }\n  }, {\n    path: \'/edit\',\n    name: \'editor\',\n    component: function component() {\n      return Promise.all(/* import() */[__webpack_require__.e(0), __webpack_require__.e(1)]).then(__webpack_require__.bind(null, "osYL"));\n    }\n  }, {\n    path: \'/edit/:id\',\n    name: \'mindMap\',\n    component: function component() {\n      return Promise.all(/* import() */[__webpack_require__.e(0), __webpack_require__.e(1)]).then(__webpack_require__.bind(null, "osYL"));\n    }\n  }]\n}));\n// EXTERNAL MODULE: ./node_modules/vuex/dist/vuex.esm.js\nvar vuex_esm = __webpack_require__("L2JU");\n\n// CONCATENATED MODULE: ./src/store/getters.js\nvar count = function count(state) {\n  return state.count;\n};\n\nvar working = function working(state) {\n  return {\n    saving: state.working.saving,\n    draging: state.working.draging,\n    editing: state.working.editing\n  };\n};\n\nvar config = function config(state) {\n  return {\n    ctrlPanelMin: state.config.ctrlPanelMin,\n    ctrlPanelWidth: state.config.ctrlPanelWidth,\n    dividerWidth: state.config.dividerWidth,\n    defaultLang: state.config.defaultLang,\n    zoom: state.config.zoom\n  };\n};\n\nvar getMinder = function getMinder(state) {\n  return state.minder;\n};\n\nvar getEditor = function getEditor(state) {\n  return state.editor;\n};\n// CONCATENATED MODULE: ./src/store/actions.js\nvar actions = {\n  changeCount: function changeCount(_ref) {\n    var commit = _ref.commit;\n    return commit(\'changeCount\');\n  },\n\n  increment: function increment(_ref2) {\n    var commit = _ref2.commit;\n    return commit(\'increment\');\n  },\n\n  decrement: function decrement(_ref3) {\n    var commit = _ref3.commit;\n    return commit(\'decrement\');\n  },\n\n  incrementIfOdd: function incrementIfOdd(_ref4) {\n    var commit = _ref4.commit,\n        state = _ref4.state;\n\n    if ((state.count + 1) % 2 === 0) {\n      commit(\'increment\');\n    }\n  },\n  incrementAsync: function incrementAsync(_ref5) {\n    var commit = _ref5.commit;\n\n    return new Promise(function (resolve, reject) {\n      setTimeout(function () {\n        commit(\'increment\');\n        resolve();\n      }, 1000);\n    });\n  },\n\n\n  setConfig: function setConfig(_ref6) {\n    var commit = _ref6.commit;\n    return commit(\'setConfig\');\n  },\n\n  registerEvent: function registerEvent(_ref7) {\n    var commit = _ref7.commit;\n    return commit(\'registerEvent\', callback);\n  },\n\n  executeCallback: function executeCallback(_ref8) {\n    var commit = _ref8.commit,\n        state = _ref8.state;\n\n    state.callbackQueue.forEach(function (ele) {\n      ele.apply(this, arguments);\n    });\n  },\n  isQuotaExceeded: function isQuotaExceeded(e) {\n    var quotaExceeded = false;\n    if (e) {\n      if (e.code) {\n        switch (e.code) {\n          case 22:\n            quotaExceeded = true;\n            break;\n          case 1014:\n            // Firefox\n            if (e.name === \'NS_ERROR_DOM_QUOTA_REACHED\') {\n              quotaExceeded = true;\n            }\n            break;\n        }\n      } else if (e.number === -2147024882) {\n        // Internet Explorer 8\n        quotaExceeded = true;\n      }\n    }\n    return quotaExceeded;\n    index;\n  },\n  getMemory: function getMemory(_ref9, key) {\n    var commit = _ref9.commit,\n        state = _ref9.state;\n\n    console.log(\'getMemory-data.key:\', data.key);\n    console.log(\'getMemory-state:\', state);\n    var value = window.localStorage.getItem(key);\n    var result =  false || JSON.parse(value);\n    console.log(\'action:\' + result);\n    return result;\n  },\n  setMemory: function setMemory(_ref10, data) {\n    var commit = _ref10.commit,\n        state = _ref10.state;\n\n    try {\n      console.log(\'setMemory-data.key:\', data.key);\n      console.log(\'setMemory-state:\', state);\n      window.localStorage.setItem(data.key, JSON.stringify(data.value));\n      return true;\n    } catch (e) {\n      if (this.isQuotaExceeded(e)) {\n        return false;\n      }\n    }\n  },\n  removeMemory: function removeMemory(key) {\n    var value = window.localStorage.getItem(key);\n    window.localStorage.removeItem(key);\n    return value;\n  },\n  clearMemory: function clearMemory() {\n    window.localStorage.clear();\n  }\n};\n// CONCATENATED MODULE: ./src/store/mutations.js\nvar _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };\n\nvar mutations = {\n  changeDrag: function changeDrag(state, bool) {\n    state.working.draging = bool;\n  },\n  setMinder: function setMinder(state, data) {\n    state.minder = data;\n  },\n  setEditor: function setEditor(state, data) {\n    state.editor = data;\n  },\n  changeSave: function changeSave(state, bool) {\n    state.working.saving = bool;\n  },\n  changeCount: function changeCount(state) {\n    state.count++;\n  },\n  increment: function increment(state) {\n    state.count++;\n  },\n  decrement: function decrement(state) {\n    state.count--;\n  },\n  registerEvent: function registerEvent(state, callback) {\n    state.callbackQueue.push(callback);\n  },\n  setConfig: function setConfig(state) {\n    var supported = Object.keys(state.config);\n    var configObj = {};\n\n    // 支持全配置\n    if ((typeof key === \'undefined\' ? \'undefined\' : _typeof(key)) === \'object\') {\n      configObj = key;\n    } else {\n      configObj[key] = value;\n    }\n\n    for (var i in configObj) {\n      if (configObj.hasOwnProperty(i) && supported.indexOf(i) !== -1) {\n        state.config[i] = configObj[i];\n      } else {\n        console.error(\'Unsupported config key: \', key, \', please choose in :\', supported.join(\', \'));\n        return false;\n      }\n    }\n    return true;\n  }\n};\n// CONCATENATED MODULE: ./src/store/state.js\nvar state = {\n  count: 2,\n  minder: {},\n  editor: {},\n  working: {\n    editing: false,\n    saving: false,\n    draging: false\n  },\n  callbackQueue: [],\n  config: {\n    // 右侧面板最小宽度\n    ctrlPanelMin: 250,\n\n    // 右侧面板宽度\n    ctrlPanelWidth: parseInt(window.localStorage.__dev_minder_ctrlPanelWidth) || 250,\n\n    // 分割线宽度\n    dividerWidth: 3,\n\n    // 默认语言\n    defaultLang: \'zh-cn\',\n\n    // 放大缩小比例\n    zoom: [10, 20, 30, 50, 80, 100, 120, 150, 200]\n  }\n};\n// CONCATENATED MODULE: ./src/store/index.js\n\n\n\n\n\n\n\n\nexternal_Vue_default.a.use(vuex_esm["a" /* default */]);\n\nvar store = new vuex_esm["a" /* default */].Store({\n  state: state,\n  getters: getters_namespaceObject,\n  actions: actions,\n  mutations: mutations\n});\n\n/* harmony default export */ var src_store = (store);\n// EXTERNAL MODULE: ./node_modules/element-ui/lib/theme-chalk/index.css\nvar theme_chalk = __webpack_require__("D66Q");\n\n// EXTERNAL MODULE: external "jQuery"\nvar external_jQuery_ = __webpack_require__("xeH2");\n\n// CONCATENATED MODULE: ./src/main.js\n\n\n\n\n\n\n\n// import axios from "axios";\n\n__webpack_require__("VrN/");\n__webpack_require__("1eCo");\n__webpack_require__("+dQi");\n__webpack_require__("ewDg");\n__webpack_require__("1p+/");\n// require(\'../node_modules/codemirror/mode/markdown/markdown.js\')\n__webpack_require__("nrkQ");\n__webpack_require__("RKCW");\n__webpack_require__("DlQD");\n\n__webpack_require__("Ilfy");\n\n// require(\'../node_modules/hotbox/hotbox.js\')\n__webpack_require__("jqor");\n// require(\'../node_modules/kityminder-core/dist/kityminder.core.js\')\n__webpack_require__("ndr+");\n\n__webpack_require__("hfhy");\n\nexternal_Vue_default.a.config.productionTip = true;\nexternal_Vue_default.a.use(external_ELEMENT_default.a);\n\nnew external_Vue_default.a({\n  el: \'#app\',\n  // axios,\n  router: router,\n  store: src_store,\n  template: \'<App/>\',\n  components: {\n    App: App\n  }\n});\n\n//# sourceURL=webpack:///./src/main.js_+_46_modules?')},X3IP:function(module,exports){eval("module.exports = ELEMENT;\n\n//# sourceURL=webpack:///external_%22ELEMENT%22?")},X4fA:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return getToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return setToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return removeToken; });\n/* unused harmony export removeNickName */\n/* unused harmony export setNickName */\n/* unused harmony export getNickName */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return setUid; });\n/* unused harmony export getUid */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return removeUid; });\n\nvar TokenKey = \'Authorization\';\n\nvar nickNameKey = \'nickName\';\n\nvar uidKey = \'uid\';\n\nvar getToken = function getToken() {\n  return localStorage.getItem(TokenKey);\n};\n\nvar setToken = function setToken(token) {\n  return localStorage.setItem(TokenKey, token);\n};\n\nvar removeToken = function removeToken() {\n  return localStorage.removeItem(TokenKey);\n};\n\nvar removeNickName = function removeNickName() {\n  return localStorage.removeItem(nickNameKey);\n};\n\nvar setNickName = function setNickName(nickName) {\n  return localStorage.setItem(nickNameKey, nickName);\n};\n\nvar getNickName = function getNickName() {\n  return localStorage.getItem(nickNameKey);\n};\n\nvar setUid = function setUid(uid) {\n  return localStorage.setItem(uidKey, uid);\n};\n\nvar getUid = function getUid() {\n  return localStorage.getItem(uidKey);\n};\n\nvar removeUid = function removeUid() {\n  return localStorage.removeItem(uidKey);\n};\n\n//# sourceURL=webpack:///./src/utils/auth.js?')},XujU:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n    return module.exports = window.HotBox;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/hotbox.js?")},Xw8o:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_login_vue_vue_type_style_index_0_id_0e4042e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("qZ1r");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_login_vue_vue_type_style_index_0_id_0e4042e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_login_vue_vue_type_style_index_0_id_0e4042e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/views/login.vue?')},aN5C:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/views/search.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},bSn8:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var Hotbox = __webpack_require__(\"XujU\");\n\n  function HotboxRuntime() {\n    var fsm = this.fsm;\n    var minder = this.minder;\n    var receiver = this.receiver;\n    var container = this.container;\n\n    var hotbox = new Hotbox(container);\n\n    hotbox.setParentFSM(fsm);\n\n    fsm.when('normal -> hotbox', function (exit, enter, reason) {\n      var node = minder.getSelectedNode();\n      var position;\n      if (node) {\n        var box = node.getRenderBox();\n        position = {\n          x: box.cx,\n          y: box.cy\n        };\n      }\n      hotbox.active('main', position);\n    });\n\n    fsm.when('normal -> normal', function (exit, enter, reason, e) {\n      if (reason == 'shortcut-handle') {\n        var handleResult = hotbox.dispatch(e);\n        if (handleResult) {\n          e.preventDefault();\n        } else {\n          minder.dispatchKeyEvent(e);\n        }\n      }\n    });\n\n    fsm.when('modal -> normal', function (exit, enter, reason, e) {\n      if (reason == 'import-text-finish') {\n        receiver.element.focus();\n      }\n    });\n\n    this.hotbox = hotbox;\n  }\n\n  return module.exports = HotboxRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/hotbox.js?")},cfRE:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/views/home.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},"cxy/":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;/**\r\n * @fileOverview\r\n *\r\n * 用于拖拽节点时屏蔽键盘事件\r\n *\r\n * @author: techird\r\n * @copyright: Baidu FEX, 2014\r\n */\n!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  var Hotbox = __webpack_require__(\"XujU\");\n  var Debug = __webpack_require__(\"8zQj\");\n  var debug = new Debug('drag');\n\n  function DragRuntime() {\n    var fsm = this.fsm;\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n    var receiver = this.receiver;\n    var receiverElement = receiver.element;\n\n    // setup everything to go\n    setupFsm();\n\n    // listen the fsm changes, make action.\n    function setupFsm() {\n\n      // when jumped to drag mode, enter\n      fsm.when('* -> drag', function () {\n        // now is drag mode\n      });\n\n      fsm.when('drag -> *', function (exit, enter, reason) {\n        if (reason == 'drag-finish') {\n          // now exit drag mode\n        }\n      });\n    }\n\n    var downX, downY;\n    var MOUSE_HAS_DOWN = 0;\n    var MOUSE_HAS_UP = 1;\n    var BOUND_CHECK = 20;\n    var flag = MOUSE_HAS_UP;\n    var maxX, maxY, osx, osy, containerY;\n    var freeHorizen = false,\n        freeVirtical = false;\n    var frame;\n\n    function move(direction, speed) {\n      if (!direction) {\n        freeHorizen = freeVirtical = false;\n        frame && kity.releaseFrame(frame);\n        frame = null;\n        return;\n      }\n      if (!frame) {\n        frame = kity.requestFrame(function (direction, speed, minder) {\n          return function (frame) {\n            switch (direction) {\n              case 'left':\n                minder._viewDragger.move({\n                  x: -speed,\n                  y: 0\n                }, 0);\n                break;\n              case 'top':\n                minder._viewDragger.move({\n                  x: 0,\n                  y: -speed\n                }, 0);\n                break;\n              case 'right':\n                minder._viewDragger.move({\n                  x: speed,\n                  y: 0\n                }, 0);\n                break;\n              case 'bottom':\n                minder._viewDragger.move({\n                  x: 0,\n                  y: speed\n                }, 0);\n                break;\n              default:\n                return;\n            }\n            frame.next();\n          };\n        }(direction, speed, minder));\n      }\n    }\n\n    minder.on('mousedown', function (e) {\n      flag = MOUSE_HAS_DOWN;\n      var rect = minder.getPaper().container.getBoundingClientRect();\n      downX = e.originEvent.clientX;\n      downY = e.originEvent.clientY;\n      containerY = rect.top;\n      maxX = rect.width;\n      maxY = rect.height;\n    });\n\n    minder.on('mousemove', function (e) {\n      if (fsm.state() === 'drag' && flag == MOUSE_HAS_DOWN && minder.getSelectedNode() && (Math.abs(downX - e.originEvent.clientX) > BOUND_CHECK || Math.abs(downY - e.originEvent.clientY) > BOUND_CHECK)) {\n        osx = e.originEvent.clientX;\n        osy = e.originEvent.clientY - containerY;\n\n        if (osx < BOUND_CHECK) {\n          move('right', BOUND_CHECK - osx);\n        } else if (osx > maxX - BOUND_CHECK) {\n          move('left', BOUND_CHECK + osx - maxX);\n        } else {\n          freeHorizen = true;\n        }\n        if (osy < BOUND_CHECK) {\n          move('bottom', osy);\n        } else if (osy > maxY - BOUND_CHECK) {\n          move('top', BOUND_CHECK + osy - maxY);\n        } else {\n          freeVirtical = true;\n        }\n        if (freeHorizen && freeVirtical) {\n          move(false);\n        }\n      }\n      if (fsm.state() !== 'drag' && flag === MOUSE_HAS_DOWN && minder.getSelectedNode() && (Math.abs(downX - e.originEvent.clientX) > BOUND_CHECK || Math.abs(downY - e.originEvent.clientY) > BOUND_CHECK)) {\n\n        if (fsm.state() === 'hotbox') {\n          hotbox.active(Hotbox.STATE_IDLE);\n        }\n\n        return fsm.jump('drag', 'user-drag');\n      }\n    });\n\n    window.addEventListener('mouseup', function () {\n      flag = MOUSE_HAS_UP;\n      if (fsm.state() === 'drag') {\n        move(false);\n        return fsm.jump('normal', 'drag-finish');\n      }\n    }, false);\n  }\n\n  return module.exports = DragRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/drag.js?")},"dSb+":function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;/**\r\n * @fileOverview\r\n *\r\n * 编辑器状态机\r\n *\r\n * @author: techird\r\n * @copyright: Baidu FEX, 2014\r\n */\n!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  var Debug = __webpack_require__(\"8zQj\");\n  var debug = new Debug('fsm');\n\n  function handlerConditionMatch(condition, when, exit, enter) {\n    if (condition.when != when) return false;\n    if (condition.enter != '*' && condition.enter != enter) return false;\n    if (condition.exit != '*' && condition.exit != exit) return;\n    return true;\n  }\n\n  function FSM(defaultState) {\n    var currentState = defaultState;\n    var BEFORE_ARROW = ' - ';\n    var AFTER_ARROW = ' -> ';\n    var handlers = [];\n\n    /**\r\n     * 状态跳转\r\n     *\r\n     * 会通知所有的状态跳转监视器\r\n     *\r\n     * @param  {string} newState  新状态名称\r\n     * @param  {any} reason 跳转的原因，可以作为参数传递给跳转监视器\r\n     */\n    this.jump = function (newState, reason) {\n      if (!reason) throw new Error('Please tell fsm the reason to jump');\n\n      var oldState = currentState;\n      var notify = [oldState, newState].concat([].slice.call(arguments, 1));\n      var i, handler;\n\n      // 跳转前\n      for (i = 0; i < handlers.length; i++) {\n        handler = handlers[i];\n        if (handlerConditionMatch(handler.condition, 'before', oldState, newState)) {\n          if (handler.apply(null, notify)) return;\n        }\n      }\n\n      currentState = newState;\n      debug.log('[{0}] {1} -> {2}', reason, oldState, newState);\n\n      // 跳转后\n      for (i = 0; i < handlers.length; i++) {\n        handler = handlers[i];\n        if (handlerConditionMatch(handler.condition, 'after', oldState, newState)) {\n          handler.apply(null, notify);\n        }\n      }\n      return currentState;\n    };\n\n    /**\r\n     * 返回当前状态\r\n     * @return {string}\r\n     */\n    this.state = function () {\n      return currentState;\n    };\n\n    /**\r\n     * 添加状态跳转监视器\r\n     * \r\n     * @param {string} condition\r\n     *     监视的时机\r\n     *         \"* => *\" （默认）\r\n     *\r\n     * @param  {Function} handler\r\n     *     监视函数，当状态跳转的时候，会接收三个参数\r\n     *         * from - 跳转前的状态\r\n     *         * to - 跳转后的状态\r\n     *         * reason - 跳转的原因\r\n     */\n    this.when = function (condition, handler) {\n      if (arguments.length == 1) {\n        handler = condition;\n        condition = '* -> *';\n      }\n\n      var when, resolved, exit, enter;\n\n      resolved = condition.split(BEFORE_ARROW);\n      if (resolved.length == 2) {\n        when = 'before';\n      } else {\n        resolved = condition.split(AFTER_ARROW);\n        if (resolved.length == 2) {\n          when = 'after';\n        }\n      }\n      if (!when) throw new Error('Illegal fsm condition: ' + condition);\n\n      exit = resolved[0];\n      enter = resolved[1];\n\n      handler.condition = {\n        when: when,\n        exit: exit,\n        enter: enter\n      };\n\n      handlers.push(handler);\n    };\n  }\n\n  function FSMRumtime() {\n    this.fsm = new FSM('normal');\n  }\n\n  return module.exports = FSMRumtime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/fsm.js?")},dkMl:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  function ContainerRuntime() {\n    var container;\n    console.info(\"this.selector\", this.selector);\n    if (typeof this.selector == 'string') {\n      container = document.querySelector(this.selector);\n    } else {\n      container = this.selector;\n    }\n\n    if (!container) throw new Error('Invalid selector: ' + this.selector);\n\n    // 这个类名用于给编辑器添加样式\n    container.classList.add('km-editor');\n    console.info(\"container\", container);\n\n    // 暴露容器给其他运行时使用\n    this.container = container;\n  }\n\n  return module.exports = ContainerRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/container.js?")},dlRp:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_bookshelf_vue_vue_type_style_index_0_id_13ddeb17_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("hWpW");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_bookshelf_vue_vue_type_style_index_0_id_13ddeb17_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_bookshelf_vue_vue_type_style_index_0_id_13ddeb17_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/views/bookshelf.vue?')},f1rw:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/App.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},hWpW:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/views/bookshelf.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},hfhy:function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n    return module.exports = kityminder.Editor = __webpack_require__("/fdn");\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/expose-editor.js?')},"i7/w":function(module,exports){eval("module.exports = Vue;\n\n//# sourceURL=webpack:///external_%22Vue%22?")},iIxm:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  var Hotbox = __webpack_require__(\"XujU\");\n\n  // Nice: http://unixpapa.com/js/key.html\n  function isIntendToInput(e) {\n    if (e.ctrlKey || e.metaKey || e.altKey) return false;\n\n    // a-zA-Z\n    if (e.keyCode >= 65 && e.keyCode <= 90) return true;\n\n    // 0-9 以及其上面的符号\n    if (e.keyCode >= 48 && e.keyCode <= 57) return true;\n\n    // 小键盘区域 (除回车外)\n    if (e.keyCode != 108 && e.keyCode >= 96 && e.keyCode <= 111) return true;\n\n    // 小键盘区域 (除回车外)\n    // @yinheli from pull request\n    if (e.keyCode != 108 && e.keyCode >= 96 && e.keyCode <= 111) return true;\n\n    // 输入法\n    if (e.keyCode == 229 || e.keyCode === 0) return true;\n\n    return false;\n  }\n  /**\r\n   * @Desc: 下方使用receiver.enable()和receiver.disable()通过\r\n   *        修改div contenteditable属性的hack来解决开启热核后依然无法屏蔽浏览器输入的bug;\r\n   *        特别: win下FF对于此种情况必须要先blur在focus才能解决，但是由于这样做会导致用户\r\n   *             输入法状态丢失，因此对FF暂不做处理\r\n   * @Editor: Naixor\r\n   * @Date: 2015.09.14\r\n   */\n  function JumpingRuntime() {\n    var fsm = this.fsm;\n    var minder = this.minder;\n    var receiver = this.receiver;\n    var container = this.container;\n    var receiverElement = receiver.element;\n    var hotbox = this.hotbox;\n\n    // normal -> *\n    receiver.listen('normal', function (e) {\n      // 为了防止处理进入edit模式而丢失处理的首字母,此时receiver必须为enable\n      receiver.enable();\n      // normal -> hotbox\n      if (e.is('Space')) {\n        e.preventDefault();\n        // safari下Space触发hotbox,然而这时Space已在receiver上留下作案痕迹,因此抹掉\n        if (kity.Browser.safari) {\n          receiverElement.innerHTML = '';\n        }\n        return fsm.jump('hotbox', 'space-trigger');\n      }\n\n      /**\r\n       * check\r\n       * @editor Naixor\r\n       * @Date 2015-12-2\r\n       */\n      switch (e.type) {\n        case 'keydown':\n          {\n            if (minder.getSelectedNode()) {\n              if (isIntendToInput(e)) {\n                return fsm.jump('input', 'user-input');\n              };\n            } else {\n              receiverElement.innerHTML = '';\n            }\n            // normal -> normal shortcut\n            fsm.jump('normal', 'shortcut-handle', e);\n            break;\n          }\n        case 'keyup':\n          {\n            break;\n          }\n        default:\n          {}\n      }\n    });\n\n    // hotbox -> normal\n    receiver.listen('hotbox', function (e) {\n      receiver.disable();\n      e.preventDefault();\n      var handleResult = hotbox.dispatch(e);\n      if (hotbox.state() == Hotbox.STATE_IDLE && fsm.state() == 'hotbox') {\n        return fsm.jump('normal', 'hotbox-idle');\n      }\n    });\n\n    // input => normal\n    receiver.listen('input', function (e) {\n      receiver.enable();\n      if (e.type == 'keydown') {\n        if (e.is('Enter')) {\n          e.preventDefault();\n          return fsm.jump('normal', 'input-commit');\n        }\n        if (e.is('Esc')) {\n          e.preventDefault();\n          return fsm.jump('normal', 'input-cancel');\n        }\n        if (e.is('Tab') || e.is('Shift + Tab')) {\n          e.preventDefault();\n        }\n      } else if (e.type == 'keyup' && e.is('Esc')) {\n        e.preventDefault();\n        return fsm.jump('normal', 'input-cancel');\n      }\n    });\n\n    //////////////////////////////////////////////\n    /// 右键呼出热盒\n    /// 判断的标准是：按下的位置和结束的位置一致\n    //////////////////////////////////////////////\n    var downX, downY;\n    var MOUSE_RB = 2; // 右键\n\n    container.addEventListener('mousedown', function (e) {\n      if (e.button == MOUSE_RB) {\n        e.preventDefault();\n      }\n      if (fsm.state() == 'hotbox') {\n        hotbox.active(Hotbox.STATE_IDLE);\n        fsm.jump('normal', 'blur');\n      } else if (fsm.state() == 'normal' && e.button == MOUSE_RB) {\n        downX = e.clientX;\n        downY = e.clientY;\n      }\n    }, false);\n\n    container.addEventListener('mousewheel', function (e) {\n      if (fsm.state() == 'hotbox') {\n        hotbox.active(Hotbox.STATE_IDLE);\n        fsm.jump('normal', 'mousemove-blur');\n      }\n    }, false);\n\n    container.addEventListener('contextmenu', function (e) {\n      e.preventDefault();\n    });\n\n    container.addEventListener('mouseup', function (e) {\n      if (fsm.state() != 'normal') {\n        return;\n      }\n      if (e.button != MOUSE_RB || e.clientX != downX || e.clientY != downY) {\n        return;\n      }\n      if (!minder.getSelectedNode()) {\n        return;\n      }\n      fsm.jump('hotbox', 'content-menu');\n    }, false);\n\n    // 阻止热盒事件冒泡，在热盒正确执行前导致热盒关闭\n    hotbox.$element.addEventListener('mousedown', function (e) {\n      e.stopPropagation();\n    });\n  }\n\n  return module.exports = JumpingRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/jumping.js?")},j2um:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_search_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("aN5C");\n/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_search_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_7_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_node_modules_vue_loader_lib_index_js_vue_loader_options_search_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* unused harmony reexport * */\n\n\n//# sourceURL=webpack:///./src/views/search.vue?')},jqor:function(module,exports){eval('/*!\r\n * ====================================================\r\n * Hot Box UI - v1.0.15 - 2017-05-05\r\n * https://github.com/fex-team/hotbox\r\n * GitHub: https://github.com/fex-team/hotbox.git \r\n * Copyright (c) 2017 Baidu FEX; Licensed BSD\r\n * ====================================================\r\n */\r\n\r\n(function () {\r\nvar _p = {\r\n    r: function(index) {\r\n        if (_p[index].inited) {\r\n            return _p[index].value;\r\n        }\r\n        if (typeof _p[index].value === "function") {\r\n            var module = {\r\n                exports: {}\r\n            }, returnValue = _p[index].value(null, module.exports, module);\r\n            _p[index].inited = true;\r\n            _p[index].value = returnValue;\r\n            if (returnValue !== undefined) {\r\n                return returnValue;\r\n            } else {\r\n                for (var key in module.exports) {\r\n                    if (module.exports.hasOwnProperty(key)) {\r\n                        _p[index].inited = true;\r\n                        _p[index].value = module.exports;\r\n                        return module.exports;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            _p[index].inited = true;\r\n            return _p[index].value;\r\n        }\r\n    }\r\n};\r\n\r\n//src/expose.js\r\n_p[0] = {\r\n    value: function(require, exports, module) {\r\n        module.exports = window.HotBox = _p.r(1);\r\n    }\r\n};\r\n\r\n//src/hotbox.js\r\n_p[1] = {\r\n    value: function(require, exports, module) {\r\n        var key = _p.r(2);\r\n        var KeyControl = _p.r(3);\r\n        /**** Dom Utils ****/\r\n        function createElement(name) {\r\n            return document.createElement(name);\r\n        }\r\n        function setElementAttribute(element, name, value) {\r\n            element.setAttribute(name, value);\r\n        }\r\n        function getElementAttribute(element, name) {\r\n            return element.getAttribute(name);\r\n        }\r\n        function addElementClass(element, name) {\r\n            element.classList.add(name);\r\n        }\r\n        function removeElementClass(element, name) {\r\n            element.classList.remove(name);\r\n        }\r\n        function appendChild(parent, child) {\r\n            parent.appendChild(child);\r\n        }\r\n        /*******************/\r\n        var IDLE = HotBox.STATE_IDLE = "idle";\r\n        var div = "div";\r\n        /**\r\n     * Simple Formatter\r\n     */\r\n        function format(template, args) {\r\n            if (typeof args != "object") {\r\n                args = [].slice.apply(arguments, 1);\r\n            }\r\n            return String(template).replace(/\\{(\\w+)\\}/g, function(match, name) {\r\n                return args[name] || match;\r\n            });\r\n        }\r\n        /**\r\n     * Hot Box Class\r\n     */\r\n        function HotBox($container) {\r\n            if (typeof $container == "string") {\r\n                $container = document.querySelector($container);\r\n            }\r\n            if (!$container || !($container instanceof HTMLElement)) {\r\n                throw new Error("No container or not invalid container for hot box");\r\n            }\r\n            // 创建 HotBox Dom 解构\r\n            var $hotBox = createElement(div);\r\n            addElementClass($hotBox, "hotbox");\r\n            appendChild($container, $hotBox);\r\n            // 保存 Dom 解构和父容器\r\n            this.$element = $hotBox;\r\n            this.$container = $container;\r\n            // 标示是否是输入法状态\r\n            this.isIME = false;\r\n            /**\r\n         * @Desc: 增加一个browser用于判断浏览器类型，方便解决兼容性问题\r\n         * @Editor: Naixor\r\n         * @Date: 2015.09.14\r\n         */\r\n            this.browser = {\r\n                sg: /se[\\s\\S]+metasr/.test(navigator.userAgent.toLowerCase())\r\n            };\r\n            /*\r\n        * added by zhangbobell\r\n        * 2015.09.22\r\n        * 增加父状态机，以解决在父 FSM 下状态控制的问题，最好的解决办法是增加一个函数队列\r\n        * 将其中的函数一起执行。//TODO\r\n        * */\r\n            this._parentFSM = {};\r\n            // 记录位置\r\n            this.position = {};\r\n            // 已定义的状态（string => HotBoxState）\r\n            var _states = {};\r\n            // 主状态（HotBoxState）\r\n            var _mainState = null;\r\n            // 当前状态（HotBoxState）\r\n            var _currentState = IDLE;\r\n            // 当前状态堆栈\r\n            var _stateStack = [];\r\n            // 实例引用\r\n            var _this = this;\r\n            var _controler;\r\n            /**\r\n         * Controller: {\r\n         *     constructor(hotbox: HotBox),\r\n         *     active: () => void\r\n         * }\r\n         */\r\n            function _control(Controller) {\r\n                if (_controler) {\r\n                    _controler.active();\r\n                    return;\r\n                }\r\n                Controller = Controller || KeyControl;\r\n                _controler = new Controller(_this);\r\n                _controler.active();\r\n                $hotBox.onmousedown = function(e) {\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                };\r\n                return _this;\r\n            }\r\n            function _dispatchKey(e) {\r\n                var type = e.type.toLowerCase();\r\n                e.keyHash = key.hash(e);\r\n                e.isKey = function(keyExpression) {\r\n                    if (!keyExpression) return false;\r\n                    var expressions = keyExpression.split(/\\s*\\|\\s*/);\r\n                    while (expressions.length) {\r\n                        if (e.keyHash == key.hash(expressions.shift())) return true;\r\n                    }\r\n                    return false;\r\n                };\r\n                e[type] = true;\r\n                // Boot: keyup and activeKey pressed on IDLE, active main state.\r\n                if (e.keyup && _this.activeKey && e.isKey(_this.activeKey) && _currentState == IDLE && _mainState) {\r\n                    _activeState("main", {\r\n                        x: $container.clientWidth / 2,\r\n                        y: $container.clientHeight / 2\r\n                    });\r\n                    return;\r\n                }\r\n                var handleState = _currentState == IDLE ? _mainState : _currentState;\r\n                if (handleState) {\r\n                    var handleResult = handleState.handleKeyEvent(e);\r\n                    if (typeof _this.onkeyevent == "function") {\r\n                        e.handleResult = handleResult;\r\n                        _this.onkeyevent(e, handleResult);\r\n                    }\r\n                    return handleResult;\r\n                }\r\n                return null;\r\n            }\r\n            function _addState(name) {\r\n                if (!name) return _currentState;\r\n                if (name == IDLE) {\r\n                    throw new Error("Can not define or use the `idle` state.");\r\n                }\r\n                _states[name] = _states[name] || new HotBoxState(this, name);\r\n                if (name == "main") {\r\n                    _mainState = _states[name];\r\n                }\r\n                return _states[name];\r\n            }\r\n            function _activeState(name, position) {\r\n                _this.position = position;\r\n                // 回到 IDLE\r\n                if (name == IDLE) {\r\n                    if (_currentState != IDLE) {\r\n                        _stateStack.shift().deactive();\r\n                        _stateStack = [];\r\n                    }\r\n                    _currentState = IDLE;\r\n                } else if (name == "back") {\r\n                    if (_currentState != IDLE) {\r\n                        _currentState.deactive();\r\n                        _stateStack.shift();\r\n                        _currentState = _stateStack[0];\r\n                        if (_currentState) {\r\n                            _currentState.active();\r\n                        } else {\r\n                            _currentState = "idle";\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (_currentState != IDLE) {\r\n                        _currentState.deactive();\r\n                    }\r\n                    var newState = _states[name];\r\n                    _stateStack.unshift(newState);\r\n                    if (typeof _this.position == "function") {\r\n                        position = _this.position(position);\r\n                    }\r\n                    newState.active(position);\r\n                    _currentState = newState;\r\n                }\r\n            }\r\n            function setParentFSM(fsm) {\r\n                _this._parentFSM = fsm;\r\n            }\r\n            function getParentFSM() {\r\n                return _this._parentFSM;\r\n            }\r\n            this.control = _control;\r\n            this.state = _addState;\r\n            this.active = _activeState;\r\n            this.dispatch = _dispatchKey;\r\n            this.setParentFSM = setParentFSM;\r\n            this.getParentFSM = getParentFSM;\r\n            this.activeKey = "space";\r\n            this.actionKey = "space";\r\n        }\r\n        /**\r\n     * 表示热盒某个状态，包含这些状态需要的 Dom 对象\r\n     */\r\n        function HotBoxState(hotBox, stateName) {\r\n            var BUTTON_SELECTED_CLASS = "selected";\r\n            var BUTTON_PRESSED_CLASS = "pressed";\r\n            var STATE_ACTIVE_CLASS = "active";\r\n            // 状态容器\r\n            var $state = createElement(div);\r\n            // 四种可见的按钮容器\r\n            var $center = createElement(div);\r\n            var $ring = createElement(div);\r\n            var $ringShape = createElement("div");\r\n            var $top = createElement(div);\r\n            var $bottom = createElement(div);\r\n            // 添加 CSS 类\r\n            addElementClass($state, "state");\r\n            addElementClass($state, stateName);\r\n            addElementClass($center, "center");\r\n            addElementClass($ring, "ring");\r\n            addElementClass($ringShape, "ring-shape");\r\n            addElementClass($top, "top");\r\n            addElementClass($bottom, "bottom");\r\n            // 摆放容器\r\n            appendChild(hotBox.$element, $state);\r\n            appendChild($state, $ringShape);\r\n            appendChild($state, $center);\r\n            appendChild($state, $ring);\r\n            appendChild($state, $top);\r\n            appendChild($state, $bottom);\r\n            // 记住状态名称\r\n            this.name = stateName;\r\n            // 五种按钮：中心，圆环，上栏，下栏，幕后\r\n            var buttons = {\r\n                center: null,\r\n                ring: [],\r\n                top: [],\r\n                bottom: [],\r\n                behind: []\r\n            };\r\n            var allButtons = [];\r\n            var selectedButton = null;\r\n            var pressedButton = null;\r\n            var stateActived = false;\r\n            // 布局，添加按钮后，标记需要布局\r\n            var needLayout = true;\r\n            function layout() {\r\n                var radius = buttons.ring.length * 15;\r\n                layoutRing(radius);\r\n                layoutTop(radius);\r\n                layoutBottom(radius);\r\n                indexPosition();\r\n                needLayout = false;\r\n                function layoutRing(radius) {\r\n                    var ring = buttons.ring;\r\n                    var step = 2 * Math.PI / ring.length;\r\n                    if (buttons.center) {\r\n                        buttons.center.indexedPosition = [ 0, 0 ];\r\n                    }\r\n                    $ringShape.style.marginLeft = $ringShape.style.marginTop = -radius + "px";\r\n                    $ringShape.style.width = $ringShape.style.height = radius + radius + "px";\r\n                    var $button, angle, x, y;\r\n                    for (var i = 0; i < ring.length; i++) {\r\n                        $button = ring[i].$button;\r\n                        angle = step * i - Math.PI / 2;\r\n                        x = radius * Math.cos(angle);\r\n                        y = radius * Math.sin(angle);\r\n                        ring[i].indexedPosition = [ x, y ];\r\n                        $button.style.left = x + "px";\r\n                        $button.style.top = y + "px";\r\n                    }\r\n                }\r\n                function layoutTop(radius) {\r\n                    var xOffset = -$top.clientWidth / 2;\r\n                    var yOffset = -radius * 2 - $top.clientHeight / 2;\r\n                    $top.style.marginLeft = xOffset + "px";\r\n                    $top.style.marginTop = yOffset + "px";\r\n                    buttons.top.forEach(function(topButton) {\r\n                        var $button = topButton.$button;\r\n                        topButton.indexedPosition = [ xOffset + $button.offsetLeft + $button.clientWidth / 2, yOffset ];\r\n                    });\r\n                }\r\n                function layoutBottom(radius) {\r\n                    var xOffset = -$bottom.clientWidth / 2;\r\n                    var yOffset = radius * 2 - $bottom.clientHeight / 2;\r\n                    $bottom.style.marginLeft = xOffset + "px";\r\n                    $bottom.style.marginTop = yOffset + "px";\r\n                    buttons.bottom.forEach(function(bottomButton) {\r\n                        var $button = bottomButton.$button;\r\n                        bottomButton.indexedPosition = [ xOffset + $button.offsetLeft + $button.clientWidth / 2, yOffset ];\r\n                    });\r\n                }\r\n                function indexPosition() {\r\n                    var positionedButtons = allButtons.filter(function(button) {\r\n                        return button.indexedPosition;\r\n                    });\r\n                    positionedButtons.forEach(findNeightbour);\r\n                    function findNeightbour(button) {\r\n                        var neighbor = {};\r\n                        var coef = 0;\r\n                        var minCoef = {};\r\n                        var homePosition = button.indexedPosition;\r\n                        var candidatePosition, dx, dy, ds;\r\n                        var possible, dir;\r\n                        var abs = Math.abs;\r\n                        positionedButtons.forEach(function(candidate) {\r\n                            if (button == candidate) return;\r\n                            candidatePosition = candidate.indexedPosition;\r\n                            possible = [];\r\n                            dx = candidatePosition[0] - homePosition[0];\r\n                            dy = candidatePosition[1] - homePosition[1];\r\n                            ds = Math.sqrt(dx * dx + dy * dy);\r\n                            if (abs(dx) > 2) {\r\n                                possible.push(dx > 0 ? "right" : "left");\r\n                                possible.push(ds + abs(dy));\r\n                            }\r\n                            if (abs(dy) > 2) {\r\n                                possible.push(dy > 0 ? "down" : "up");\r\n                                possible.push(ds + abs(dx));\r\n                            }\r\n                            while (possible.length) {\r\n                                dir = possible.shift();\r\n                                coef = possible.shift();\r\n                                if (!neighbor[dir] || coef < minCoef[dir]) {\r\n                                    neighbor[dir] = candidate;\r\n                                    minCoef[dir] = coef;\r\n                                }\r\n                            }\r\n                        });\r\n                        button.neighbor = neighbor;\r\n                    }\r\n                }\r\n            }\r\n            function alwaysEnable() {\r\n                return true;\r\n            }\r\n            // 为状态创建按钮\r\n            function createButton(option) {\r\n                var $button = createElement(div);\r\n                addElementClass($button, "button");\r\n                var render = option.render || defaultButtonRender;\r\n                $button.innerHTML = render(format, option);\r\n                switch (option.position) {\r\n                  case "center":\r\n                    appendChild($center, $button);\r\n                    break;\r\n\r\n                  case "ring":\r\n                    appendChild($ring, $button);\r\n                    break;\r\n\r\n                  case "top":\r\n                    appendChild($top, $button);\r\n                    break;\r\n\r\n                  case "bottom":\r\n                    appendChild($bottom, $button);\r\n                    break;\r\n                }\r\n                return {\r\n                    action: option.action,\r\n                    enable: option.enable || alwaysEnable,\r\n                    beforeShow: option.beforeShow,\r\n                    key: option.key,\r\n                    next: option.next,\r\n                    label: option.label,\r\n                    data: option.data || null,\r\n                    $button: $button\r\n                };\r\n            }\r\n            // 默认按钮渲染\r\n            function defaultButtonRender(format, option) {\r\n                return format(\'<span class="label">{label}</span><span class="key">{key}</span>\', {\r\n                    label: option.label,\r\n                    key: option.key && option.key.split("|")[0]\r\n                });\r\n            }\r\n            // 为当前状态添加按钮\r\n            this.button = function(option) {\r\n                var button = createButton(option);\r\n                if (option.position == "center") {\r\n                    buttons.center = button;\r\n                } else if (buttons[option.position]) {\r\n                    buttons[option.position].push(button);\r\n                }\r\n                allButtons.push(button);\r\n                needLayout = true;\r\n            };\r\n            function activeState(position) {\r\n                position = position || {\r\n                    x: hotBox.$container.clientWidth / 2,\r\n                    y: hotBox.$container.clientHeight / 2\r\n                };\r\n                if (position) {\r\n                    $state.style.left = position.x + "px";\r\n                    $state.style.top = position.y + "px";\r\n                }\r\n                allButtons.forEach(function(button) {\r\n                    var $button = button.$button;\r\n                    if ($button) {\r\n                        $button.classList[button.enable() ? "add" : "remove"]("enabled");\r\n                    }\r\n                    if (button.beforeShow) {\r\n                        button.beforeShow();\r\n                    }\r\n                });\r\n                addElementClass($state, STATE_ACTIVE_CLASS);\r\n                if (needLayout) {\r\n                    layout();\r\n                }\r\n                if (!selectedButton) {\r\n                    select(buttons.center || buttons.ring[0] || buttons.top[0] || buttons.bottom[0]);\r\n                }\r\n                stateActived = true;\r\n            }\r\n            function deactiveState() {\r\n                removeElementClass($state, STATE_ACTIVE_CLASS);\r\n                select(null);\r\n                stateActived = false;\r\n            }\r\n            // 激活当前状态\r\n            this.active = activeState;\r\n            // 反激活当前状态\r\n            this.deactive = deactiveState;\r\n            function press(button) {\r\n                if (pressedButton && pressedButton.$button) {\r\n                    removeElementClass(pressedButton.$button, BUTTON_PRESSED_CLASS);\r\n                }\r\n                pressedButton = button;\r\n                if (pressedButton && pressedButton.$button) {\r\n                    addElementClass(pressedButton.$button, BUTTON_PRESSED_CLASS);\r\n                }\r\n            }\r\n            function select(button) {\r\n                if (selectedButton && selectedButton.$button) {\r\n                    if (selectedButton.$button) {\r\n                        removeElementClass(selectedButton.$button, BUTTON_SELECTED_CLASS);\r\n                    }\r\n                }\r\n                selectedButton = button;\r\n                if (selectedButton && selectedButton.$button) {\r\n                    addElementClass(selectedButton.$button, BUTTON_SELECTED_CLASS);\r\n                }\r\n            }\r\n            $state.onmouseup = function(e) {\r\n                if (e.button) return;\r\n                var target = e.target;\r\n                while (target && target != $state) {\r\n                    if (target.classList.contains("button")) {\r\n                        allButtons.forEach(function(button) {\r\n                            if (button.$button == target) {\r\n                                execute(button);\r\n                            }\r\n                        });\r\n                    }\r\n                    target = target.parentNode;\r\n                }\r\n            };\r\n            this.handleKeyEvent = function(e) {\r\n                var handleResult = null;\r\n                /**\r\n             * @Desc: 搜狗浏览器下esc只触发keyup，因此做兼容性处理\r\n             * @Editor: Naixor\r\n             * @Date: 2015.09.14\r\n             */\r\n                if (hotBox.browser.sg) {\r\n                    if (e.isKey("esc")) {\r\n                        if (pressedButton) {\r\n                            // 若存在已经按下的按钮，则取消操作\r\n                            if (!e.isKey(pressedButton.key)) {\r\n                                // the button is not esc\r\n                                press(null);\r\n                            }\r\n                        } else {\r\n                            hotBox.active("back", hotBox.position);\r\n                        }\r\n                        return "back";\r\n                    }\r\n                }\r\n                if (e.keydown || hotBox.isIME && e.keyup) {\r\n                    allButtons.forEach(function(button) {\r\n                        if (button.enable() && e.isKey(button.key)) {\r\n                            if (stateActived || hotBox.hintDeactiveMainState) {\r\n                                select(button);\r\n                                press(button);\r\n                                handleResult = "buttonpress";\r\n                                // 如果是 keyup 事件触发的，因为没有后续的按键事件，所以就直接执行\r\n                                if (e.keyup) {\r\n                                    execute(button);\r\n                                    handleResult = "execute";\r\n                                    return handleResult;\r\n                                }\r\n                            } else {\r\n                                execute(button);\r\n                                handleResult = "execute";\r\n                            }\r\n                            e.preventDefault();\r\n                            e.stopPropagation();\r\n                            if (!stateActived && hotBox.hintDeactiveMainState) {\r\n                                hotBox.active(stateName, hotBox.position);\r\n                            }\r\n                        }\r\n                    });\r\n                    if (stateActived) {\r\n                        if (e.isKey("esc")) {\r\n                            if (pressedButton) {\r\n                                // 若存在已经按下的按钮，则取消操作\r\n                                if (!e.isKey(pressedButton.key)) {\r\n                                    // the button is not esc\r\n                                    press(null);\r\n                                }\r\n                            } else {\r\n                                hotBox.active("back", hotBox.position);\r\n                            }\r\n                            return "back";\r\n                        }\r\n                        [ "up", "down", "left", "right" ].forEach(function(dir) {\r\n                            if (!e.isKey(dir)) return;\r\n                            if (!selectedButton) {\r\n                                select(buttons.center || buttons.ring[0] || buttons.top[0] || buttons.bottom[0]);\r\n                                return;\r\n                            }\r\n                            var neighbor = selectedButton.neighbor[dir];\r\n                            while (neighbor && !neighbor.enable()) {\r\n                                neighbor = neighbor.neighbor[dir];\r\n                            }\r\n                            if (neighbor) {\r\n                                select(neighbor);\r\n                            }\r\n                            handleResult = "navigate";\r\n                        });\r\n                        // 若是由 keyup 触发的，则直接执行选中的按钮\r\n                        if (e.isKey("space") && e.keyup) {\r\n                            execute(selectedButton);\r\n                            e.preventDefault();\r\n                            e.stopPropagation();\r\n                            handleResult = "execute";\r\n                        } else if (e.isKey("space") && selectedButton) {\r\n                            press(selectedButton);\r\n                            handleResult = "buttonpress";\r\n                        } else if (pressedButton && pressedButton != selectedButton) {\r\n                            press(null);\r\n                            handleResult = "selectcancel";\r\n                        }\r\n                    }\r\n                } else if (e.keyup && (stateActived || !hotBox.hintDeactiveMainState)) {\r\n                    if (pressedButton) {\r\n                        if (e.isKey("space") && selectedButton == pressedButton || e.isKey(pressedButton.key)) {\r\n                            execute(pressedButton);\r\n                            e.preventDefault();\r\n                            e.stopPropagation();\r\n                            handleResult = "execute";\r\n                        }\r\n                    }\r\n                }\r\n                /*\r\n             * Add by zhangbobell 2015.09.06\r\n             * 增加了下面这一个判断因为 safari 下开启输入法后，所有的 keydown 的 keycode 都为 229，\r\n             * 只能以 keyup 的 keycode 进行判断\r\n             * */\r\n                hotBox.isIME = e.keyCode == 229 && e.keydown;\r\n                return handleResult;\r\n            };\r\n            function execute(button) {\r\n                if (button) {\r\n                    if (!button.enable || button.enable()) {\r\n                        if (button.action) button.action(button);\r\n                        hotBox.active(button.next || IDLE, hotBox.position);\r\n                    }\r\n                    press(null);\r\n                    select(null);\r\n                }\r\n            }\r\n        }\r\n        module.exports = HotBox;\r\n    }\r\n};\r\n\r\n//src/key.js\r\n_p[2] = {\r\n    value: function(require, exports, module) {\r\n        var keymap = _p.r(4);\r\n        var CTRL_MASK = 4096;\r\n        var ALT_MASK = 8192;\r\n        var SHIFT_MASK = 16384;\r\n        function hash(unknown) {\r\n            if (typeof unknown == "string") {\r\n                return hashKeyExpression(unknown);\r\n            }\r\n            return hashKeyEvent(unknown);\r\n        }\r\n        function is(a, b) {\r\n            return a && b && hash(a) == hash(b);\r\n        }\r\n        exports.hash = hash;\r\n        exports.is = is;\r\n        function hashKeyEvent(keyEvent) {\r\n            var hashCode = 0;\r\n            if (keyEvent.ctrlKey || keyEvent.metaKey) {\r\n                hashCode |= CTRL_MASK;\r\n            }\r\n            if (keyEvent.altKey) {\r\n                hashCode |= ALT_MASK;\r\n            }\r\n            if (keyEvent.shiftKey) {\r\n                hashCode |= SHIFT_MASK;\r\n            }\r\n            // Shift, Control, Alt KeyCode ignored.\r\n            if ([ 16, 17, 18, 91 ].indexOf(keyEvent.keyCode) == -1) {\r\n                hashCode |= keyEvent.keyCode;\r\n            }\r\n            return hashCode;\r\n        }\r\n        function hashKeyExpression(keyExpression) {\r\n            var hashCode = 0;\r\n            keyExpression.toLowerCase().split(/\\s*\\+\\s*/).forEach(function(name) {\r\n                switch (name) {\r\n                  case "ctrl":\r\n                  case "cmd":\r\n                    hashCode |= CTRL_MASK;\r\n                    break;\r\n\r\n                  case "alt":\r\n                    hashCode |= ALT_MASK;\r\n                    break;\r\n\r\n                  case "shift":\r\n                    hashCode |= SHIFT_MASK;\r\n                    break;\r\n\r\n                  default:\r\n                    hashCode |= keymap[name];\r\n                }\r\n            });\r\n            return hashCode;\r\n        }\r\n    }\r\n};\r\n\r\n//src/keycontrol.js\r\n_p[3] = {\r\n    value: function(require, exports, module) {\r\n        var key = _p.r(2);\r\n        var FOCUS_CLASS = "hotbox-focus";\r\n        var RECEIVER_CLASS = "hotbox-key-receiver";\r\n        function KeyControl(hotbox) {\r\n            var _this = this;\r\n            var _receiver;\r\n            var _actived = true;\r\n            var _receiverIsSelfCreated = false;\r\n            var $container = hotbox.$container;\r\n            _createReceiver();\r\n            _bindReceiver();\r\n            _bindContainer();\r\n            _active();\r\n            function _createReceiver() {\r\n                _receiver = document.createElement("input");\r\n                _receiver.classList.add(RECEIVER_CLASS);\r\n                $container.appendChild(_receiver);\r\n                _receiverIsSelfCreated = true;\r\n            }\r\n            function _bindReceiver() {\r\n                _receiver.onkeyup = _handle;\r\n                _receiver.onkeypress = _handle;\r\n                _receiver.onkeydown = _handle;\r\n                _receiver.onfocus = _active;\r\n                _receiver.onblur = _deactive;\r\n                if (_receiverIsSelfCreated) {\r\n                    _receiver.oninput = function(e) {\r\n                        _receiver.value = null;\r\n                    };\r\n                }\r\n            }\r\n            function _bindContainer() {\r\n                $container.onmousedown = function(e) {\r\n                    _active();\r\n                    e.preventDefault();\r\n                };\r\n            }\r\n            function _handle(keyEvent) {\r\n                if (!_actived) return;\r\n                hotbox.dispatch(keyEvent);\r\n            }\r\n            function _active() {\r\n                _receiver.select();\r\n                _receiver.focus();\r\n                _actived = true;\r\n                $container.classList.add(FOCUS_CLASS);\r\n            }\r\n            function _deactive() {\r\n                _receiver.blur();\r\n                _actived = false;\r\n                $container.classList.remove(FOCUS_CLASS);\r\n            }\r\n            this.handle = _handle;\r\n            this.active = _active;\r\n            this.deactive = _deactive;\r\n        }\r\n        module.exports = KeyControl;\r\n    }\r\n};\r\n\r\n//src/keymap.js\r\n_p[4] = {\r\n    value: function(require, exports, module) {\r\n        var keymap = {\r\n            Shift: 16,\r\n            Control: 17,\r\n            Alt: 18,\r\n            CapsLock: 20,\r\n            BackSpace: 8,\r\n            Tab: 9,\r\n            Enter: 13,\r\n            Esc: 27,\r\n            Space: 32,\r\n            PageUp: 33,\r\n            PageDown: 34,\r\n            End: 35,\r\n            Home: 36,\r\n            Insert: 45,\r\n            Left: 37,\r\n            Up: 38,\r\n            Right: 39,\r\n            Down: 40,\r\n            Direction: {\r\n                37: 1,\r\n                38: 1,\r\n                39: 1,\r\n                40: 1\r\n            },\r\n            Delete: 46,\r\n            NumLock: 144,\r\n            Cmd: 91,\r\n            CmdFF: 224,\r\n            F1: 112,\r\n            F2: 113,\r\n            F3: 114,\r\n            F4: 115,\r\n            F5: 116,\r\n            F6: 117,\r\n            F7: 118,\r\n            F8: 119,\r\n            F9: 120,\r\n            F10: 121,\r\n            F11: 122,\r\n            F12: 123,\r\n            "`": 192,\r\n            "=": 187,\r\n            "-": 189,\r\n            "/": 191,\r\n            ".": 190\r\n        };\r\n        // 小写适配\r\n        for (var key in keymap) {\r\n            if (keymap.hasOwnProperty(key)) {\r\n                keymap[key.toLowerCase()] = keymap[key];\r\n            }\r\n        }\r\n        var aKeyCode = 65;\r\n        var aCharCode = "a".charCodeAt(0);\r\n        // letters\r\n        "abcdefghijklmnopqrstuvwxyz".split("").forEach(function(letter) {\r\n            keymap[letter] = aKeyCode + (letter.charCodeAt(0) - aCharCode);\r\n        });\r\n        // numbers\r\n        var n = 9;\r\n        do {\r\n            keymap[n.toString()] = n + 48;\r\n        } while (n--);\r\n        module.exports = keymap;\r\n    }\r\n};\r\n\r\nvar moduleMapping = {\r\n    expose: 0\r\n};\r\n\r\nfunction use(name) {\r\n    _p.r([ moduleMapping[name] ]);\r\n}\r\nuse(\'expose\');\r\n})();\n\n//# sourceURL=webpack:///./hotbox/hotbox.js?')},lrL8:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n\n  function ClipboardRuntime() {\n    var minder = this.minder;\n    var Data = window.kityminder.data;\n\n    if (!minder.supportClipboardEvent || kity.Browser.gecko) {\n      return;\n    };\n\n    var fsm = this.fsm;\n    var receiver = this.receiver;\n    var MimeType = this.MimeType;\n\n    var kmencode = MimeType.getMimeTypeProtocol('application/km'),\n        decode = Data.getRegisterProtocol('json').decode;\n    var _selectedNodes = [];\n\n    /*\r\n     * 增加对多节点赋值粘贴的处理\r\n     */\n    function encode(nodes) {\n      var _nodes = [];\n      for (var i = 0, l = nodes.length; i < l; i++) {\n        _nodes.push(minder.exportNode(nodes[i]));\n      }\n      return kmencode(Data.getRegisterProtocol('json').encode(_nodes));\n    }\n\n    var beforeCopy = function beforeCopy(e) {\n      if (document.activeElement == receiver.element) {\n        var clipBoardEvent = e;\n        var state = fsm.state();\n\n        switch (state) {\n          case 'input':\n            {\n              break;\n            }\n          case 'normal':\n            {\n              var nodes = [].concat(minder.getSelectedNodes());\n              if (nodes.length) {\n                // 这里由于被粘贴复制的节点的id信息也都一样，故做此算法\n                // 这里有个疑问，使用node.getParent()或者node.parent会离奇导致出现非选中节点被渲染成选中节点，因此使用isAncestorOf，而没有使用自行回溯的方式\n                if (nodes.length > 1) {\n                  var targetLevel;\n                  nodes.sort(function (a, b) {\n                    return a.getLevel() - b.getLevel();\n                  });\n                  targetLevel = nodes[0].getLevel();\n                  if (targetLevel !== nodes[nodes.length - 1].getLevel()) {\n                    var plevel,\n                        pnode,\n                        idx = 0,\n                        l = nodes.length,\n                        pidx = l - 1;\n\n                    pnode = nodes[pidx];\n\n                    while (pnode.getLevel() !== targetLevel) {\n                      idx = 0;\n                      while (idx < l && nodes[idx].getLevel() === targetLevel) {\n                        if (nodes[idx].isAncestorOf(pnode)) {\n                          nodes.splice(pidx, 1);\n                          break;\n                        }\n                        idx++;\n                      }\n                      pidx--;\n                      pnode = nodes[pidx];\n                    }\n                  };\n                };\n                var str = encode(nodes);\n                clipBoardEvent.clipboardData.setData('text/plain', str);\n              }\n              e.preventDefault();\n              break;\n            }\n        }\n      }\n    };\n\n    var beforeCut = function beforeCut(e) {\n      if (document.activeElement == receiver.element) {\n        if (minder.getStatus() !== 'normal') {\n          e.preventDefault();\n          return;\n        };\n\n        var clipBoardEvent = e;\n        var state = fsm.state();\n\n        switch (state) {\n          case 'input':\n            {\n              break;\n            }\n          case 'normal':\n            {\n              var nodes = minder.getSelectedNodes();\n              if (nodes.length) {\n                clipBoardEvent.clipboardData.setData('text/plain', encode(nodes));\n                minder.execCommand('removenode');\n              }\n              e.preventDefault();\n              break;\n            }\n        }\n      };\n    };\n\n    var beforePaste = function beforePaste(e) {\n      if (document.activeElement == receiver.element) {\n        if (minder.getStatus() !== 'normal') {\n          e.preventDefault();\n          return;\n        };\n\n        var clipBoardEvent = e;\n        var state = fsm.state();\n        var textData = clipBoardEvent.clipboardData.getData('text/plain');\n\n        switch (state) {\n          case 'input':\n            {\n              // input状态下如果格式为application/km则不进行paste操作\n              if (!MimeType.isPureText(textData)) {\n                e.preventDefault();\n                return;\n              };\n              break;\n            }\n          case 'normal':\n            {\n              /*\r\n               * 针对normal状态下通过对选中节点粘贴导入子节点文本进行单独处理\r\n               */\n              var sNodes = minder.getSelectedNodes();\n\n              if (MimeType.whichMimeType(textData) === 'application/km') {\n                var nodes = decode(MimeType.getPureText(textData));\n                var _node;\n                sNodes.forEach(function (node) {\n                  // 由于粘贴逻辑中为了排除子节点重新排序导致逆序，因此复制的时候倒过来\n                  for (var i = nodes.length - 1; i >= 0; i--) {\n                    _node = minder.createNode(null, node);\n                    minder.importNode(_node, nodes[i]);\n                    _selectedNodes.push(_node);\n                    node.appendChild(_node);\n                  }\n                });\n                minder.select(_selectedNodes, true);\n                _selectedNodes = [];\n\n                minder.refresh();\n              } else if (clipBoardEvent.clipboardData && clipBoardEvent.clipboardData.items[0].type.indexOf('image') > -1) {\n                var imageFile = clipBoardEvent.clipboardData.items[0].getAsFile();\n                var serverService = angular.element(document.body).injector().get('server');\n\n                return serverService.uploadImage(imageFile).then(function (json) {\n                  var resp = json.data;\n                  if (resp.errno === 0) {\n                    minder.execCommand('image', resp.data.url);\n                  }\n                });\n              } else {\n                sNodes.forEach(function (node) {\n                  minder.Text2Children(node, textData);\n                });\n              }\n              e.preventDefault();\n              break;\n            }\n        }\n      }\n    };\n    /**\r\n     * 由editor的receiver统一处理全部事件，包括clipboard事件\r\n     * @Editor: Naixor\r\n     * @Date: 2015.9.24\r\n     */\n    document.addEventListener('copy', beforeCopy);\n    document.addEventListener('cut', beforeCut);\n    document.addEventListener('paste', beforePaste);\n  }\n\n  return module.exports = ClipboardRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/clipboard.js?")},"ndr+":function(module,exports,__webpack_require__){eval('/* WEBPACK VAR INJECTION */(function(process) {/*!\n * ====================================================\n * Kity Minder Core - v1.4.50 - 2021-01-14\n * https://github.com/fex-team/kityminder-core\n * GitHub: https://github.com/fex-team/kityminder-core.git\n * Copyright (c) 2021 Baidu FEX; Licensed BSD-3-Clause\n * ====================================================\n */\n\n(function () {\nvar _p = {\n    r: function(index) {\n        if (_p[index].inited) {\n            return _p[index].value;\n        }\n        if (typeof _p[index].value === "function") {\n            var module = {\n                exports: {}\n            }, returnValue = _p[index].value(null, module.exports, module);\n            _p[index].inited = true;\n            _p[index].value = returnValue;\n            if (returnValue !== undefined) {\n                return returnValue;\n            } else {\n                for (var key in module.exports) {\n                    if (module.exports.hasOwnProperty(key)) {\n                        _p[index].inited = true;\n                        _p[index].value = module.exports;\n                        return module.exports;\n                    }\n                }\n            }\n        } else {\n            _p[index].inited = true;\n            return _p[index].value;\n        }\n    }\n};\n\n//src/connect/arc.js\n/**\n * @fileOverview\n *\n * 圆弧连线\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[0] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        var connectMarker = new kity.Marker().pipe(function() {\n            var r = 7;\n            var dot = new kity.Circle(r - 1);\n            this.addShape(dot);\n            this.setRef(r - 1, 0).setViewBox(-r, -r, r + r, r + r).setWidth(r).setHeight(r);\n            this.dot = dot;\n            this.node.setAttribute("markerUnits", "userSpaceOnUse");\n        });\n        connect.register("arc", function(node, parent, connection, width, color) {\n            var box = node.getLayoutBox(), pBox = parent.getLayoutBox();\n            var start, end, vector;\n            var abs = Math.abs;\n            var pathData = [];\n            var side = box.x > pBox.x ? "right" : "left";\n            node.getMinder().getPaper().addResource(connectMarker);\n            start = new kity.Point(pBox.cx, pBox.cy);\n            end = side == "left" ? new kity.Point(box.right + 2, box.cy) : new kity.Point(box.left - 2, box.cy);\n            vector = kity.Vector.fromPoints(start, end);\n            pathData.push("M", start);\n            pathData.push("A", abs(vector.x), abs(vector.y), 0, 0, vector.x * vector.y > 0 ? 0 : 1, end);\n            connection.setMarker(connectMarker);\n            connectMarker.dot.fill(color);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/connect/arc_tp.js\n/**\n *\n * 圆弧连线\n *\n * @author: along\n * @copyright: bpd729@163.com , 2015\n */\n_p[1] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        var connectMarker = new kity.Marker().pipe(function() {\n            var r = 7;\n            var dot = new kity.Circle(r - 1);\n            this.addShape(dot);\n            this.setRef(r - 1, 0).setViewBox(-r, -r, r + r, r + r).setWidth(r).setHeight(r);\n            this.dot = dot;\n            this.node.setAttribute("markerUnits", "userSpaceOnUse");\n        });\n        /**\n     * 天盘图连线除了连接当前节点和前一个节点外, 还需要渲染当前节点和后一个节点的连接, 防止样式上的断线\n     * 这是天盘图与其余的模板不同的地方\n     */\n        connect.register("arc_tp", function(node, parent, connection, width, color) {\n            var end_box = node.getLayoutBox(), start_box = parent.getLayoutBox();\n            var index = node.getIndex();\n            var nextNode = parent.getChildren()[index + 1];\n            if (node.getIndex() > 0) {\n                start_box = parent.getChildren()[index - 1].getLayoutBox();\n            }\n            var start, end, vector;\n            var abs = Math.abs;\n            var pathData = [];\n            var side = end_box.x > start_box.x ? "right" : "left";\n            node.getMinder().getPaper().addResource(connectMarker);\n            start = new kity.Point(start_box.cx, start_box.cy);\n            end = new kity.Point(end_box.cx, end_box.cy);\n            var jl = Math.sqrt(Math.pow(start.x - end.x, 2) + Math.pow(start.y - end.y, 2));\n            //两圆中心点距离\n            jl = node.getIndex() == 0 ? jl * .4 : jl;\n            vector = kity.Vector.fromPoints(start, end);\n            pathData.push("M", start);\n            pathData.push("A", jl, jl, 0, 0, 1, end);\n            connection.setMarker(connectMarker);\n            connectMarker.dot.fill(color);\n            connection.setPathData(pathData);\n            // 设置下一个的节点的连接线\n            if (nextNode && nextNode.getConnection()) {\n                var nextConnection = nextNode.getConnection();\n                var next_end_box = nextNode.getLayoutBox();\n                var next_end = new kity.Point(next_end_box.cx, next_end_box.cy);\n                var jl2 = Math.sqrt(Math.pow(end.x - next_end.x, 2) + Math.pow(end.y - next_end.y, 2));\n                //两圆中心点距离\n                pathData = [];\n                pathData.push("M", end);\n                pathData.push("A", jl2, jl2, 0, 0, 1, next_end);\n                nextConnection.setMarker(connectMarker);\n                connectMarker.dot.fill(color);\n                nextConnection.setPathData(pathData);\n            }\n        });\n    }\n};\n\n//src/connect/bezier.js\n/**\n * @fileOverview\n *\n * 提供折线相连的方法\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[2] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        connect.register("bezier", function(node, parent, connection) {\n            // 连线起点和终点\n            var po = parent.getLayoutVertexOut(), pi = node.getLayoutVertexIn();\n            // 连线矢量和方向\n            var v = parent.getLayoutVectorOut().normalize();\n            var r = Math.round;\n            var abs = Math.abs;\n            var pathData = [];\n            pathData.push("M", r(po.x), r(po.y));\n            if (abs(v.x) > abs(v.y)) {\n                // x - direction\n                var hx = (pi.x + po.x) / 2;\n                pathData.push("C", hx, po.y, hx, pi.y, pi.x, pi.y);\n            } else {\n                // y - direction\n                var hy = (pi.y + po.y) / 2;\n                pathData.push("C", po.x, hy, pi.x, hy, pi.x, pi.y);\n            }\n            connection.setMarker(null);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/connect/fish-bone-master.js\n/**\n * @fileOverview\n *\n * 鱼骨头主干连线\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[3] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        connect.register("fish-bone-master", function(node, parent, connection) {\n            var pout = parent.getLayoutVertexOut(), pin = node.getLayoutVertexIn();\n            var abs = Math.abs;\n            var dy = abs(pout.y - pin.y), dx = abs(pout.x - pin.x);\n            var pathData = [];\n            pathData.push("M", pout.x, pout.y);\n            pathData.push("h", dx - dy);\n            pathData.push("L", pin.x, pin.y);\n            connection.setMarker(null);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/connect/l.js\n/**\n * @fileOverview\n *\n * "L" 连线\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[4] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        connect.register("l", function(node, parent, connection) {\n            var po = parent.getLayoutVertexOut();\n            var pi = node.getLayoutVertexIn();\n            var vo = parent.getLayoutVectorOut();\n            var pathData = [];\n            var r = Math.round, abs = Math.abs;\n            pathData.push("M", po.round());\n            if (abs(vo.x) > abs(vo.y)) {\n                pathData.push("H", r(pi.x));\n            } else {\n                pathData.push("V", pi.y);\n            }\n            pathData.push("L", pi);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/connect/poly.js\n/**\n * @fileOverview\n *\n * 提供折线相连的方法\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[5] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        connect.register("poly", function(node, parent, connection, width) {\n            // 连线起点和终点\n            var po = parent.getLayoutVertexOut(), pi = node.getLayoutVertexIn();\n            // 连线矢量和方向\n            var v = parent.getLayoutVectorOut().normalize();\n            var r = Math.round;\n            var abs = Math.abs;\n            var pathData = [];\n            pathData.push("M", r(po.x), r(po.y));\n            switch (true) {\n              case abs(v.x) > abs(v.y) && v.x < 0:\n                // left\n                pathData.push("h", -parent.getStyle("margin-left"));\n                pathData.push("v", pi.y - po.y);\n                pathData.push("H", pi.x);\n                break;\n\n              case abs(v.x) > abs(v.y) && v.x >= 0:\n                // right\n                pathData.push("h", parent.getStyle("margin-right"));\n                pathData.push("v", pi.y - po.y);\n                pathData.push("H", pi.x);\n                break;\n\n              case abs(v.x) <= abs(v.y) && v.y < 0:\n                // top\n                pathData.push("v", -parent.getStyle("margin-top"));\n                pathData.push("h", pi.x - po.x);\n                pathData.push("V", pi.y);\n                break;\n\n              case abs(v.x) <= abs(v.y) && v.y >= 0:\n                // bottom\n                pathData.push("v", parent.getStyle("margin-bottom"));\n                pathData.push("h", pi.x - po.x);\n                pathData.push("V", pi.y);\n                break;\n            }\n            connection.setMarker(null);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/connect/under.js\n/**\n * @fileOverview\n *\n * 下划线连线\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[6] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var connect = _p.r(11);\n        connect.register("under", function(node, parent, connection, width, color) {\n            var box = node.getLayoutBox(), pBox = parent.getLayoutBox();\n            var start, end, vector;\n            var abs = Math.abs;\n            var pathData = [];\n            var side = box.x > pBox.x ? "right" : "left";\n            var radius = node.getStyle("connect-radius");\n            var underY = box.bottom + 3;\n            var startY = parent.getType() == "sub" ? pBox.bottom + 3 : pBox.cy;\n            var p1, p2, p3, mx;\n            if (side == "right") {\n                p1 = new kity.Point(pBox.right, startY);\n                p2 = new kity.Point(box.left - 10, underY);\n                p3 = new kity.Point(box.right, underY);\n            } else {\n                p1 = new kity.Point(pBox.left, startY);\n                p2 = new kity.Point(box.right + 10, underY);\n                p3 = new kity.Point(box.left, underY);\n            }\n            mx = (p1.x + p2.x) / 2;\n            pathData.push("M", p1);\n            pathData.push("C", mx, p1.y, mx, p2.y, p2);\n            pathData.push("L", p3);\n            connection.setMarker(null);\n            connection.setPathData(pathData);\n        });\n    }\n};\n\n//src/core/_boxv.js\n/**\n * @fileOverview\n *\n * 调试工具：为 kity.Box 提供一个可视化的渲染\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[7] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        if (location.href.indexOf("boxv") != -1) {\n            var vrect;\n            Object.defineProperty(kity.Box.prototype, "visualization", {\n                get: function() {\n                    if (!vrect) return null;\n                    return vrect.setBox(this);\n                }\n            });\n            Minder.registerInitHook(function() {\n                this.on("paperrender", function() {\n                    vrect = new kity.Rect();\n                    vrect.fill("rgba(200, 200, 200, .5)");\n                    vrect.stroke("orange");\n                    this.getRenderContainer().addShape(vrect);\n                });\n            });\n        }\n    }\n};\n\n//src/core/animate.js\n/**\n * @fileOverview\n *\n * 动画控制\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[8] = {\n    value: function(require, exports, module) {\n        var Minder = _p.r(19);\n        var animateDefaultOptions = {\n            enableAnimation: true,\n            layoutAnimationDuration: 300,\n            viewAnimationDuration: 100,\n            zoomAnimationDuration: 300\n        };\n        var resoredAnimationOptions = {};\n        Minder.registerInitHook(function() {\n            this.setDefaultOptions(animateDefaultOptions);\n            if (!this.getOption("enableAnimation")) {\n                this.disableAnimation();\n            }\n        });\n        Minder.prototype.enableAnimation = function() {\n            for (var name in animateDefaultOptions) {\n                if (animateDefaultOptions.hasOwnProperty(name)) {\n                    this.setOption(resoredAnimationOptions[name]);\n                }\n            }\n        };\n        Minder.prototype.disableAnimation = function() {\n            for (var name in animateDefaultOptions) {\n                if (animateDefaultOptions.hasOwnProperty(name)) {\n                    resoredAnimationOptions[name] = this.getOption(name);\n                    this.setOption(name, 0);\n                }\n            }\n        };\n    }\n};\n\n//src/core/command.js\n_p[9] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var MinderEvent = _p.r(13);\n        var COMMAND_STATE_NORMAL = 0;\n        var COMMAND_STATE_DISABLED = -1;\n        var COMMAND_STATE_ACTIVED = 1;\n        /**\n     * 表示一个命令，包含命令的查询及执行\n     */\n        var Command = kity.createClass("Command", {\n            constructor: function() {\n                this._isContentChange = true;\n                this._isSelectionChange = false;\n            },\n            execute: function(minder, args) {\n                throw new Error("Not Implement: Command.execute()");\n            },\n            setContentChanged: function(val) {\n                this._isContentChange = !!val;\n            },\n            isContentChanged: function() {\n                return this._isContentChange;\n            },\n            setSelectionChanged: function(val) {\n                this._isSelectionChange = !!val;\n            },\n            isSelectionChanged: function() {\n                return this._isContentChange;\n            },\n            queryState: function(km) {\n                return COMMAND_STATE_NORMAL;\n            },\n            queryValue: function(km) {\n                return 0;\n            },\n            isNeedUndo: function() {\n                return true;\n            }\n        });\n        Command.STATE_NORMAL = COMMAND_STATE_NORMAL;\n        Command.STATE_ACTIVE = COMMAND_STATE_ACTIVED;\n        Command.STATE_DISABLED = COMMAND_STATE_DISABLED;\n        kity.extendClass(Minder, {\n            _getCommand: function(name) {\n                return this._commands[name.toLowerCase()];\n            },\n            _queryCommand: function(name, type, args) {\n                var cmd = this._getCommand(name);\n                if (cmd) {\n                    var queryCmd = cmd["query" + type];\n                    if (queryCmd) return queryCmd.apply(cmd, [ this ].concat(args));\n                }\n                return 0;\n            },\n            /**\n         * @method queryCommandState()\n         * @for Minder\n         * @description 查询指定命令的状态\n         *\n         * @grammar queryCommandName(name) => {number}\n         *\n         * @param {string} name 要查询的命令名称\n         *\n         * @return {number}\n         *   -1: 命令不存在或命令当前不可用\n         *    0: 命令可用\n         *    1: 命令当前可用并且已经执行过\n         */\n            queryCommandState: function(name) {\n                return this._queryCommand(name, "State", [].slice.call(arguments, 1));\n            },\n            /**\n         * @method queryCommandValue()\n         * @for Minder\n         * @description 查询指定命令当前的执行值\n         *\n         * @grammar queryCommandValue(name) => {any}\n         *\n         * @param {string} name 要查询的命令名称\n         *\n         * @return {any}\n         *    如果命令不存在，返回 undefined\n         *    不同命令具有不同返回值，具体请查看 [Command](command) 章节\n         */\n            queryCommandValue: function(name) {\n                return this._queryCommand(name, "Value", [].slice.call(arguments, 1));\n            },\n            /**\n         * @method execCommand()\n         * @for Minder\n         * @description 执行指定的命令。\n         *\n         * @grammar execCommand(name, args...)\n         *\n         * @param {string} name 要执行的命令名称\n         * @param {argument} args 要传递给命令的其它参数\n         */\n            execCommand: function(name) {\n                if (!name) return null;\n                name = name.toLowerCase();\n                var cmdArgs = [].slice.call(arguments, 1), cmd, stoped, result, eventParams;\n                var me = this;\n                cmd = this._getCommand(name);\n                eventParams = {\n                    command: cmd,\n                    commandName: name.toLowerCase(),\n                    commandArgs: cmdArgs\n                };\n                if (!cmd || !~this.queryCommandState(name)) {\n                    return false;\n                }\n                if (!this._hasEnterExecCommand) {\n                    this._hasEnterExecCommand = true;\n                    stoped = this._fire(new MinderEvent("beforeExecCommand", eventParams, true));\n                    if (!stoped) {\n                        this._fire(new MinderEvent("preExecCommand", eventParams, false));\n                        result = cmd.execute.apply(cmd, [ me ].concat(cmdArgs));\n                        this._fire(new MinderEvent("execCommand", eventParams, false));\n                        if (cmd.isContentChanged()) {\n                            this._firePharse(new MinderEvent("contentchange"));\n                        }\n                        this._interactChange();\n                    }\n                    this._hasEnterExecCommand = false;\n                } else {\n                    result = cmd.execute.apply(cmd, [ me ].concat(cmdArgs));\n                    if (!this._hasEnterExecCommand) {\n                        this._interactChange();\n                    }\n                }\n                return result === undefined ? null : result;\n            }\n        });\n        module.exports = Command;\n    }\n};\n\n//src/core/compatibility.js\n_p[10] = {\n    value: function(require, exports, module) {\n        var utils = _p.r(33);\n        function compatibility(json) {\n            var version = json.version || (json.root ? "1.4.0" : "1.1.3");\n            switch (version) {\n              case "1.1.3":\n                c_113_120(json);\n\n              /* falls through */\n                case "1.2.0":\n              case "1.2.1":\n                c_120_130(json);\n\n              /* falls through */\n                case "1.3.0":\n              case "1.3.1":\n              case "1.3.2":\n              case "1.3.3":\n              case "1.3.4":\n              case "1.3.5":\n                /* falls through */\n                c_130_140(json);\n            }\n            return json;\n        }\n        function traverse(node, fn) {\n            fn(node);\n            if (node.children) node.children.forEach(function(child) {\n                traverse(child, fn);\n            });\n        }\n        /* 脑图数据升级 */\n        function c_120_130(json) {\n            traverse(json, function(node) {\n                var data = node.data;\n                delete data.layout_bottom_offset;\n                delete data.layout_default_offset;\n                delete data.layout_filetree_offset;\n            });\n        }\n        /**\n     * 脑图数据升级\n     * v1.1.3 => v1.2.0\n     * */\n        function c_113_120(json) {\n            // 原本的布局风格\n            var ocs = json.data.currentstyle;\n            delete json.data.currentstyle;\n            // 为 1.2 选择模板，同时保留老版本文件的皮肤\n            if (ocs == "bottom") {\n                json.template = "structure";\n                json.theme = "snow";\n            } else if (ocs == "default") {\n                json.template = "default";\n                json.theme = "classic";\n            }\n            traverse(json, function(node) {\n                var data = node.data;\n                // 升级优先级、进度图标\n                if ("PriorityIcon" in data) {\n                    data.priority = data.PriorityIcon;\n                    delete data.PriorityIcon;\n                }\n                if ("ProgressIcon" in data) {\n                    data.progress = 1 + (data.ProgressIcon - 1 << 1);\n                    delete data.ProgressIcon;\n                }\n                // 删除过时属性\n                delete data.point;\n                delete data.layout;\n            });\n        }\n        function c_130_140(json) {\n            json.root = {\n                data: json.data,\n                children: json.children\n            };\n            delete json.data;\n            delete json.children;\n        }\n        return compatibility;\n    }\n};\n\n//src/core/connect.js\n_p[11] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Module = _p.r(20);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        // 连线提供方\n        var _connectProviders = {};\n        function register(name, provider) {\n            _connectProviders[name] = provider;\n        }\n        register("default", function(node, parent, connection) {\n            connection.setPathData([ "M", parent.getLayoutVertexOut(), "L", node.getLayoutVertexIn() ]);\n        });\n        kity.extendClass(MinderNode, {\n            /**\n         * @private\n         * @method getConnect()\n         * @for MinderNode\n         * @description 获取当前节点的连线类型\n         *\n         * @grammar getConnect() => {string}\n         */\n            getConnect: function() {\n                return this.data.connect || "default";\n            },\n            getConnectProvider: function() {\n                return _connectProviders[this.getConnect()] || _connectProviders["default"];\n            },\n            /**\n         * @private\n         * @method getConnection()\n         * @for MinderNode\n         * @description 获取当前节点的连线对象\n         *\n         * @grammar getConnection() => {kity.Path}\n         */\n            getConnection: function() {\n                return this._connection || null;\n            }\n        });\n        kity.extendClass(Minder, {\n            getConnectContainer: function() {\n                return this._connectContainer;\n            },\n            createConnect: function(node) {\n                if (node.isRoot()) return;\n                var connection = new kity.Path();\n                node._connection = connection;\n                this._connectContainer.addShape(connection);\n                this.updateConnect(node);\n            },\n            removeConnect: function(node) {\n                var me = this;\n                node.traverse(function(node) {\n                    me._connectContainer.removeShape(node._connection);\n                    node._connection = null;\n                });\n            },\n            updateConnect: function(node) {\n                var connection = node._connection;\n                var parent = node.parent;\n                if (!parent || !connection) return;\n                if (parent.isCollapsed()) {\n                    connection.setVisible(false);\n                    return;\n                }\n                connection.setVisible(true);\n                var provider = node.getConnectProvider();\n                var strokeColor = node.getStyle("connect-color") || "white", strokeWidth = node.getStyle("connect-width") || 2;\n                connection.stroke(strokeColor, strokeWidth);\n                provider(node, parent, connection, strokeWidth, strokeColor);\n                if (strokeWidth % 2 === 0) {\n                    connection.setTranslate(.5, .5);\n                } else {\n                    connection.setTranslate(0, 0);\n                }\n            }\n        });\n        Module.register("Connect", {\n            init: function() {\n                this._connectContainer = new kity.Group().setId(utils.uuid("minder_connect_group"));\n                this.getRenderContainer().prependShape(this._connectContainer);\n            },\n            events: {\n                nodeattach: function(e) {\n                    this.createConnect(e.node);\n                },\n                nodedetach: function(e) {\n                    this.removeConnect(e.node);\n                },\n                "layoutapply layoutfinish noderender": function(e) {\n                    this.updateConnect(e.node);\n                }\n            }\n        });\n        exports.register = register;\n    }\n};\n\n//src/core/data.js\n_p[12] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var MinderEvent = _p.r(13);\n        var compatibility = _p.r(10);\n        var Promise = _p.r(25);\n        var protocols = {};\n        function registerProtocol(name, protocol) {\n            protocols[name] = protocol;\n            for (var pname in protocols) {\n                if (protocols.hasOwnProperty(pname)) {\n                    protocols[pname] = protocols[pname];\n                    protocols[pname].name = pname;\n                }\n            }\n        }\n        function getRegisterProtocol(name) {\n            return name === undefined ? protocols : protocols[name] || null;\n        }\n        exports.registerProtocol = registerProtocol;\n        exports.getRegisterProtocol = getRegisterProtocol;\n        // 导入导出\n        kity.extendClass(Minder, {\n            // 自动导入\n            setup: function(target) {\n                if (typeof target == "string") {\n                    target = document.querySelector(target);\n                }\n                if (!target) return;\n                var protocol = target.getAttribute("minder-data-type");\n                if (protocol in protocols) {\n                    var data = target.textContent;\n                    target.textContent = null;\n                    this.renderTo(target);\n                    this.importData(protocol, data);\n                }\n                return this;\n            },\n            /**\n         * @method exportJson()\n         * @for Minder\n         * @description\n         *     导出当前脑图数据为 JSON 对象，导出的数据格式请参考 [Data](data) 章节。\n         * @grammar exportJson() => {plain}\n         */\n            exportJson: function() {\n                /* 导出 node 上整棵树的数据为 JSON */\n                function exportNode(node) {\n                    var exported = {};\n                    exported.data = node.getData();\n                    var childNodes = node.getChildren();\n                    exported.children = [];\n                    for (var i = 0; i < childNodes.length; i++) {\n                        exported.children.push(exportNode(childNodes[i]));\n                    }\n                    return exported;\n                }\n                var json = {\n                    root: exportNode(this.getRoot())\n                };\n                json.template = this.getTemplate();\n                json.theme = this.getTheme();\n                json.version = Minder.version;\n                return JSON.parse(JSON.stringify(json));\n            },\n            /**\n         * function Text2Children(MinderNode, String)\n         * @param {MinderNode} node 要导入数据的节点\n         * @param {String} text 导入的text数据\n         * @Desc: 用于批量插入子节点，并不会修改被插入的父节点\n         * @Editor: Naixor\n         * @Date: 2015.9.21\n         * @example: 用于批量导入如下类型的节点\n         *      234\n         *      3456346 asadf\n         *          12312414\n         *              wereww\n         *          12314\n         *      1231412\n         *      13123\n         */\n            Text2Children: function(node, text) {\n                if (!(node instanceof kityminder.Node)) {\n                    return;\n                }\n                var children = [], jsonMap = {}, level = 0;\n                var LINE_SPLITTER = /\\r|\\n|\\r\\n/, TAB_REGEXP = /^(\\t|\\x20{4})/;\n                var lines = text.split(LINE_SPLITTER), line = "", jsonNode, i = 0;\n                var minder = this;\n                function isEmpty(line) {\n                    return line === "" && !/\\S/.test(line);\n                }\n                function getNode(line) {\n                    return {\n                        data: {\n                            text: line.replace(/^(\\t|\\x20{4})+/, "").replace(/(\\t|\\x20{4})+$/, "")\n                        },\n                        children: []\n                    };\n                }\n                function getLevel(text) {\n                    var level = 0;\n                    while (TAB_REGEXP.test(text)) {\n                        text = text.replace(TAB_REGEXP, "");\n                        level++;\n                    }\n                    return level;\n                }\n                function addChild(parent, node) {\n                    parent.children.push(node);\n                }\n                function importChildren(node, children) {\n                    for (var i = 0, l = children.length; i < l; i++) {\n                        var childNode = minder.createNode(null, node);\n                        childNode.setData("text", children[i].data.text || "");\n                        importChildren(childNode, children[i].children);\n                    }\n                }\n                while ((line = lines[i++]) !== undefined) {\n                    line = line.replace(/&nbsp;/g, "");\n                    if (isEmpty(line)) continue;\n                    level = getLevel(line);\n                    jsonNode = getNode(line);\n                    if (level === 0) {\n                        jsonMap = {};\n                        children.push(jsonNode);\n                        jsonMap[0] = children[children.length - 1];\n                    } else {\n                        if (!jsonMap[level - 1]) {\n                            throw new Error("Invalid local format");\n                        }\n                        addChild(jsonMap[level - 1], jsonNode);\n                        jsonMap[level] = jsonNode;\n                    }\n                }\n                importChildren(node, children);\n                minder.refresh();\n            },\n            /**\n         * @method exportNode(MinderNode)\n         * @param  {MinderNode} node 当前要被导出的节点\n         * @return {Object}      返回只含有data和children的Object\n         * @Editor: Naixor\n         * @Date: 2015.9.22\n         */\n            exportNode: function(node) {\n                var exported = {};\n                exported.data = node.getData();\n                var childNodes = node.getChildren();\n                exported.children = [];\n                for (var i = 0; i < childNodes.length; i++) {\n                    exported.children.push(this.exportNode(childNodes[i]));\n                }\n                return exported;\n            },\n            /**\n         * @method importNode()\n         * @description 根据纯json {data, children}数据转换成为脑图节点\n         * @Editor: Naixor\n         * @Date: 2015.9.20\n         */\n            importNode: function(node, json) {\n                var data = json.data;\n                node.data = {};\n                for (var field in data) {\n                    node.setData(field, data[field]);\n                }\n                var childrenTreeData = json.children || [];\n                for (var i = 0; i < childrenTreeData.length; i++) {\n                    var childNode = this.createNode(null, node);\n                    this.importNode(childNode, childrenTreeData[i]);\n                }\n                return node;\n            },\n            /**\n         * @method importJson()\n         * @for Minder\n         * @description 导入脑图数据，数据为 JSON 对象，具体的数据字段形式请参考 [Data](data) 章节。\n         *\n         * @grammar importJson(json) => {this}\n         *\n         * @param {plain} json 要导入的数据\n         */\n            importJson: function(json) {\n                if (!json) return;\n                /**\n             * @event preimport\n             * @for Minder\n             * @when 导入数据之前\n             */\n                this._fire(new MinderEvent("preimport", null, false));\n                // 删除当前所有节点\n                while (this._root.getChildren().length) {\n                    this.removeNode(this._root.getChildren()[0]);\n                }\n                json = compatibility(json);\n                this.importNode(this._root, json.root);\n                this.setTemplate(json.template || "default");\n                this.setTheme(json.theme || null);\n                this.refresh();\n                /**\n             * @event import,contentchange,interactchange\n             * @for Minder\n             * @when 导入数据之后\n             */\n                this.fire("import");\n                this._firePharse({\n                    type: "contentchange"\n                });\n                this._interactChange();\n                return this;\n            },\n            /**\n         * @method exportData()\n         * @for Minder\n         * @description 使用指定使用的数据协议，导入脑图数据\n         *\n         * @grammar exportData(protocol) => Promise<data>\n         *\n         * @param {string} protocol 指定的数据协议（默认内置五种数据协议 `json`、`text`、`markdown`、`svg` 和 `png`）\n         */\n            exportData: function(protocolName, option) {\n                var json, protocol;\n                json = this.exportJson();\n                // 指定了协议进行导出，需要检测协议是否支持\n                if (protocolName) {\n                    protocol = protocols[protocolName];\n                    if (!protocol || !protocol.encode) {\n                        return Promise.reject(new Error("Not supported protocol:" + protocolName));\n                    }\n                }\n                // 导出前抛个事件\n                this._fire(new MinderEvent("beforeexport", {\n                    json: json,\n                    protocolName: protocolName,\n                    protocol: protocol\n                }));\n                return Promise.resolve(protocol.encode(json, this, option));\n            },\n            /**\n         * @method importData()\n         * @for Minder\n         * @description 使用指定的数据协议，导入脑图数据，覆盖当前实例的脑图\n         *\n         * @grammar importData(protocol, callback) => Promise<json>\n         *\n         * @param {string} protocol 指定的用于解析数据的数据协议（默认内置三种数据协议 `json`、`text` 和 `markdown` 的支持）\n         * @param {any} data 要导入的数据\n         */\n            importData: function(protocolName, data, option) {\n                var json, protocol;\n                var minder = this;\n                // 指定了协议进行导入，需要检测协议是否支持\n                if (protocolName) {\n                    protocol = protocols[protocolName];\n                    if (!protocol || !protocol.decode) {\n                        return Promise.reject(new Error("Not supported protocol:" + protocolName));\n                    }\n                }\n                var params = {\n                    local: data,\n                    protocolName: protocolName,\n                    protocol: protocol\n                };\n                // 导入前抛事件\n                this._fire(new MinderEvent("beforeimport", params));\n                return Promise.resolve(protocol.decode(data, this, option)).then(function(json) {\n                    minder.importJson(json);\n                    return json;\n                });\n            },\n            /**\n         * @method decodeData()\n         * @for Minder\n         * @description 使用指定的数据协议，解析为脑图数据，与 importData 的区别在于：不覆盖当前实例的脑图\n         *\n         * @grammar decodeData(protocol, callback) => Promise<json>\n         *\n         * @param {string} protocol 指定的用于解析数据的数据协议（默认内置三种数据协议 `json`、`text` 和 `markdown` 的支持）\n         * @param {any} data 要导入的数据\n         */\n            decodeData: function(protocolName, data, option) {\n                var json, protocol;\n                var minder = this;\n                // 指定了协议进行导入，需要检测协议是否支持\n                if (protocolName) {\n                    protocol = protocols[protocolName];\n                    if (!protocol || !protocol.decode) {\n                        return Promise.reject(new Error("Not supported protocol:" + protocolName));\n                    }\n                }\n                var params = {\n                    local: data,\n                    protocolName: protocolName,\n                    protocol: protocol\n                };\n                // 导入前抛事件\n                this._fire(new MinderEvent("beforeimport", params));\n                return Promise.resolve(protocol.decode(data, this, option));\n            }\n        });\n    }\n};\n\n//src/core/event.js\n_p[13] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        /**\n     * @class MinderEvent\n     * @description 表示一个脑图中发生的事件\n     */\n        var MinderEvent = kity.createClass("MindEvent", {\n            constructor: function(type, params, canstop) {\n                params = params || {};\n                if (params.getType && params.getType() == "ShapeEvent") {\n                    /**\n                 * @property kityEvent\n                 * @for MinderEvent\n                 * @description 如果事件是从一个 kity 的事件派生的，会有 kityEvent 属性指向原来的 kity 事件\n                 * @type {KityEvent}\n                 */\n                    this.kityEvent = params;\n                    /**\n                 * @property originEvent\n                 * @for MinderEvent\n                 * @description 如果事件是从原声 Dom 事件派生的（如 click、mousemove 等），会有 originEvent 指向原来的 Dom 事件\n                 * @type {DomEvent}\n                 */\n                    this.originEvent = params.originEvent;\n                } else if (params.target && params.preventDefault) {\n                    this.originEvent = params;\n                } else {\n                    kity.Utils.extend(this, params);\n                }\n                /**\n             * @property type\n             * @for MinderEvent\n             * @description 事件的类型，如 `click`、`contentchange` 等\n             * @type {string}\n             */\n                this.type = type;\n                this._canstop = canstop || false;\n            },\n            /**\n         * @method getPosition()\n         * @for MinderEvent\n         * @description 如果事件是从一个 kity 事件派生的，会有 `getPosition()` 获取事件发生的坐标\n         *\n         * @grammar getPosition(refer) => {kity.Point}\n         *\n         * @param {string|kity.Shape} refer\n         *     参照的坐标系，\n         *     `"screen"` - 以浏览器屏幕为参照坐标系\n         *     `"minder"` - （默认）以脑图画布为参照坐标系\n         *     `{kity.Shape}` - 指定以某个 kity 图形为参照坐标系\n         */\n            getPosition: function(refer) {\n                if (!this.kityEvent) return;\n                if (!refer || refer == "minder") {\n                    return this.kityEvent.getPosition(this.minder.getRenderContainer());\n                }\n                return this.kityEvent.getPosition.call(this.kityEvent, refer);\n            },\n            /**\n         * @method getTargetNode()\n         * @for MinderEvent\n         * @description 当发生的事件是鼠标事件时，获取事件位置命中的脑图节点\n         *\n         * @grammar getTargetNode() => {MinderNode}\n         */\n            getTargetNode: function() {\n                var findShape = this.kityEvent && this.kityEvent.targetShape;\n                if (!findShape) return null;\n                while (!findShape.minderNode && findShape.container) {\n                    findShape = findShape.container;\n                }\n                var node = findShape.minderNode;\n                if (node && findShape.getOpacity() < 1) return null;\n                return node || null;\n            },\n            /**\n         * @method stopPropagation()\n         * @for MinderEvent\n         * @description 当发生的事件是鼠标事件时，获取事件位置命中的脑图节点\n         *\n         * @grammar getTargetNode() => {MinderNode}\n         */\n            stopPropagation: function() {\n                this._stoped = true;\n            },\n            stopPropagationImmediately: function() {\n                this._immediatelyStoped = true;\n                this._stoped = true;\n            },\n            shouldStopPropagation: function() {\n                return this._canstop && this._stoped;\n            },\n            shouldStopPropagationImmediately: function() {\n                return this._canstop && this._immediatelyStoped;\n            },\n            preventDefault: function() {\n                this.originEvent.preventDefault();\n            },\n            isRightMB: function() {\n                var isRightMB = false;\n                if (!this.originEvent) {\n                    return false;\n                }\n                if ("which" in this.originEvent) isRightMB = this.originEvent.which == 3; else if ("button" in this.originEvent) isRightMB = this.originEvent.button == 2;\n                return isRightMB;\n            },\n            getKeyCode: function() {\n                var evt = this.originEvent;\n                return evt.keyCode || evt.which;\n            }\n        });\n        Minder.registerInitHook(function(option) {\n            this._initEvents();\n        });\n        kity.extendClass(Minder, {\n            _initEvents: function() {\n                this._eventCallbacks = {};\n            },\n            _resetEvents: function() {\n                this._initEvents();\n                this._bindEvents();\n            },\n            _bindEvents: function() {\n                /* jscs:disable maximumLineLength */\n                this._paper.on("click dblclick mousedown contextmenu mouseup mousemove mouseover mousewheel DOMMouseScroll touchstart touchmove touchend dragenter dragleave drop", this._firePharse.bind(this));\n                if (window) {\n                    window.addEventListener("resize", this._firePharse.bind(this));\n                }\n            },\n            /**\n         * @method dispatchKeyEvent\n         * @description 派发键盘（相关）事件到脑图实例上，让实例的模块处理\n         * @grammar dispatchKeyEvent(e) => {this}\n         * @param  {Event} e 原生的 Dom 事件对象\n         */\n            dispatchKeyEvent: function(e) {\n                this._firePharse(e);\n            },\n            _firePharse: function(e) {\n                var beforeEvent, preEvent, executeEvent;\n                if (e.type == "DOMMouseScroll") {\n                    e.type = "mousewheel";\n                    e.wheelDelta = e.originEvent.wheelDelta = e.originEvent.detail * -10;\n                    e.wheelDeltaX = e.originEvent.mozMovementX;\n                    e.wheelDeltaY = e.originEvent.mozMovementY;\n                }\n                beforeEvent = new MinderEvent("before" + e.type, e, true);\n                if (this._fire(beforeEvent)) {\n                    return;\n                }\n                preEvent = new MinderEvent("pre" + e.type, e, true);\n                executeEvent = new MinderEvent(e.type, e, true);\n                if (this._fire(preEvent) || this._fire(executeEvent)) this._fire(new MinderEvent("after" + e.type, e, false));\n            },\n            _interactChange: function(e) {\n                var me = this;\n                if (me._interactScheduled) return;\n                setTimeout(function() {\n                    me._fire(new MinderEvent("interactchange"));\n                    me._interactScheduled = false;\n                }, 100);\n                me._interactScheduled = true;\n            },\n            _listen: function(type, callback) {\n                var callbacks = this._eventCallbacks[type] || (this._eventCallbacks[type] = []);\n                callbacks.push(callback);\n            },\n            _fire: function(e) {\n                /**\n             * @property minder\n             * @description 产生事件的 Minder 对象\n             * @for MinderShape\n             * @type {Minder}\n             */\n                e.minder = this;\n                var status = this.getStatus();\n                var callbacks = this._eventCallbacks[e.type.toLowerCase()] || [];\n                if (status) {\n                    callbacks = callbacks.concat(this._eventCallbacks[status + "." + e.type.toLowerCase()] || []);\n                }\n                if (callbacks.length === 0) {\n                    return;\n                }\n                var lastStatus = this.getStatus();\n                for (var i = 0; i < callbacks.length; i++) {\n                    callbacks[i].call(this, e);\n                    /* this.getStatus() != lastStatus ||*/\n                    if (e.shouldStopPropagationImmediately()) {\n                        break;\n                    }\n                }\n                return e.shouldStopPropagation();\n            },\n            on: function(name, callback) {\n                var km = this;\n                name.split(/\\s+/).forEach(function(n) {\n                    km._listen(n.toLowerCase(), callback);\n                });\n                return this;\n            },\n            off: function(name, callback) {\n                var types = name.split(/\\s+/);\n                var i, j, callbacks, removeIndex;\n                for (i = 0; i < types.length; i++) {\n                    callbacks = this._eventCallbacks[types[i].toLowerCase()];\n                    if (callbacks) {\n                        removeIndex = null;\n                        for (j = 0; j < callbacks.length; j++) {\n                            if (callbacks[j] == callback) {\n                                removeIndex = j;\n                            }\n                        }\n                        if (removeIndex !== null) {\n                            callbacks.splice(removeIndex, 1);\n                        }\n                    }\n                }\n            },\n            fire: function(type, params) {\n                var e = new MinderEvent(type, params);\n                this._fire(e);\n                return this;\n            }\n        });\n        module.exports = MinderEvent;\n    }\n};\n\n//src/core/focus.js\n_p[14] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        Minder.registerInitHook(function() {\n            this.on("beforemousedown", function(e) {\n                this.focus();\n                e.preventDefault();\n            });\n            this.on("paperrender", function() {\n                this.focus();\n            });\n        });\n        kity.extendClass(Minder, {\n            focus: function() {\n                if (!this.isFocused()) {\n                    var renderTarget = this._renderTarget;\n                    renderTarget.classList.add("focus");\n                    this.renderNodeBatch(this.getSelectedNodes());\n                }\n                this.fire("focus");\n                return this;\n            },\n            blur: function() {\n                if (this.isFocused()) {\n                    var renderTarget = this._renderTarget;\n                    renderTarget.classList.remove("focus");\n                    this.renderNodeBatch(this.getSelectedNodes());\n                }\n                this.fire("blur");\n                return this;\n            },\n            isFocused: function() {\n                var renderTarget = this._renderTarget;\n                return renderTarget && renderTarget.classList.contains("focus");\n            }\n        });\n    }\n};\n\n//src/core/keymap.js\n_p[15] = {\n    value: function(require, exports, module) {\n        var keymap = {\n            Backspace: 8,\n            Tab: 9,\n            Enter: 13,\n            Shift: 16,\n            Control: 17,\n            Alt: 18,\n            CapsLock: 20,\n            Esc: 27,\n            Spacebar: 32,\n            PageUp: 33,\n            PageDown: 34,\n            End: 35,\n            Home: 36,\n            Insert: 45,\n            Left: 37,\n            Up: 38,\n            Right: 39,\n            Down: 40,\n            direction: {\n                37: 1,\n                38: 1,\n                39: 1,\n                40: 1\n            },\n            Del: 46,\n            NumLock: 144,\n            Cmd: 91,\n            CmdFF: 224,\n            F1: 112,\n            F2: 113,\n            F3: 114,\n            F4: 115,\n            F5: 116,\n            F6: 117,\n            F7: 118,\n            F8: 119,\n            F9: 120,\n            F10: 121,\n            F11: 122,\n            F12: 123,\n            "`": 192,\n            "=": 187,\n            "-": 189,\n            "/": 191,\n            ".": 190,\n            controlKeys: {\n                16: 1,\n                17: 1,\n                18: 1,\n                20: 1,\n                91: 1,\n                224: 1\n            },\n            notContentChange: {\n                13: 1,\n                9: 1,\n                33: 1,\n                34: 1,\n                35: 1,\n                36: 1,\n                16: 1,\n                17: 1,\n                18: 1,\n                20: 1,\n                91: 1,\n                //上下左右\n                37: 1,\n                38: 1,\n                39: 1,\n                40: 1,\n                113: 1,\n                114: 1,\n                115: 1,\n                144: 1,\n                27: 1\n            },\n            isSelectedNodeKey: {\n                //上下左右\n                37: 1,\n                38: 1,\n                39: 1,\n                40: 1,\n                13: 1,\n                9: 1\n            }\n        };\n        // 小写适配\n        for (var key in keymap) {\n            if (keymap.hasOwnProperty(key)) {\n                keymap[key.toLowerCase()] = keymap[key];\n            }\n        }\n        var aKeyCode = 65;\n        var aCharCode = "a".charCodeAt(0);\n        // letters\n        "abcdefghijklmnopqrstuvwxyz".split("").forEach(function(letter) {\n            keymap[letter] = aKeyCode + (letter.charCodeAt(0) - aCharCode);\n        });\n        // numbers\n        var n = 9;\n        do {\n            keymap[n.toString()] = n + 48;\n        } while (--n);\n        module.exports = keymap;\n    }\n};\n\n//src/core/keyreceiver.js\n_p[16] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        function listen(element, type, handler) {\n            type.split(" ").forEach(function(name) {\n                element.addEventListener(name, handler, false);\n            });\n        }\n        Minder.registerInitHook(function(option) {\n            this.setDefaultOptions({\n                enableKeyReceiver: true\n            });\n            if (this.getOption("enableKeyReceiver")) {\n                this.on("paperrender", function() {\n                    this._initKeyReceiver();\n                });\n            }\n        });\n        kity.extendClass(Minder, {\n            _initKeyReceiver: function() {\n                if (this._keyReceiver) return;\n                var receiver = this._keyReceiver = document.createElement("input");\n                receiver.classList.add("km-receiver");\n                var renderTarget = this._renderTarget;\n                renderTarget.appendChild(receiver);\n                var minder = this;\n                listen(receiver, "keydown keyup keypress copy paste blur focus input", function(e) {\n                    switch (e.type) {\n                      case "blur":\n                        minder.blur();\n                        break;\n\n                      case "focus":\n                        minder.focus();\n                        break;\n\n                      case "input":\n                        receiver.value = null;\n                        break;\n                    }\n                    minder._firePharse(e);\n                    e.preventDefault();\n                });\n                this.on("focus", function() {\n                    receiver.select();\n                    receiver.focus();\n                });\n                this.on("blur", function() {\n                    receiver.blur();\n                });\n                if (this.isFocused()) {\n                    receiver.select();\n                    receiver.focus();\n                }\n            }\n        });\n    }\n};\n\n//src/core/kity.js\n/**\n * @fileOverview\n *\n * Kity 引入\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[17] = {\n    value: function(require, exports, module) {\n        module.exports = window.kity;\n    }\n};\n\n//src/core/layout.js\n_p[18] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var MinderEvent = _p.r(13);\n        var Command = _p.r(9);\n        var _layouts = {};\n        var _defaultLayout;\n        function register(name, layout) {\n            _layouts[name] = layout;\n            _defaultLayout = _defaultLayout || name;\n        }\n        /**\n     * @class Layout 布局基类，具体布局需要从该类派生\n     */\n        var Layout = kity.createClass("Layout", {\n            /**\n         * @abstract\n         *\n         * 子类需要实现的布局算法，该算法输入一个节点，排布该节点的子节点（相对父节点的变换）\n         *\n         * @param  {MinderNode} node 需要布局的节点\n         *\n         * @example\n         *\n         * doLayout: function(node) {\n         *     var children = node.getChildren();\n         *     // layout calculation\n         *     children[i].setLayoutTransform(new kity.Matrix().translate(x, y));\n         * }\n         */\n            doLayout: function(parent, children) {\n                throw new Error("Not Implement: Layout.doLayout()");\n            },\n            /**\n         * 对齐指定的节点\n         *\n         * @param {Array<MinderNode>} nodes 要对齐的节点\n         * @param {string} border 对齐边界，允许取值 left, right, top, bottom\n         *\n         */\n            align: function(nodes, border, offset) {\n                var me = this;\n                offset = offset || 0;\n                nodes.forEach(function(node) {\n                    var tbox = me.getTreeBox([ node ]);\n                    var matrix = node.getLayoutTransform();\n                    switch (border) {\n                      case "left":\n                        return matrix.translate(offset - tbox.left, 0);\n\n                      case "right":\n                        return matrix.translate(offset - tbox.right, 0);\n\n                      case "top":\n                        return matrix.translate(0, offset - tbox.top);\n\n                      case "bottom":\n                        return matrix.translate(0, offset - tbox.bottom);\n                    }\n                });\n            },\n            stack: function(nodes, axis, distance) {\n                var me = this;\n                var position = 0;\n                distance = distance || function(node, next, axis) {\n                    return node.getStyle({\n                        x: "margin-right",\n                        y: "margin-bottom"\n                    }[axis]) + next.getStyle({\n                        x: "margin-left",\n                        y: "margin-top"\n                    }[axis]);\n                };\n                nodes.forEach(function(node, index, nodes) {\n                    var tbox = me.getTreeBox([ node ]);\n                    var size = {\n                        x: tbox.width,\n                        y: tbox.height\n                    }[axis];\n                    var offset = {\n                        x: tbox.left,\n                        y: tbox.top\n                    }[axis];\n                    var matrix = node.getLayoutTransform();\n                    if (axis == "x") {\n                        matrix.translate(position - offset, 0);\n                    } else {\n                        matrix.translate(0, position - offset);\n                    }\n                    position += size;\n                    if (nodes[index + 1]) position += distance(node, nodes[index + 1], axis);\n                });\n                return position;\n            },\n            move: function(nodes, dx, dy) {\n                nodes.forEach(function(node) {\n                    node.getLayoutTransform().translate(dx, dy);\n                });\n            },\n            /**\n         * 工具方法：获取给点的节点所占的布局区域\n         *\n         * @param  {MinderNode[]} nodes 需要计算的节点\n         *\n         * @return {Box} 计算结果\n         */\n            getBranchBox: function(nodes) {\n                var box = new kity.Box();\n                var i, node, matrix, contentBox;\n                for (i = 0; i < nodes.length; i++) {\n                    node = nodes[i];\n                    matrix = node.getLayoutTransform();\n                    contentBox = node.getContentBox();\n                    box = box.merge(matrix.transformBox(contentBox));\n                }\n                return box;\n            },\n            /**\n         * 工具方法：计算给定的节点的子树所占的布局区域\n         *\n         * @param  {MinderNode} nodes 需要计算的节点\n         *\n         * @return {Box} 计算的结果\n         */\n            getTreeBox: function(nodes) {\n                var i, node, matrix, treeBox;\n                var box = new kity.Box();\n                if (!(nodes instanceof Array)) nodes = [ nodes ];\n                for (i = 0; i < nodes.length; i++) {\n                    node = nodes[i];\n                    matrix = node.getLayoutTransform();\n                    treeBox = node.getContentBox();\n                    if (node.isExpanded() && node.children.length) {\n                        treeBox = treeBox.merge(this.getTreeBox(node.children));\n                    }\n                    box = box.merge(matrix.transformBox(treeBox));\n                }\n                return box;\n            },\n            getOrderHint: function(node) {\n                return [];\n            }\n        });\n        Layout.register = register;\n        Minder.registerInitHook(function(options) {\n            this.refresh();\n        });\n        /**\n     * 布局支持池子管理\n     */\n        utils.extend(Minder, {\n            getLayoutList: function() {\n                return _layouts;\n            },\n            getLayoutInstance: function(name) {\n                var LayoutClass = _layouts[name];\n                if (!LayoutClass) throw new Error("Missing Layout: " + name);\n                var layout = new LayoutClass();\n                return layout;\n            }\n        });\n        /**\n     * MinderNode 上的布局支持\n     */\n        kity.extendClass(MinderNode, {\n            /**\n         * 获得当前节点的布局名称\n         *\n         * @return {String}\n         */\n            getLayout: function() {\n                var layout = this.getData("layout");\n                layout = layout || (this.isRoot() ? _defaultLayout : this.parent.getLayout());\n                return layout;\n            },\n            setLayout: function(name) {\n                if (name) {\n                    if (name == "inherit") {\n                        this.setData("layout");\n                    } else {\n                        this.setData("layout", name);\n                    }\n                }\n                return this;\n            },\n            layout: function(name) {\n                this.setLayout(name).getMinder().layout();\n                return this;\n            },\n            getLayoutInstance: function() {\n                return Minder.getLayoutInstance(this.getLayout());\n            },\n            getOrderHint: function(refer) {\n                return this.parent.getLayoutInstance().getOrderHint(this);\n            },\n            /**\n         * 获取当前节点相对于父节点的布局变换\n         */\n            getLayoutTransform: function() {\n                return this._layoutTransform || new kity.Matrix();\n            },\n            /**\n         * 第一轮布局计算后，获得的全局布局位置\n         *\n         * @return {[type]} [description]\n         */\n            getGlobalLayoutTransformPreview: function() {\n                var pMatrix = this.parent ? this.parent.getLayoutTransform() : new kity.Matrix();\n                var matrix = this.getLayoutTransform();\n                var offset = this.getLayoutOffset();\n                if (offset) {\n                    matrix = matrix.clone().translate(offset.x, offset.y);\n                }\n                return pMatrix.merge(matrix);\n            },\n            getLayoutPointPreview: function() {\n                return this.getGlobalLayoutTransformPreview().transformPoint(new kity.Point());\n            },\n            /**\n         * 获取节点相对于全局的布局变换\n         */\n            getGlobalLayoutTransform: function() {\n                if (this._globalLayoutTransform) {\n                    return this._globalLayoutTransform;\n                } else if (this.parent) {\n                    return this.parent.getGlobalLayoutTransform();\n                } else {\n                    return new kity.Matrix();\n                }\n            },\n            /**\n         * 设置当前节点相对于父节点的布局变换\n         */\n            setLayoutTransform: function(matrix) {\n                this._layoutTransform = matrix;\n                return this;\n            },\n            /**\n         * 设置当前节点相对于全局的布局变换（冗余优化）\n         */\n            setGlobalLayoutTransform: function(matrix) {\n                this.getRenderContainer().setMatrix(this._globalLayoutTransform = matrix);\n                return this;\n            },\n            setVertexIn: function(p) {\n                this._vertexIn = p;\n            },\n            setVertexOut: function(p) {\n                this._vertexOut = p;\n            },\n            getVertexIn: function() {\n                return this._vertexIn || new kity.Point();\n            },\n            getVertexOut: function() {\n                return this._vertexOut || new kity.Point();\n            },\n            getLayoutVertexIn: function() {\n                return this.getGlobalLayoutTransform().transformPoint(this.getVertexIn());\n            },\n            getLayoutVertexOut: function() {\n                return this.getGlobalLayoutTransform().transformPoint(this.getVertexOut());\n            },\n            setLayoutVectorIn: function(v) {\n                this._layoutVectorIn = v;\n                return this;\n            },\n            setLayoutVectorOut: function(v) {\n                this._layoutVectorOut = v;\n                return this;\n            },\n            getLayoutVectorIn: function() {\n                return this._layoutVectorIn || new kity.Vector();\n            },\n            getLayoutVectorOut: function() {\n                return this._layoutVectorOut || new kity.Vector();\n            },\n            getLayoutBox: function() {\n                var matrix = this.getGlobalLayoutTransform();\n                return matrix.transformBox(this.getContentBox());\n            },\n            getLayoutPoint: function() {\n                var matrix = this.getGlobalLayoutTransform();\n                return matrix.transformPoint(new kity.Point());\n            },\n            getLayoutOffset: function() {\n                if (!this.parent) return new kity.Point();\n                // 影响当前节点位置的是父节点的布局\n                var data = this.getData("layout_" + this.parent.getLayout() + "_offset");\n                if (data) return new kity.Point(data.x, data.y);\n                return new kity.Point();\n            },\n            setLayoutOffset: function(p) {\n                if (!this.parent) return this;\n                this.setData("layout_" + this.parent.getLayout() + "_offset", p ? {\n                    x: p.x,\n                    y: p.y\n                } : undefined);\n                return this;\n            },\n            hasLayoutOffset: function() {\n                return !!this.getData("layout_" + this.parent.getLayout() + "_offset");\n            },\n            resetLayoutOffset: function() {\n                return this.setLayoutOffset(null);\n            },\n            getLayoutRoot: function() {\n                if (this.isLayoutRoot()) {\n                    return this;\n                }\n                return this.parent.getLayoutRoot();\n            },\n            isLayoutRoot: function() {\n                return this.getData("layout") || this.isRoot();\n            }\n        });\n        /**\n     * Minder 上的布局支持\n     */\n        kity.extendClass(Minder, {\n            layout: function() {\n                var duration = this.getOption("layoutAnimationDuration");\n                this.getRoot().traverse(function(node) {\n                    // clear last results\n                    node.setLayoutTransform(null);\n                });\n                function layoutNode(node, round) {\n                    // layout all children first\n                    // 剪枝：收起的节点无需计算\n                    if (node.isExpanded() || true) {\n                        node.children.forEach(function(child) {\n                            layoutNode(child, round);\n                        });\n                    }\n                    var layout = node.getLayoutInstance();\n                    // var childrenInFlow = node.getChildren().filter(function(child) {\n                    //     return !child.hasLayoutOffset();\n                    // });\n                    layout.doLayout(node, node.getChildren(), round);\n                }\n                // 第一轮布局\n                layoutNode(this.getRoot(), 1);\n                // 第二轮布局\n                layoutNode(this.getRoot(), 2);\n                var minder = this;\n                this.applyLayoutResult(this.getRoot(), duration, function() {\n                    /**\n                 * 当节点>200, 不使用动画时, 此处逻辑变为同步逻辑, 外部minder.on事件无法\n                 * 被提前录入, 因此增加setTimeout\n                 * @author Naixor\n                 */\n                    setTimeout(function() {\n                        minder.fire("layoutallfinish");\n                    }, 0);\n                });\n                return this.fire("layout");\n            },\n            refresh: function() {\n                this.getRoot().renderTree();\n                this.layout().fire("contentchange")._interactChange();\n                return this;\n            },\n            applyLayoutResult: function(root, duration, callback) {\n                root = root || this.getRoot();\n                var me = this;\n                var complex = root.getComplex();\n                function consume() {\n                    if (!--complex) {\n                        if (callback) {\n                            callback();\n                        }\n                    }\n                }\n                // 节点复杂度大于 100，关闭动画\n                if (complex > 200) duration = 0;\n                function applyMatrix(node, matrix) {\n                    node.setGlobalLayoutTransform(matrix);\n                    me.fire("layoutapply", {\n                        node: node,\n                        matrix: matrix\n                    });\n                }\n                function apply(node, pMatrix) {\n                    var matrix = node.getLayoutTransform().merge(pMatrix.clone());\n                    var lastMatrix = node.getGlobalLayoutTransform() || new kity.Matrix();\n                    var offset = node.getLayoutOffset();\n                    matrix.translate(offset.x, offset.y);\n                    matrix.m.e = Math.round(matrix.m.e);\n                    matrix.m.f = Math.round(matrix.m.f);\n                    // 如果当前有动画，停止动画\n                    if (node._layoutTimeline) {\n                        node._layoutTimeline.stop();\n                        node._layoutTimeline = null;\n                    }\n                    // 如果要求以动画形式来更新，创建动画\n                    if (duration) {\n                        node._layoutTimeline = new kity.Animator(lastMatrix, matrix, applyMatrix).start(node, duration, "ease").on("finish", function() {\n                            //可能性能低的时候会丢帧，手动添加一帧\n                            setTimeout(function() {\n                                applyMatrix(node, matrix);\n                                me.fire("layoutfinish", {\n                                    node: node,\n                                    matrix: matrix\n                                });\n                                consume();\n                            }, 150);\n                        });\n                    } else {\n                        applyMatrix(node, matrix);\n                        me.fire("layoutfinish", {\n                            node: node,\n                            matrix: matrix\n                        });\n                        consume();\n                    }\n                    for (var i = 0; i < node.children.length; i++) {\n                        apply(node.children[i], matrix);\n                    }\n                }\n                apply(root, root.parent ? root.parent.getGlobalLayoutTransform() : new kity.Matrix());\n                return this;\n            }\n        });\n        module.exports = Layout;\n    }\n};\n\n//src/core/minder.js\n/**\n * @fileOverview\n *\n * KityMinder 类，暴露在 window 上的唯一变量\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[19] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var _initHooks = [];\n        var Minder = kity.createClass("Minder", {\n            constructor: function(options) {\n                this._options = utils.extend({}, options);\n                var initHooks = _initHooks.slice();\n                var initHook;\n                while (initHooks.length) {\n                    initHook = initHooks.shift();\n                    if (typeof initHook == "function") {\n                        initHook.call(this, this._options);\n                    }\n                }\n                this.fire("finishInitHook");\n            }\n        });\n        Minder.version = "1.4.43";\n        Minder.registerInitHook = function(hook) {\n            _initHooks.push(hook);\n        };\n        module.exports = Minder;\n    }\n};\n\n//src/core/module.js\n_p[20] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        /* 已注册的模块 */\n        var _modules = {};\n        exports.register = function(name, module) {\n            _modules[name] = module;\n        };\n        /* 模块初始化 */\n        Minder.registerInitHook(function() {\n            this._initModules();\n        });\n        // 模块声明周期维护\n        kity.extendClass(Minder, {\n            _initModules: function() {\n                var modulesPool = _modules;\n                var modulesToLoad = this._options.modules || utils.keys(modulesPool);\n                this._commands = {};\n                this._query = {};\n                this._modules = {};\n                this._rendererClasses = {};\n                var i, name, type, module, moduleDeals, dealCommands, dealEvents, dealRenderers;\n                var me = this;\n                for (i = 0; i < modulesToLoad.length; i++) {\n                    name = modulesToLoad[i];\n                    if (!modulesPool[name]) continue;\n                    // 执行模块初始化，抛出后续处理对象\n                    if (typeof modulesPool[name] == "function") {\n                        moduleDeals = modulesPool[name].call(me);\n                    } else {\n                        moduleDeals = modulesPool[name];\n                    }\n                    this._modules[name] = moduleDeals;\n                    if (!moduleDeals) continue;\n                    if (moduleDeals.defaultOptions) {\n                        me.setDefaultOptions(moduleDeals.defaultOptions);\n                    }\n                    if (moduleDeals.init) {\n                        moduleDeals.init.call(me, this._options);\n                    }\n                    /**\n                 * @Desc: 判断是否支持原生clipboard事件，如果支持，则对pager添加其监听\n                 * @Editor: Naixor\n                 * @Date: 2015.9.20\n                 */\n                    /**\n                 * 由于当前脑图解构问题，clipboard暂时全权交由玩不托管\n                 * @Editor: Naixor\n                 * @Date: 2015.9.24\n                 */\n                    // if (name === \'ClipboardModule\' && this.supportClipboardEvent  && !kity.Browser.gecko) {\n                    //     var on = function () {\n                    //         var clipBoardReceiver = this.clipBoardReceiver || document;\n                    //         if (document.addEventListener) {\n                    //             clipBoardReceiver.addEventListener.apply(this, arguments);\n                    //         } else {\n                    //             arguments[0] = \'on\' + arguments[0];\n                    //             clipBoardReceiver.attachEvent.apply(this, arguments);\n                    //         }\n                    //     }\n                    //     for (var command in moduleDeals.clipBoardEvents) {\n                    //         on(command, moduleDeals.clipBoardEvents[command]);\n                    //     }\n                    // };\n                    // command加入命令池子\n                    dealCommands = moduleDeals.commands;\n                    for (name in dealCommands) {\n                        this._commands[name.toLowerCase()] = new dealCommands[name]();\n                    }\n                    // 绑定事件\n                    dealEvents = moduleDeals.events;\n                    if (dealEvents) {\n                        for (type in dealEvents) {\n                            me.on(type, dealEvents[type]);\n                        }\n                    }\n                    // 渲染器\n                    dealRenderers = moduleDeals.renderers;\n                    if (dealRenderers) {\n                        for (type in dealRenderers) {\n                            this._rendererClasses[type] = this._rendererClasses[type] || [];\n                            if (utils.isArray(dealRenderers[type])) {\n                                this._rendererClasses[type] = this._rendererClasses[type].concat(dealRenderers[type]);\n                            } else {\n                                this._rendererClasses[type].push(dealRenderers[type]);\n                            }\n                        }\n                    }\n                    //添加模块的快捷键\n                    if (moduleDeals.commandShortcutKeys) {\n                        this.addCommandShortcutKeys(moduleDeals.commandShortcutKeys);\n                    }\n                }\n            },\n            _garbage: function() {\n                this.clearSelect();\n                while (this._root.getChildren().length) {\n                    this._root.removeChild(0);\n                }\n            },\n            destroy: function() {\n                var modules = this._modules;\n                this._resetEvents();\n                this._garbage();\n                for (var key in modules) {\n                    if (!modules[key].destroy) continue;\n                    modules[key].destroy.call(this);\n                }\n            },\n            reset: function() {\n                var modules = this._modules;\n                this._garbage();\n                for (var key in modules) {\n                    if (!modules[key].reset) continue;\n                    modules[key].reset.call(this);\n                }\n            }\n        });\n    }\n};\n\n//src/core/node.js\n_p[21] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        /**\n     * @class MinderNode\n     *\n     * 表示一个脑图节点\n     */\n        var MinderNode = kity.createClass("MinderNode", {\n            /**\n         * 创建一个游离的脑图节点\n         *\n         * @param {String|Object} textOrData\n         *     节点的初始数据或文本\n         */\n            constructor: function(textOrData) {\n                // 指针\n                this.parent = null;\n                this.root = this;\n                this.children = [];\n                // 数据\n                this.data = {\n                    id: utils.guid(),\n                    created: +new Date()\n                };\n                // 绘图容器\n                this.initContainers();\n                if (utils.isString(textOrData)) {\n                    this.setText(textOrData);\n                } else if (utils.isObject(textOrData)) {\n                    utils.extend(this.data, textOrData);\n                }\n            },\n            initContainers: function() {\n                this.rc = new kity.Group().setId(utils.uuid("minder_node"));\n                this.rc.minderNode = this;\n            },\n            /**\n         * 判断节点是否根节点\n         */\n            isRoot: function() {\n                return this.root === this;\n            },\n            /**\n         * 判断节点是否叶子\n         */\n            isLeaf: function() {\n                return this.children.length === 0;\n            },\n            /**\n         * 获取节点的根节点\n         */\n            getRoot: function() {\n                return this.root || this;\n            },\n            /**\n         * 获得节点的父节点\n         */\n            getParent: function() {\n                return this.parent;\n            },\n            getSiblings: function() {\n                var children = this.parent.children;\n                var siblings = [];\n                var self = this;\n                children.forEach(function(child) {\n                    if (child != self) siblings.push(child);\n                });\n                return siblings;\n            },\n            /**\n         * 获得节点的深度\n         */\n            getLevel: function() {\n                var level = 0, ancestor = this.parent;\n                while (ancestor) {\n                    level++;\n                    ancestor = ancestor.parent;\n                }\n                return level;\n            },\n            /**\n         * 获得节点的复杂度（即子树中节点的数量）\n         */\n            getComplex: function() {\n                var complex = 0;\n                this.traverse(function() {\n                    complex++;\n                });\n                return complex;\n            },\n            /**\n         * 获得节点的类型（root|main|sub）\n         */\n            getType: function(type) {\n                this.type = [ "root", "main", "sub" ][Math.min(this.getLevel(), 2)];\n                return this.type;\n            },\n            /**\n         * 判断当前节点是否被测试节点的祖先\n         * @param  {MinderNode}  test 被测试的节点\n         */\n            isAncestorOf: function(test) {\n                var ancestor = test.parent;\n                while (ancestor) {\n                    if (ancestor == this) return true;\n                    ancestor = ancestor.parent;\n                }\n                return false;\n            },\n            getData: function(key) {\n                return key ? this.data[key] : this.data;\n            },\n            setData: function(key, value) {\n                if (typeof key == "object") {\n                    var data = key;\n                    for (key in data) if (data.hasOwnProperty(key)) {\n                        this.data[key] = data[key];\n                    }\n                } else {\n                    this.data[key] = value;\n                }\n                return this;\n            },\n            /**\n         * 设置节点的文本数据\n         * @param {String} text 文本数据\n         */\n            setText: function(text) {\n                return this.data.text = text;\n            },\n            /**\n         * 获取节点的文本数据\n         * @return {String}\n         */\n            getText: function() {\n                return this.data.text || null;\n            },\n            /**\n         * 先序遍历当前节点树\n         * @param  {Function} fn 遍历函数\n         */\n            preTraverse: function(fn, excludeThis) {\n                var children = this.getChildren();\n                if (!excludeThis) fn(this);\n                for (var i = 0; i < children.length; i++) {\n                    children[i].preTraverse(fn);\n                }\n            },\n            /**\n         * 后序遍历当前节点树\n         * @param  {Function} fn 遍历函数\n         */\n            postTraverse: function(fn, excludeThis) {\n                var children = this.getChildren();\n                for (var i = 0; i < children.length; i++) {\n                    children[i].postTraverse(fn);\n                }\n                if (!excludeThis) fn(this);\n            },\n            traverse: function(fn, excludeThis) {\n                return this.postTraverse(fn, excludeThis);\n            },\n            getChildren: function() {\n                return this.children;\n            },\n            getIndex: function() {\n                return this.parent ? this.parent.children.indexOf(this) : -1;\n            },\n            insertChild: function(node, index) {\n                if (index === undefined) {\n                    index = this.children.length;\n                }\n                if (node.parent) {\n                    node.parent.removeChild(node);\n                }\n                node.parent = this;\n                node.root = this.root;\n                this.children.splice(index, 0, node);\n            },\n            appendChild: function(node) {\n                return this.insertChild(node);\n            },\n            prependChild: function(node) {\n                return this.insertChild(node, 0);\n            },\n            removeChild: function(elem) {\n                var index = elem, removed;\n                if (elem instanceof MinderNode) {\n                    index = this.children.indexOf(elem);\n                }\n                if (index >= 0) {\n                    removed = this.children.splice(index, 1)[0];\n                    removed.parent = null;\n                    removed.root = removed;\n                }\n            },\n            clearChildren: function() {\n                this.children = [];\n            },\n            getChild: function(index) {\n                return this.children[index];\n            },\n            getRenderContainer: function() {\n                return this.rc;\n            },\n            getCommonAncestor: function(node) {\n                return MinderNode.getCommonAncestor(this, node);\n            },\n            contains: function(node) {\n                return this == node || this.isAncestorOf(node);\n            },\n            clone: function() {\n                var cloned = new MinderNode();\n                cloned.data = utils.clone(this.data);\n                this.children.forEach(function(child) {\n                    cloned.appendChild(child.clone());\n                });\n                return cloned;\n            },\n            compareTo: function(node) {\n                if (!utils.comparePlainObject(this.data, node.data)) return false;\n                if (!utils.comparePlainObject(this.temp, node.temp)) return false;\n                if (this.children.length != node.children.length) return false;\n                var i = 0;\n                while (this.children[i]) {\n                    if (!this.children[i].compareTo(node.children[i])) return false;\n                    i++;\n                }\n                return true;\n            },\n            getMinder: function() {\n                return this.getRoot().minder;\n            }\n        });\n        MinderNode.getCommonAncestor = function(nodeA, nodeB) {\n            if (nodeA instanceof Array) {\n                return MinderNode.getCommonAncestor.apply(this, nodeA);\n            }\n            switch (arguments.length) {\n              case 1:\n                return nodeA.parent || nodeA;\n\n              case 2:\n                if (nodeA.isAncestorOf(nodeB)) {\n                    return nodeA;\n                }\n                if (nodeB.isAncestorOf(nodeA)) {\n                    return nodeB;\n                }\n                var ancestor = nodeA.parent;\n                while (ancestor && !ancestor.isAncestorOf(nodeB)) {\n                    ancestor = ancestor.parent;\n                }\n                return ancestor;\n\n              default:\n                return Array.prototype.reduce.call(arguments, function(prev, current) {\n                    return MinderNode.getCommonAncestor(prev, current);\n                }, nodeA);\n            }\n        };\n        kity.extendClass(Minder, {\n            getRoot: function() {\n                return this._root;\n            },\n            setRoot: function(root) {\n                this._root = root;\n                root.minder = this;\n            },\n            getAllNode: function() {\n                var nodes = [];\n                this.getRoot().traverse(function(node) {\n                    nodes.push(node);\n                });\n                return nodes;\n            },\n            getNodeById: function(id) {\n                return this.getNodesById([ id ])[0];\n            },\n            getNodesById: function(ids) {\n                var nodes = this.getAllNode();\n                var result = [];\n                nodes.forEach(function(node) {\n                    if (ids.indexOf(node.getData("id")) != -1) {\n                        result.push(node);\n                    }\n                });\n                return result;\n            },\n            createNode: function(textOrData, parent, index) {\n                var node = new MinderNode(textOrData);\n                this.fire("nodecreate", {\n                    node: node,\n                    parent: parent,\n                    index: index\n                });\n                this.appendNode(node, parent, index);\n                return node;\n            },\n            appendNode: function(node, parent, index) {\n                if (parent) parent.insertChild(node, index);\n                this.attachNode(node);\n                return this;\n            },\n            removeNode: function(node) {\n                if (node.parent) {\n                    node.parent.removeChild(node);\n                    this.detachNode(node);\n                    this.fire("noderemove", {\n                        node: node\n                    });\n                }\n            },\n            attachNode: function(node) {\n                var rc = this.getRenderContainer();\n                node.traverse(function(current) {\n                    current.attached = true;\n                    rc.addShape(current.getRenderContainer());\n                });\n                rc.addShape(node.getRenderContainer());\n                this.fire("nodeattach", {\n                    node: node\n                });\n            },\n            detachNode: function(node) {\n                var rc = this.getRenderContainer();\n                node.traverse(function(current) {\n                    current.attached = false;\n                    rc.removeShape(current.getRenderContainer());\n                });\n                this.fire("nodedetach", {\n                    node: node\n                });\n            },\n            getMinderTitle: function() {\n                return this.getRoot().getText();\n            }\n        });\n        module.exports = MinderNode;\n    }\n};\n\n//src/core/option.js\n/**\n * @fileOverview\n *\n * 提供脑图选项支持\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[22] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        Minder.registerInitHook(function(options) {\n            this._defaultOptions = {};\n        });\n        kity.extendClass(Minder, {\n            setDefaultOptions: function(options) {\n                utils.extend(this._defaultOptions, options);\n                return this;\n            },\n            getOption: function(key) {\n                if (key) {\n                    return key in this._options ? this._options[key] : this._defaultOptions[key];\n                } else {\n                    return utils.extend({}, this._defaultOptions, this._options);\n                }\n            },\n            setOption: function(key, value) {\n                this._options[key] = value;\n            }\n        });\n    }\n};\n\n//src/core/paper.js\n/**\n * @fileOverview\n *\n * 初始化渲染容器\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[23] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        Minder.registerInitHook(function() {\n            this._initPaper();\n        });\n        kity.extendClass(Minder, {\n            _initPaper: function() {\n                this._paper = new kity.Paper();\n                this._paper._minder = this;\n                this._paper.getNode().ondragstart = function(e) {\n                    e.preventDefault();\n                };\n                this._paper.shapeNode.setAttribute("transform", "translate(0.5, 0.5)");\n                this._addRenderContainer();\n                this.setRoot(this.createNode());\n                if (this._options.renderTo) {\n                    this.renderTo(this._options.renderTo);\n                }\n            },\n            _addRenderContainer: function() {\n                this._rc = new kity.Group().setId(utils.uuid("minder"));\n                this._paper.addShape(this._rc);\n            },\n            renderTo: function(target) {\n                if (typeof target == "string") {\n                    target = document.querySelector(target);\n                }\n                console.log("======target=======", target);\n                if (target) {\n                    if (target.tagName.toLowerCase() == "script") {\n                        var newTarget = document.createElement("div");\n                        newTarget.id = target.id;\n                        newTarget.class = target.class;\n                        target.parentNode.insertBefore(newTarget, target);\n                        target.parentNode.removeChild(target);\n                        target = newTarget;\n                    }\n                    target.classList.add("km-view");\n                    this._paper.renderTo(this._renderTarget = target);\n                    this._bindEvents();\n                    this.fire("paperrender");\n                }\n                return this;\n            },\n            getRenderContainer: function() {\n                return this._rc;\n            },\n            getPaper: function() {\n                return this._paper;\n            },\n            getRenderTarget: function() {\n                return this._renderTarget;\n            }\n        });\n    }\n};\n\n//src/core/patch.js\n/**\n * @fileOverview\n *\n * 打补丁\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[24] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        function insertNode(minder, info, parent, index) {\n            parent = minder.createNode(info.data, parent, index);\n            info.children.forEach(function(childInfo, index) {\n                insertNode(minder, childInfo, parent, index);\n            });\n            return parent;\n        }\n        function applyPatch(minder, patch) {\n            // patch.op - 操作，包括 remove, add, replace\n            // patch.path - 路径，如 \'/root/children/1/data\'\n            // patch.value - 数据，如 { text: "思路" }\n            var path = patch.path.split("/");\n            path.shift();\n            var changed = path.shift();\n            var node;\n            if (changed == "root") {\n                var dataIndex = path.indexOf("data");\n                if (dataIndex > -1) {\n                    changed = "data";\n                    var dataPath = path.splice(dataIndex + 1);\n                    patch.dataPath = dataPath;\n                } else {\n                    changed = "node";\n                }\n                node = minder.getRoot();\n                var segment, index;\n                while (segment = path.shift()) {\n                    if (segment == "children") continue;\n                    if (typeof index != "undefined") node = node.getChild(index);\n                    index = +segment;\n                }\n                patch.index = index;\n                patch.node = node;\n            }\n            var express = patch.express = [ changed, patch.op ].join(".");\n            switch (express) {\n              case "theme.replace":\n                minder.useTheme(patch.value);\n                break;\n\n              case "template.replace":\n                minder.useTemplate(patch.value);\n                break;\n\n              case "node.add":\n                insertNode(minder, patch.value, patch.node, patch.index).renderTree();\n                minder.layout();\n                break;\n\n              case "node.remove":\n                minder.removeNode(patch.node.getChild(patch.index));\n                minder.layout();\n                break;\n\n              case "data.add":\n              case "data.replace":\n              case "data.remove":\n                var data = patch.node.data;\n                var field;\n                path = patch.dataPath.slice();\n                while (data && path.length > 1) {\n                    field = path.shift();\n                    if (field in data) {\n                        data = data[field];\n                    } else if (patch.op != "remove") {\n                        data = data[field] = {};\n                    }\n                }\n                if (data) {\n                    field = path.shift();\n                    data[field] = patch.value;\n                }\n                if (field == "expandState") {\n                    node.renderTree();\n                } else {\n                    node.render();\n                }\n                minder.layout();\n            }\n            minder.fire("patch", {\n                patch: patch\n            });\n        }\n        kity.extendClass(Minder, {\n            applyPatches: function(patches) {\n                for (var i = 0; i < patches.length; i++) {\n                    applyPatch(this, patches[i]);\n                }\n                this.fire("contentchange");\n                return this;\n            }\n        });\n    }\n};\n\n//src/core/promise.js\n_p[25] = {\n    value: function(require, exports, module) {\n        /*!\n    **  Thenable -- Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable\n    **  Copyright (c) 2013-2014 Ralf S. Engelschall <http://engelschall.com>\n    **  Licensed under The MIT License <http://opensource.org/licenses/MIT>\n    **  Source-Code distributed on <http://github.com/rse/thenable>\n    */\n        /*  promise states [Promises/A+ 2.1]  */\n        var STATE_PENDING = 0;\n        /*  [Promises/A+ 2.1.1]  */\n        var STATE_FULFILLED = 1;\n        /*  [Promises/A+ 2.1.2]  */\n        var STATE_REJECTED = 2;\n        /*  [Promises/A+ 2.1.3]  */\n        /*  promise object constructor  */\n        var Promise = function(executor) {\n            /*  optionally support non-constructor/plain-function call  */\n            if (!(this instanceof Promise)) return new Promise(executor);\n            /*  initialize object  */\n            this.id = "Thenable/1.0.7";\n            this.state = STATE_PENDING;\n            /*  initial state  */\n            this.fulfillValue = undefined;\n            /*  initial value  */\n            /*  [Promises/A+ 1.3, 2.1.2.2]  */\n            this.rejectReason = undefined;\n            /*  initial reason */\n            /*  [Promises/A+ 1.5, 2.1.3.2]  */\n            this.onFulfilled = [];\n            /*  initial handlers  */\n            this.onRejected = [];\n            /*  initial handlers  */\n            /*  support optional executor function  */\n            if (typeof executor === "function") executor.call(this, this.fulfill.bind(this), this.reject.bind(this));\n        };\n        /*  Promise API methods  */\n        Promise.prototype = {\n            /*  promise resolving methods  */\n            fulfill: function(value) {\n                return deliver(this, STATE_FULFILLED, "fulfillValue", value);\n            },\n            reject: function(value) {\n                return deliver(this, STATE_REJECTED, "rejectReason", value);\n            },\n            /*  \'The then Method\' [Promises/A+ 1.1, 1.2, 2.2]  */\n            then: function(onFulfilled, onRejected) {\n                var curr = this;\n                var next = new Promise();\n                /*  [Promises/A+ 2.2.7]  */\n                curr.onFulfilled.push(resolver(onFulfilled, next, "fulfill"));\n                /*  [Promises/A+ 2.2.2/2.2.6]  */\n                curr.onRejected.push(resolver(onRejected, next, "reject"));\n                /*  [Promises/A+ 2.2.3/2.2.6]  */\n                execute(curr);\n                return next;\n            }\n        };\n        Promise.all = function(arr) {\n            return new Promise(function(resolve, reject) {\n                var len = arr.length, i = 0, res = 0, results = [];\n                if (len === 0) {\n                    resolve(results);\n                }\n                while (i < len) {\n                    arr[i].then(function(result) {\n                        results.push(result);\n                        if (++res === len) {\n                            resolve(results);\n                        }\n                    }, function(val) {\n                        reject(val);\n                    });\n                    i++;\n                }\n            });\n        };\n        /*  deliver an action  */\n        var deliver = function(curr, state, name, value) {\n            if (curr.state === STATE_PENDING) {\n                curr.state = state;\n                /*  [Promises/A+ 2.1.2.1, 2.1.3.1]  */\n                curr[name] = value;\n                /*  [Promises/A+ 2.1.2.2, 2.1.3.2]  */\n                execute(curr);\n            }\n            return curr;\n        };\n        /*  execute all handlers  */\n        var execute = function(curr) {\n            if (curr.state === STATE_FULFILLED) execute_handlers(curr, "onFulfilled", curr.fulfillValue); else if (curr.state === STATE_REJECTED) execute_handlers(curr, "onRejected", curr.rejectReason);\n        };\n        /*  execute particular set of handlers  */\n        var execute_handlers = function(curr, name, value) {\n            /* global process: true */\n            /* global setImmediate: true */\n            /* global setTimeout: true */\n            /*  short-circuit processing  */\n            if (curr[name].length === 0) return;\n            /*  iterate over all handlers, exactly once  */\n            var handlers = curr[name];\n            curr[name] = [];\n            /*  [Promises/A+ 2.2.2.3, 2.2.3.3]  */\n            var func = function() {\n                for (var i = 0; i < handlers.length; i++) handlers[i](value);\n            };\n            /*  execute procedure asynchronously  */\n            /*  [Promises/A+ 2.2.4, 3.1]  */\n            if (typeof process === "object" && typeof process.nextTick === "function") process.nextTick(func); else if (typeof setImmediate === "function") setImmediate(func); else setTimeout(func, 0);\n        };\n        /*  generate a resolver function */\n        var resolver = function(cb, next, method) {\n            return function(value) {\n                if (typeof cb !== "function") /*  [Promises/A+ 2.2.1, 2.2.7.3, 2.2.7.4]  */\n                next[method].call(next, value); else {\n                    var result;\n                    try {\n                        if (value instanceof Promise) {\n                            result = value.then(cb);\n                        } else result = cb(value);\n                    } /*  [Promises/A+ 2.2.2.1, 2.2.3.1, 2.2.5, 3.2]  */\n                    catch (e) {\n                        next.reject(e);\n                        /*  [Promises/A+ 2.2.7.2]  */\n                        return;\n                    }\n                    resolve(next, result);\n                }\n            };\n        };\n        /*  \'Promise Resolution Procedure\'  */\n        /*  [Promises/A+ 2.3]  */\n        var resolve = function(promise, x) {\n            /*  sanity check arguments  */\n            /*  [Promises/A+ 2.3.1]  */\n            if (promise === x) {\n                promise.reject(new TypeError("cannot resolve promise with itself"));\n                return;\n            }\n            /*  surgically check for a \'then\' method\n            (mainly to just call the \'getter\' of \'then\' only once)  */\n            var then;\n            if (typeof x === "object" && x !== null || typeof x === "function") {\n                try {\n                    then = x.then;\n                } /*  [Promises/A+ 2.3.3.1, 3.5]  */\n                catch (e) {\n                    promise.reject(e);\n                    /*  [Promises/A+ 2.3.3.2]  */\n                    return;\n                }\n            }\n            /*  handle own Thenables    [Promises/A+ 2.3.2]\n            and similar \'thenables\' [Promises/A+ 2.3.3]  */\n            if (typeof then === "function") {\n                var resolved = false;\n                try {\n                    /*  call retrieved \'then\' method */\n                    /*  [Promises/A+ 2.3.3.3]  */\n                    then.call(x, /*  resolvePromise  */\n                    /*  [Promises/A+ 2.3.3.3.1]  */\n                    function(y) {\n                        if (resolved) return;\n                        resolved = true;\n                        /*  [Promises/A+ 2.3.3.3.3]  */\n                        if (y === x) /*  [Promises/A+ 3.6]  */\n                        promise.reject(new TypeError("circular thenable chain")); else resolve(promise, y);\n                    }, /*  rejectPromise  */\n                    /*  [Promises/A+ 2.3.3.3.2]  */\n                    function(r) {\n                        if (resolved) return;\n                        resolved = true;\n                        /*  [Promises/A+ 2.3.3.3.3]  */\n                        promise.reject(r);\n                    });\n                } catch (e) {\n                    if (!resolved) /*  [Promises/A+ 2.3.3.3.3]  */\n                    promise.reject(e);\n                }\n                return;\n            }\n            /*  handle other values  */\n            promise.fulfill(x);\n        };\n        Promise.resolve = function(value) {\n            return new Promise(function(resolve) {\n                resolve(value);\n            });\n        };\n        Promise.reject = function(reason) {\n            return new Promise(function(resolve, reject) {\n                reject(reason);\n            });\n        };\n        /*  export API  */\n        module.exports = Promise;\n    }\n};\n\n//src/core/readonly.js\n/**\n * @fileOverview\n *\n * 只读模式支持\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[26] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        var MinderEvent = _p.r(13);\n        Minder.registerInitHook(function(options) {\n            if (options.readOnly) {\n                this.setDisabled();\n            }\n        });\n        kity.extendClass(Minder, {\n            disable: function() {\n                var me = this;\n                //禁用命令\n                me.bkqueryCommandState = me.queryCommandState;\n                me.bkqueryCommandValue = me.queryCommandValue;\n                me.queryCommandState = function(type) {\n                    var cmd = this._getCommand(type);\n                    if (cmd && cmd.enableReadOnly) {\n                        return me.bkqueryCommandState.apply(me, arguments);\n                    }\n                    return -1;\n                };\n                me.queryCommandValue = function(type) {\n                    var cmd = this._getCommand(type);\n                    if (cmd && cmd.enableReadOnly) {\n                        return me.bkqueryCommandValue.apply(me, arguments);\n                    }\n                    return null;\n                };\n                this.setStatus("readonly");\n                me._interactChange();\n            },\n            enable: function() {\n                var me = this;\n                if (me.bkqueryCommandState) {\n                    me.queryCommandState = me.bkqueryCommandState;\n                    delete me.bkqueryCommandState;\n                }\n                if (me.bkqueryCommandValue) {\n                    me.queryCommandValue = me.bkqueryCommandValue;\n                    delete me.bkqueryCommandValue;\n                }\n                this.setStatus("normal");\n                me._interactChange();\n            }\n        });\n    }\n};\n\n//src/core/render.js\n_p[27] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Renderer = kity.createClass("Renderer", {\n            constructor: function(node) {\n                this.node = node;\n            },\n            create: function(node) {\n                throw new Error("Not implement: Renderer.create()");\n            },\n            shouldRender: function(node) {\n                return true;\n            },\n            watchChange: function(data) {\n                var changed;\n                if (this.watchingData === undefined) {\n                    changed = true;\n                } else if (this.watchingData != data) {\n                    changed = true;\n                } else {\n                    changed = false;\n                }\n                this.watchingData = data;\n            },\n            shouldDraw: function(node) {\n                return true;\n            },\n            update: function(shape, node, box) {\n                if (this.shouldDraw()) this.draw(shape, node);\n                return this.place(shape, node, box);\n            },\n            draw: function(shape, node) {\n                throw new Error("Not implement: Renderer.draw()");\n            },\n            place: function(shape, node, box) {\n                throw new Error("Not implement: Renderer.place()");\n            },\n            getRenderShape: function() {\n                return this._renderShape || null;\n            },\n            setRenderShape: function(shape) {\n                this._renderShape = shape;\n            }\n        });\n        function createMinderExtension() {\n            function createRendererForNode(node, registered) {\n                var renderers = [];\n                [ "center", "left", "right", "top", "bottom", "outline", "outside" ].forEach(function(section) {\n                    var before = "before" + section;\n                    var after = "after" + section;\n                    if (registered[before]) {\n                        renderers = renderers.concat(registered[before]);\n                    }\n                    if (registered[section]) {\n                        renderers = renderers.concat(registered[section]);\n                    }\n                    if (registered[after]) {\n                        renderers = renderers.concat(registered[after]);\n                    }\n                });\n                node._renderers = renderers.map(function(Renderer) {\n                    return new Renderer(node);\n                });\n            }\n            return {\n                renderNodeBatch: function(nodes) {\n                    var rendererClasses = this._rendererClasses;\n                    var lastBoxes = [];\n                    var rendererCount = 0;\n                    var i, j, renderer, node;\n                    if (!nodes.length) return;\n                    for (j = 0; j < nodes.length; j++) {\n                        node = nodes[j];\n                        if (!node._renderers) {\n                            createRendererForNode(node, rendererClasses);\n                        }\n                        node._contentBox = new kity.Box();\n                        this.fire("beforerender", {\n                            node: node\n                        });\n                    }\n                    // 所有节点渲染器数量是一致的\n                    rendererCount = nodes[0]._renderers.length;\n                    for (i = 0; i < rendererCount; i++) {\n                        // 获取延迟盒子数据\n                        for (j = 0; j < nodes.length; j++) {\n                            if (typeof lastBoxes[j] == "function") {\n                                lastBoxes[j] = lastBoxes[j]();\n                            }\n                            if (!(lastBoxes[j] instanceof kity.Box)) {\n                                lastBoxes[j] = new kity.Box(lastBoxes[j]);\n                            }\n                        }\n                        for (j = 0; j < nodes.length; j++) {\n                            node = nodes[j];\n                            renderer = node._renderers[i];\n                            // 合并盒子\n                            if (lastBoxes[j]) {\n                                node._contentBox = node._contentBox.merge(lastBoxes[j]);\n                                renderer.contentBox = lastBoxes[j];\n                            }\n                            // 判断当前上下文是否应该渲染\n                            if (renderer.shouldRender(node)) {\n                                // 应该渲染，但是渲染图形没创建过，需要创建\n                                if (!renderer.getRenderShape()) {\n                                    renderer.setRenderShape(renderer.create(node));\n                                    if (renderer.bringToBack) {\n                                        node.getRenderContainer().prependShape(renderer.getRenderShape());\n                                    } else {\n                                        node.getRenderContainer().appendShape(renderer.getRenderShape());\n                                    }\n                                }\n                                // 强制让渲染图形显示\n                                renderer.getRenderShape().setVisible(true);\n                                // 更新渲染图形\n                                lastBoxes[j] = renderer.update(renderer.getRenderShape(), node, node._contentBox);\n                            } else if (renderer.getRenderShape()) {\n                                renderer.getRenderShape().setVisible(false);\n                                lastBoxes[j] = null;\n                            }\n                        }\n                    }\n                    for (j = 0; j < nodes.length; j++) {\n                        this.fire("noderender", {\n                            node: nodes[j]\n                        });\n                    }\n                },\n                renderNode: function(node) {\n                    var rendererClasses = this._rendererClasses;\n                    var i, latestBox, renderer;\n                    if (!node._renderers) {\n                        createRendererForNode(node, rendererClasses);\n                    }\n                    this.fire("beforerender", {\n                        node: node\n                    });\n                    node._contentBox = new kity.Box();\n                    node._renderers.forEach(function(renderer) {\n                        // 判断当前上下文是否应该渲染\n                        if (renderer.shouldRender(node)) {\n                            // 应该渲染，但是渲染图形没创建过，需要创建\n                            if (!renderer.getRenderShape()) {\n                                renderer.setRenderShape(renderer.create(node));\n                                if (renderer.bringToBack) {\n                                    node.getRenderContainer().prependShape(renderer.getRenderShape());\n                                } else {\n                                    node.getRenderContainer().appendShape(renderer.getRenderShape());\n                                }\n                            }\n                            // 强制让渲染图形显示\n                            renderer.getRenderShape().setVisible(true);\n                            // 更新渲染图形\n                            latestBox = renderer.update(renderer.getRenderShape(), node, node._contentBox);\n                            if (typeof latestBox == "function") latestBox = latestBox();\n                            // 合并渲染区域\n                            if (latestBox) {\n                                node._contentBox = node._contentBox.merge(latestBox);\n                                renderer.contentBox = latestBox;\n                            }\n                        } else if (renderer.getRenderShape()) {\n                            renderer.getRenderShape().setVisible(false);\n                        }\n                    });\n                    this.fire("noderender", {\n                        node: node\n                    });\n                }\n            };\n        }\n        kity.extendClass(Minder, createMinderExtension());\n        kity.extendClass(MinderNode, {\n            render: function() {\n                if (!this.attached) return;\n                this.getMinder().renderNode(this);\n                return this;\n            },\n            renderTree: function() {\n                if (!this.attached) return;\n                var list = [];\n                this.traverse(function(node) {\n                    list.push(node);\n                });\n                this.getMinder().renderNodeBatch(list);\n                return this;\n            },\n            getRenderer: function(type) {\n                var rs = this._renderers;\n                if (!rs) return null;\n                for (var i = 0; i < rs.length; i++) {\n                    if (rs[i].getType() == type) return rs[i];\n                }\n                return null;\n            },\n            getContentBox: function() {\n                //if (!this._contentBox) this.render();\n                return this.parent && this.parent.isCollapsed() ? new kity.Box() : this._contentBox || new kity.Box();\n            },\n            getRenderBox: function(rendererType, refer) {\n                var renderer = rendererType && this.getRenderer(rendererType);\n                var contentBox = renderer ? renderer.contentBox : this.getContentBox();\n                var ctm = kity.Matrix.getCTM(this.getRenderContainer(), refer || "paper");\n                return ctm.transformBox(contentBox);\n            }\n        });\n        module.exports = Renderer;\n    }\n};\n\n//src/core/select.js\n_p[28] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        Minder.registerInitHook(function() {\n            this._initSelection();\n        });\n        // 选区管理\n        kity.extendClass(Minder, {\n            _initSelection: function() {\n                this._selectedNodes = [];\n            },\n            renderChangedSelection: function(last) {\n                var current = this.getSelectedNodes();\n                var changed = [];\n                current.forEach(function(node) {\n                    if (last.indexOf(node) == -1) {\n                        changed.push(node);\n                    }\n                });\n                last.forEach(function(node) {\n                    if (current.indexOf(node) == -1) {\n                        changed.push(node);\n                    }\n                });\n                if (changed.length) {\n                    this._interactChange();\n                    this.fire("selectionchange");\n                }\n                while (changed.length) {\n                    changed.shift().render();\n                }\n            },\n            getSelectedNodes: function() {\n                //不能克隆返回，会对当前选区操作，从而影响querycommand\n                return this._selectedNodes;\n            },\n            getSelectedNode: function() {\n                return this.getSelectedNodes()[0] || null;\n            },\n            removeAllSelectedNodes: function() {\n                var me = this;\n                var last = this._selectedNodes.splice(0);\n                this._selectedNodes = [];\n                this.renderChangedSelection(last);\n                return this.fire("selectionclear");\n            },\n            removeSelectedNodes: function(nodes) {\n                var me = this;\n                var last = this._selectedNodes.slice(0);\n                nodes = utils.isArray(nodes) ? nodes : [ nodes ];\n                nodes.forEach(function(node) {\n                    var index;\n                    if ((index = me._selectedNodes.indexOf(node)) === -1) return;\n                    me._selectedNodes.splice(index, 1);\n                });\n                this.renderChangedSelection(last);\n                return this;\n            },\n            select: function(nodes, isSingleSelect) {\n                var lastSelect = this.getSelectedNodes().slice(0);\n                if (isSingleSelect) {\n                    this._selectedNodes = [];\n                }\n                var me = this;\n                nodes = utils.isArray(nodes) ? nodes : [ nodes ];\n                nodes.forEach(function(node) {\n                    if (me._selectedNodes.indexOf(node) !== -1) return;\n                    me._selectedNodes.unshift(node);\n                });\n                this.renderChangedSelection(lastSelect);\n                return this;\n            },\n            selectById: function(ids, isSingleSelect) {\n                ids = utils.isArray(ids) ? ids : [ ids ];\n                var nodes = this.getNodesById(ids);\n                return this.select(nodes, isSingleSelect);\n            },\n            //当前选区中的节点在给定的节点范围内的保留选中状态，\n            //没在给定范围的取消选中，给定范围中的但没在当前选中范围的也做选中效果\n            toggleSelect: function(node) {\n                if (utils.isArray(node)) {\n                    node.forEach(this.toggleSelect.bind(this));\n                } else {\n                    if (node.isSelected()) this.removeSelectedNodes(node); else this.select(node);\n                }\n                return this;\n            },\n            isSingleSelect: function() {\n                return this._selectedNodes.length == 1;\n            },\n            getSelectedAncestors: function(includeRoot) {\n                var nodes = this.getSelectedNodes().slice(0), ancestors = [], judge;\n                // 根节点不参与计算\n                var rootIndex = nodes.indexOf(this.getRoot());\n                if (~rootIndex && !includeRoot) {\n                    nodes.splice(rootIndex, 1);\n                }\n                // 判断 nodes 列表中是否存在 judge 的祖先\n                function hasAncestor(nodes, judge) {\n                    for (var i = nodes.length - 1; i >= 0; --i) {\n                        if (nodes[i].isAncestorOf(judge)) return true;\n                    }\n                    return false;\n                }\n                // 按照拓扑排序\n                nodes.sort(function(node1, node2) {\n                    return node1.getLevel() - node2.getLevel();\n                });\n                // 因为是拓扑有序的，所以只需往上查找\n                while (judge = nodes.pop()) {\n                    if (!hasAncestor(nodes, judge)) {\n                        ancestors.push(judge);\n                    }\n                }\n                return ancestors;\n            }\n        });\n        kity.extendClass(MinderNode, {\n            isSelected: function() {\n                var minder = this.getMinder();\n                return minder && minder.getSelectedNodes().indexOf(this) != -1;\n            }\n        });\n    }\n};\n\n//src/core/shortcut.js\n/**\n * @fileOverview\n *\n * 添加快捷键支持\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[29] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var keymap = _p.r(15);\n        var Minder = _p.r(19);\n        var MinderEvent = _p.r(13);\n        /**\n     * 计算包含 meta 键的 keycode\n     *\n     * @param  {String|KeyEvent} unknown\n     */\n        function getMetaKeyCode(unknown) {\n            var CTRL_MASK = 4096;\n            var ALT_MASK = 8192;\n            var SHIFT_MASK = 16384;\n            var metaKeyCode = 0;\n            if (typeof unknown == "string") {\n                // unknown as string\n                unknown.toLowerCase().split(/\\+\\s*/).forEach(function(name) {\n                    switch (name) {\n                      case "ctrl":\n                      case "cmd":\n                        metaKeyCode |= CTRL_MASK;\n                        break;\n\n                      case "alt":\n                        metaKeyCode |= ALT_MASK;\n                        break;\n\n                      case "shift":\n                        metaKeyCode |= SHIFT_MASK;\n                        break;\n\n                      default:\n                        metaKeyCode |= keymap[name];\n                    }\n                });\n            } else {\n                // unknown as key event\n                if (unknown.ctrlKey || unknown.metaKey) {\n                    metaKeyCode |= CTRL_MASK;\n                }\n                if (unknown.altKey) {\n                    metaKeyCode |= ALT_MASK;\n                }\n                if (unknown.shiftKey) {\n                    metaKeyCode |= SHIFT_MASK;\n                }\n                metaKeyCode |= unknown.keyCode;\n            }\n            return metaKeyCode;\n        }\n        kity.extendClass(MinderEvent, {\n            isShortcutKey: function(keyCombine) {\n                var keyEvent = this.originEvent;\n                if (!keyEvent) return false;\n                return getMetaKeyCode(keyCombine) == getMetaKeyCode(keyEvent);\n            }\n        });\n        Minder.registerInitHook(function() {\n            this._initShortcutKey();\n        });\n        kity.extendClass(Minder, {\n            _initShortcutKey: function() {\n                this._bindShortcutKeys();\n            },\n            _bindShortcutKeys: function() {\n                var map = this._shortcutKeys = {};\n                var has = "hasOwnProperty";\n                this.on("keydown", function(e) {\n                    for (var keys in map) {\n                        if (!map[has](keys)) continue;\n                        if (e.isShortcutKey(keys)) {\n                            var fn = map[keys];\n                            if (fn.__statusCondition && fn.__statusCondition != this.getStatus()) return;\n                            fn();\n                            e.preventDefault();\n                        }\n                    }\n                });\n            },\n            addShortcut: function(keys, fn) {\n                var binds = this._shortcutKeys;\n                keys.split(/\\|\\s*/).forEach(function(combine) {\n                    var parts = combine.split("::");\n                    var status;\n                    if (parts.length > 1) {\n                        combine = parts[1];\n                        status = parts[0];\n                        fn.__statusCondition = status;\n                    }\n                    binds[combine] = fn;\n                });\n            },\n            addCommandShortcutKeys: function(cmd, keys) {\n                var binds = this._commandShortcutKeys || (this._commandShortcutKeys = {});\n                var obj = {}, km = this;\n                if (keys) {\n                    obj[cmd] = keys;\n                } else {\n                    obj = cmd;\n                }\n                var minder = this;\n                utils.each(obj, function(keys, command) {\n                    binds[command] = keys;\n                    minder.addShortcut(keys, function execCommandByShortcut() {\n                        /**\n                     * 之前判断有问题，由 === 0 改为 !== -1\n                     * @editor Naixor\n                     * @Date 2015-12-2\n                     */\n                        if (minder.queryCommandState(command) !== -1) {\n                            minder.execCommand(command);\n                        }\n                    });\n                });\n            },\n            getCommandShortcutKey: function(cmd) {\n                var binds = this._commandShortcutKeys;\n                return binds && binds[cmd] || null;\n            },\n            /**\n         * @Desc: 添加一个判断是否支持原生Clipboard的变量，用于对ctrl + v和ctrl + c的处理\n         * @Editor: Naixor\n         * @Date: 2015.9.20\n         */\n            supportClipboardEvent: function(window) {\n                return !!window.ClipboardEvent;\n            }(window)\n        });\n    }\n};\n\n//src/core/status.js\n/**\n * @fileOverview\n *\n * 状态切换控制\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[30] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Minder = _p.r(19);\n        var sf = ~window.location.href.indexOf("status");\n        var tf = ~window.location.href.indexOf("trace");\n        Minder.registerInitHook(function() {\n            this._initStatus();\n        });\n        kity.extendClass(Minder, {\n            _initStatus: function() {\n                this._status = "normal";\n                this._rollbackStatus = "normal";\n            },\n            setStatus: function(status, force) {\n                // 在 readonly 模式下，只有 force 为 true 才能切换回来\n                if (this._status == "readonly" && !force) return this;\n                if (status != this._status) {\n                    this._rollbackStatus = this._status;\n                    this._status = status;\n                    this.fire("statuschange", {\n                        lastStatus: this._rollbackStatus,\n                        currentStatus: this._status\n                    });\n                    if (sf) {\n                        /* global console: true */\n                        console.log(window.event.type, this._rollbackStatus, "->", this._status);\n                        if (tf) {\n                            console.trace();\n                        }\n                    }\n                }\n                return this;\n            },\n            rollbackStatus: function() {\n                this.setStatus(this._rollbackStatus);\n            },\n            getRollbackStatus: function() {\n                return this._rollbackStatus;\n            },\n            getStatus: function() {\n                return this._status;\n            }\n        });\n    }\n};\n\n//src/core/template.js\n_p[31] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var Command = _p.r(9);\n        var MinderNode = _p.r(21);\n        var Module = _p.r(20);\n        var _templates = {};\n        function register(name, supports) {\n            _templates[name] = supports;\n        }\n        exports.register = register;\n        utils.extend(Minder, {\n            getTemplateList: function() {\n                return _templates;\n            }\n        });\n        kity.extendClass(Minder, function() {\n            var originGetTheme = Minder.prototype.getTheme;\n            return {\n                useTemplate: function(name, duration) {\n                    this.setTemplate(name);\n                    this.refresh(duration || 800);\n                },\n                getTemplate: function() {\n                    return this._template || "default";\n                },\n                setTemplate: function(name) {\n                    this._template = name || null;\n                },\n                getTemplateSupport: function(method) {\n                    var supports = _templates[this.getTemplate()];\n                    return supports && supports[method];\n                },\n                getTheme: function(node) {\n                    var support = this.getTemplateSupport("getTheme") || originGetTheme;\n                    return support.call(this, node);\n                }\n            };\n        }());\n        kity.extendClass(MinderNode, function() {\n            var originGetLayout = MinderNode.prototype.getLayout;\n            var originGetConnect = MinderNode.prototype.getConnect;\n            return {\n                getLayout: function() {\n                    var support = this.getMinder().getTemplateSupport("getLayout") || originGetLayout;\n                    return support.call(this, this);\n                },\n                getConnect: function() {\n                    var support = this.getMinder().getTemplateSupport("getConnect") || originGetConnect;\n                    return support.call(this, this);\n                }\n            };\n        }());\n        Module.register("TemplateModule", {\n            /**\n         * @command Template\n         * @description 设置当前脑图的模板\n         * @param {string} name 模板名称\n         *    允许使用的模板可以使用 `kityminder.Minder.getTemplateList()` 查询\n         * @state\n         *   0: 始终可用\n         * @return 返回当前的模板名称\n         */\n            commands: {\n                template: kity.createClass("TemplateCommand", {\n                    base: Command,\n                    execute: function(minder, name) {\n                        minder.useTemplate(name);\n                        minder.execCommand("camera");\n                    },\n                    queryValue: function(minder) {\n                        return minder.getTemplate() || "default";\n                    }\n                })\n            }\n        });\n    }\n};\n\n//src/core/theme.js\n_p[32] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Module = _p.r(20);\n        var Command = _p.r(9);\n        var cssLikeValueMatcher = {\n            left: function(value) {\n                return 3 in value && value[3] || 1 in value && value[1] || value[0];\n            },\n            right: function(value) {\n                return 1 in value && value[1] || value[0];\n            },\n            top: function(value) {\n                return value[0];\n            },\n            bottom: function(value) {\n                return 2 in value && value[2] || value[0];\n            }\n        };\n        var _themes = {};\n        /**\n     * 注册一个主题\n     *\n     * @param  {String} name  主题的名称\n     * @param  {Plain} theme 主题的样式描述\n     *\n     * @example\n     *     Minder.registerTheme(\'default\', {\n     *         \'root-color\': \'red\',\n     *         \'root-stroke\': \'none\',\n     *         \'root-padding\': [10, 20]\n     *     });\n     */\n        function register(name, theme) {\n            _themes[name] = theme;\n        }\n        exports.register = register;\n        utils.extend(Minder, {\n            getThemeList: function() {\n                return _themes;\n            }\n        });\n        kity.extendClass(Minder, {\n            /**\n         * 切换脑图实例上的主题\n         * @param  {String} name 要使用的主题的名称\n         */\n            useTheme: function(name) {\n                this.setTheme(name);\n                this.refresh(800);\n                return true;\n            },\n            setTheme: function(name) {\n                if (name && !_themes[name]) throw new Error("Theme " + name + " not exists!");\n                var lastTheme = this._theme;\n                this._theme = name || null;\n                var container = this.getRenderTarget();\n                if (container) {\n                    container.classList.remove("km-theme-" + lastTheme);\n                    if (name) {\n                        container.classList.add("km-theme-" + name);\n                    }\n                    container.style.background = this.getStyle("background");\n                }\n                this.fire("themechange", {\n                    theme: name\n                });\n                return this;\n            },\n            /**\n         * 获取脑图实例上的当前主题\n         * @return {[type]} [description]\n         */\n            getTheme: function(node) {\n                return this._theme || this.getOption("defaultTheme") || "fresh-blue";\n            },\n            getThemeItems: function(node) {\n                var theme = this.getTheme(node);\n                return _themes[this.getTheme(node)];\n            },\n            /**\n         * 获得脑图实例上的样式\n         * @param  {String} item 样式名称\n         */\n            getStyle: function(item, node) {\n                var items = this.getThemeItems(node);\n                var segment, dir, selector, value, matcher;\n                if (item in items) return items[item];\n                // 尝试匹配 CSS 数组形式的值\n                // 比如 item 为 \'pading-left\'\n                // theme 里有 {\'padding\': [10, 20]} 的定义，则可以返回 20\n                segment = item.split("-");\n                if (segment.length < 2) return null;\n                dir = segment.pop();\n                item = segment.join("-");\n                if (item in items) {\n                    value = items[item];\n                    if (utils.isArray(value) && (matcher = cssLikeValueMatcher[dir])) {\n                        return matcher(value);\n                    }\n                    if (!isNaN(value)) return value;\n                }\n                return null;\n            },\n            /**\n         * 获取指定节点的样式\n         * @param  {String} name 样式名称，可以不加节点类型的前缀\n         */\n            getNodeStyle: function(node, name) {\n                var value = this.getStyle(node.getType() + "-" + name, node);\n                return value !== null ? value : this.getStyle(name, node);\n            }\n        });\n        kity.extendClass(MinderNode, {\n            getStyle: function(name) {\n                return this.getMinder().getNodeStyle(this, name);\n            }\n        });\n        Module.register("Theme", {\n            defaultOptions: {\n                defaultTheme: "fresh-blue"\n            },\n            commands: {\n                /**\n             * @command Theme\n             * @description 设置当前脑图的主题\n             * @param {string} name 主题名称\n             *    允许使用的主题可以使用 `kityminder.Minder.getThemeList()` 查询\n             * @state\n             *   0: 始终可用\n             * @return 返回当前的主题名称\n             */\n                theme: kity.createClass("ThemeCommand", {\n                    base: Command,\n                    execute: function(km, name) {\n                        return km.useTheme(name);\n                    },\n                    queryValue: function(km) {\n                        return km.getTheme() || "default";\n                    }\n                })\n            }\n        });\n        Minder.registerInitHook(function() {\n            this.setTheme();\n        });\n    }\n};\n\n//src/core/utils.js\n_p[33] = {\n    value: function(require, exports) {\n        var kity = _p.r(17);\n        var uuidMap = {};\n        exports.extend = kity.Utils.extend.bind(kity.Utils);\n        exports.each = kity.Utils.each.bind(kity.Utils);\n        exports.uuid = function(group) {\n            uuidMap[group] = uuidMap[group] ? uuidMap[group] + 1 : 1;\n            return group + uuidMap[group];\n        };\n        exports.guid = function() {\n            return (+new Date() * 1e6 + Math.floor(Math.random() * 1e6)).toString(36);\n        };\n        exports.trim = function(str) {\n            return str.replace(/(^[ \\t\\n\\r]+)|([ \\t\\n\\r]+$)/g, "");\n        };\n        exports.keys = function(plain) {\n            var keys = [];\n            for (var key in plain) {\n                if (plain.hasOwnProperty(key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n        exports.clone = function(source) {\n            return JSON.parse(JSON.stringify(source));\n        };\n        exports.comparePlainObject = function(a, b) {\n            return JSON.stringify(a) == JSON.stringify(b);\n        };\n        exports.encodeHtml = function(str, reg) {\n            return str ? str.replace(reg || /[&<">\'](?:(amp|lt|quot|gt|#39|nbsp);)?/g, function(a, b) {\n                if (b) {\n                    return a;\n                } else {\n                    return {\n                        "<": "&lt;",\n                        "&": "&amp;",\n                        \'"\': "&quot;",\n                        ">": "&gt;",\n                        "\'": "&#39;"\n                    }[a];\n                }\n            }) : "";\n        };\n        exports.clearWhiteSpace = function(str) {\n            return str.replace(/[\\u200b\\t\\r\\n]/g, "");\n        };\n        exports.each([ "String", "Function", "Array", "Number", "RegExp", "Object" ], function(v) {\n            var toString = Object.prototype.toString;\n            exports["is" + v] = function(obj) {\n                return toString.apply(obj) == "[object " + v + "]";\n            };\n        });\n    }\n};\n\n//src/expose-kityminder.js\n_p[34] = {\n    value: function(require, exports, module) {\n        module.exports = window.kityminder = _p.r(35);\n    }\n};\n\n//src/kityminder.js\n/**\n * @fileOverview\n *\n * 默认导出（全部模块）\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[35] = {\n    value: function(require, exports, module) {\n        var kityminder = {\n            version: _p.r(19).version\n        };\n        // 核心导出，大写的部分导出类，小写的部分简单 require 一下\n        // 这里顺序是有讲究的，调整前先弄清楚依赖关系。\n        _p.r(33);\n        kityminder.Minder = _p.r(19);\n        kityminder.Command = _p.r(9);\n        kityminder.Node = _p.r(21);\n        _p.r(22);\n        _p.r(8);\n        kityminder.Event = _p.r(13);\n        kityminder.data = _p.r(12);\n        _p.r(10);\n        kityminder.KeyMap = _p.r(15);\n        _p.r(29);\n        _p.r(30);\n        _p.r(23);\n        _p.r(28);\n        _p.r(14);\n        _p.r(16);\n        kityminder.Module = _p.r(20);\n        _p.r(26);\n        kityminder.Render = _p.r(27);\n        kityminder.Connect = _p.r(11);\n        kityminder.Layout = _p.r(18);\n        kityminder.Theme = _p.r(32);\n        kityminder.Template = _p.r(31);\n        kityminder.Promise = _p.r(25);\n        _p.r(7);\n        _p.r(24);\n        // 模块依赖\n        _p.r(42);\n        _p.r(43);\n        _p.r(44);\n        _p.r(45);\n        _p.r(46);\n        _p.r(47);\n        _p.r(48);\n        _p.r(50);\n        _p.r(49);\n        _p.r(51);\n        _p.r(52);\n        _p.r(53);\n        _p.r(54);\n        _p.r(55);\n        _p.r(56);\n        _p.r(57);\n        _p.r(58);\n        _p.r(59);\n        _p.r(60);\n        _p.r(61);\n        _p.r(62);\n        _p.r(63);\n        _p.r(64);\n        _p.r(68);\n        _p.r(65);\n        _p.r(67);\n        _p.r(66);\n        _p.r(40);\n        _p.r(36);\n        _p.r(37);\n        _p.r(38);\n        _p.r(39);\n        _p.r(41);\n        _p.r(75);\n        _p.r(78);\n        _p.r(77);\n        _p.r(76);\n        _p.r(78);\n        _p.r(80);\n        _p.r(79);\n        _p.r(0);\n        _p.r(1);\n        _p.r(2);\n        _p.r(3);\n        _p.r(4);\n        _p.r(5);\n        _p.r(6);\n        _p.r(69);\n        _p.r(73);\n        _p.r(70);\n        _p.r(72);\n        _p.r(71);\n        _p.r(74);\n        module.exports = kityminder;\n    }\n};\n\n//src/layout/btree.js\n_p[36] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        [ "left", "right", "top", "bottom" ].forEach(registerLayoutForDirection);\n        function registerLayoutForDirection(name) {\n            var axis = name == "left" || name == "right" ? "x" : "y";\n            var dir = name == "left" || name == "top" ? -1 : 1;\n            var oppsite = {\n                left: "right",\n                right: "left",\n                top: "bottom",\n                bottom: "top",\n                x: "y",\n                y: "x"\n            };\n            function getOrderHint(node) {\n                var hint = [];\n                var box = node.getLayoutBox();\n                var offset = 5;\n                if (axis == "x") {\n                    hint.push({\n                        type: "up",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.x,\n                            y: box.top - node.getStyle("margin-top") - offset,\n                            width: box.width,\n                            height: node.getStyle("margin-top")\n                        }),\n                        path: [ "M", box.x, box.top - offset, "L", box.right, box.top - offset ]\n                    });\n                    hint.push({\n                        type: "down",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.x,\n                            y: box.bottom + offset,\n                            width: box.width,\n                            height: node.getStyle("margin-bottom")\n                        }),\n                        path: [ "M", box.x, box.bottom + offset, "L", box.right, box.bottom + offset ]\n                    });\n                } else {\n                    hint.push({\n                        type: "up",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.left - node.getStyle("margin-left") - offset,\n                            y: box.top,\n                            width: node.getStyle("margin-left"),\n                            height: box.height\n                        }),\n                        path: [ "M", box.left - offset, box.top, "L", box.left - offset, box.bottom ]\n                    });\n                    hint.push({\n                        type: "down",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.right + offset,\n                            y: box.top,\n                            width: node.getStyle("margin-right"),\n                            height: box.height\n                        }),\n                        path: [ "M", box.right + offset, box.top, "L", box.right + offset, box.bottom ]\n                    });\n                }\n                return hint;\n            }\n            Layout.register(name, kity.createClass({\n                base: Layout,\n                doLayout: function(parent, children) {\n                    var pbox = parent.getContentBox();\n                    if (axis == "x") {\n                        parent.setVertexOut(new kity.Point(pbox[name], pbox.cy));\n                        parent.setLayoutVectorOut(new kity.Vector(dir, 0));\n                    } else {\n                        parent.setVertexOut(new kity.Point(pbox.cx, pbox[name]));\n                        parent.setLayoutVectorOut(new kity.Vector(0, dir));\n                    }\n                    if (!children.length) {\n                        return false;\n                    }\n                    children.forEach(function(child) {\n                        var cbox = child.getContentBox();\n                        child.setLayoutTransform(new kity.Matrix());\n                        if (axis == "x") {\n                            child.setVertexIn(new kity.Point(cbox[oppsite[name]], cbox.cy));\n                            child.setLayoutVectorIn(new kity.Vector(dir, 0));\n                        } else {\n                            child.setVertexIn(new kity.Point(cbox.cx, cbox[oppsite[name]]));\n                            child.setLayoutVectorIn(new kity.Vector(0, dir));\n                        }\n                    });\n                    this.align(children, oppsite[name]);\n                    this.stack(children, oppsite[axis]);\n                    var bbox = this.getBranchBox(children);\n                    var xAdjust = 0, yAdjust = 0;\n                    if (axis == "x") {\n                        xAdjust = pbox[name];\n                        xAdjust += dir * parent.getStyle("margin-" + name);\n                        xAdjust += dir * children[0].getStyle("margin-" + oppsite[name]);\n                        yAdjust = pbox.bottom;\n                        yAdjust -= pbox.height / 2;\n                        yAdjust -= bbox.height / 2;\n                        yAdjust -= bbox.y;\n                    } else {\n                        xAdjust = pbox.right;\n                        xAdjust -= pbox.width / 2;\n                        xAdjust -= bbox.width / 2;\n                        xAdjust -= bbox.x;\n                        yAdjust = pbox[name];\n                        yAdjust += dir * parent.getStyle("margin-" + name);\n                        yAdjust += dir * children[0].getStyle("margin-" + oppsite[name]);\n                    }\n                    this.move(children, xAdjust, yAdjust);\n                },\n                getOrderHint: getOrderHint\n            }));\n        }\n    }\n};\n\n//src/layout/filetree.js\n_p[37] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        [ -1, 1 ].forEach(registerLayoutForDir);\n        function registerLayoutForDir(dir) {\n            var name = "filetree-" + (dir > 0 ? "down" : "up");\n            Layout.register(name, kity.createClass({\n                base: Layout,\n                doLayout: function(parent, children, round) {\n                    var pBox = parent.getContentBox();\n                    var indent = 20;\n                    parent.setVertexOut(new kity.Point(pBox.left + indent, dir > 0 ? pBox.bottom : pBox.top));\n                    parent.setLayoutVectorOut(new kity.Vector(0, dir));\n                    if (!children.length) return;\n                    children.forEach(function(child) {\n                        var cbox = child.getContentBox();\n                        child.setLayoutTransform(new kity.Matrix());\n                        child.setVertexIn(new kity.Point(cbox.left, cbox.cy));\n                        child.setLayoutVectorIn(new kity.Vector(1, 0));\n                    });\n                    this.align(children, "left");\n                    this.stack(children, "y");\n                    var xAdjust = 0;\n                    xAdjust += pBox.left;\n                    xAdjust += indent;\n                    xAdjust += children[0].getStyle("margin-left");\n                    var yAdjust = 0;\n                    if (dir > 0) {\n                        yAdjust += pBox.bottom;\n                        yAdjust += parent.getStyle("margin-bottom");\n                        yAdjust += children[0].getStyle("margin-top");\n                    } else {\n                        yAdjust -= this.getTreeBox(children).bottom;\n                        yAdjust += pBox.top;\n                        yAdjust -= parent.getStyle("margin-top");\n                        yAdjust -= children[0].getStyle("margin-bottom");\n                    }\n                    this.move(children, xAdjust, yAdjust);\n                },\n                getOrderHint: function(node) {\n                    var hint = [];\n                    var box = node.getLayoutBox();\n                    var offset = node.getLevel() > 1 ? 3 : 5;\n                    hint.push({\n                        type: "up",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.x,\n                            y: box.top - node.getStyle("margin-top") - offset,\n                            width: box.width,\n                            height: node.getStyle("margin-top")\n                        }),\n                        path: [ "M", box.x, box.top - offset, "L", box.right, box.top - offset ]\n                    });\n                    hint.push({\n                        type: "down",\n                        node: node,\n                        area: new kity.Box({\n                            x: box.x,\n                            y: box.bottom + offset,\n                            width: box.width,\n                            height: node.getStyle("margin-bottom")\n                        }),\n                        path: [ "M", box.x, box.bottom + offset, "L", box.right, box.bottom + offset ]\n                    });\n                    return hint;\n                }\n            }));\n        }\n    }\n};\n\n//src/layout/fish-bone-master.js\n/**\n * @fileOverview\n *\n * 鱼骨图主骨架布局\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[38] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        Layout.register("fish-bone-master", kity.createClass("FishBoneMasterLayout", {\n            base: Layout,\n            doLayout: function(parent, children, round) {\n                var upPart = [], downPart = [];\n                var child = children[0];\n                var pBox = parent.getContentBox();\n                parent.setVertexOut(new kity.Point(pBox.right, pBox.cy));\n                parent.setLayoutVectorOut(new kity.Vector(1, 0));\n                if (!child) return;\n                var cBox = child.getContentBox();\n                var pMarginRight = parent.getStyle("margin-right");\n                var cMarginLeft = child.getStyle("margin-left");\n                var cMarginTop = child.getStyle("margin-top");\n                var cMarginBottom = child.getStyle("margin-bottom");\n                children.forEach(function(child, index) {\n                    child.setLayoutTransform(new kity.Matrix());\n                    var cBox = child.getContentBox();\n                    if (index % 2) {\n                        downPart.push(child);\n                        child.setVertexIn(new kity.Point(cBox.left, cBox.top));\n                        child.setLayoutVectorIn(new kity.Vector(1, 1));\n                    } else {\n                        upPart.push(child);\n                        child.setVertexIn(new kity.Point(cBox.left, cBox.bottom));\n                        child.setLayoutVectorIn(new kity.Vector(1, -1));\n                    }\n                });\n                this.stack(upPart, "x");\n                this.stack(downPart, "x");\n                this.align(upPart, "bottom");\n                this.align(downPart, "top");\n                var xAdjust = pBox.right + pMarginRight + cMarginLeft;\n                var yAdjustUp = pBox.cy - cMarginBottom - parent.getStyle("margin-top");\n                var yAdjustDown = pBox.cy + cMarginTop + parent.getStyle("margin-bottom");\n                this.move(upPart, xAdjust, yAdjustUp);\n                this.move(downPart, xAdjust + cMarginLeft, yAdjustDown);\n            }\n        }));\n    }\n};\n\n//src/layout/fish-bone-slave.js\n/**\n * @fileOverview\n *\n *\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[39] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        Layout.register("fish-bone-slave", kity.createClass("FishBoneSlaveLayout", {\n            base: Layout,\n            doLayout: function(parent, children, round) {\n                var layout = this;\n                var abs = Math.abs;\n                var GOLD_CUT = 1 - .618;\n                var pBox = parent.getContentBox();\n                var vi = parent.getLayoutVectorIn();\n                parent.setLayoutVectorOut(vi);\n                var goldX = pBox.left + pBox.width * GOLD_CUT;\n                var pout = new kity.Point(goldX, vi.y > 0 ? pBox.bottom : pBox.top);\n                parent.setVertexOut(pout);\n                var child = children[0];\n                if (!child) return;\n                var cBox = child.getContentBox();\n                children.forEach(function(child, index) {\n                    child.setLayoutTransform(new kity.Matrix());\n                    child.setLayoutVectorIn(new kity.Vector(1, 0));\n                    child.setVertexIn(new kity.Point(cBox.left, cBox.cy));\n                });\n                this.stack(children, "y");\n                this.align(children, "left");\n                var xAdjust = 0, yAdjust = 0;\n                xAdjust += pout.x;\n                if (parent.getLayoutVectorOut().y < 0) {\n                    yAdjust -= this.getTreeBox(children).bottom;\n                    yAdjust += parent.getContentBox().top;\n                    yAdjust -= parent.getStyle("margin-top");\n                    yAdjust -= child.getStyle("margin-bottom");\n                } else {\n                    yAdjust += parent.getContentBox().bottom;\n                    yAdjust += parent.getStyle("margin-bottom");\n                    yAdjust += child.getStyle("margin-top");\n                }\n                this.move(children, xAdjust, yAdjust);\n                if (round == 2) {\n                    children.forEach(function(child) {\n                        var m = child.getLayoutTransform();\n                        var cbox = child.getContentBox();\n                        var pin = m.transformPoint(new kity.Point(cbox.left, 0));\n                        layout.move([ child ], abs(pin.y - pout.y), 0);\n                    });\n                }\n            }\n        }));\n    }\n};\n\n//src/layout/mind.js\n_p[40] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        var Minder = _p.r(19);\n        Layout.register("mind", kity.createClass({\n            base: Layout,\n            doLayout: function(node, children) {\n                var layout = this;\n                var half = Math.ceil(node.children.length / 2);\n                var right = [];\n                var left = [];\n                children.forEach(function(child) {\n                    if (child.getIndex() < half) right.push(child); else left.push(child);\n                });\n                var leftLayout = Minder.getLayoutInstance("left");\n                var rightLayout = Minder.getLayoutInstance("right");\n                leftLayout.doLayout(node, left);\n                rightLayout.doLayout(node, right);\n                var box = node.getContentBox();\n                node.setVertexOut(new kity.Point(box.cx, box.cy));\n                node.setLayoutVectorOut(new kity.Vector(0, 0));\n            },\n            getOrderHint: function(node) {\n                var hint = [];\n                var box = node.getLayoutBox();\n                var offset = 5;\n                hint.push({\n                    type: "up",\n                    node: node,\n                    area: new kity.Box({\n                        x: box.x,\n                        y: box.top - node.getStyle("margin-top") - offset,\n                        width: box.width,\n                        height: node.getStyle("margin-top")\n                    }),\n                    path: [ "M", box.x, box.top - offset, "L", box.right, box.top - offset ]\n                });\n                hint.push({\n                    type: "down",\n                    node: node,\n                    area: new kity.Box({\n                        x: box.x,\n                        y: box.bottom + offset,\n                        width: box.width,\n                        height: node.getStyle("margin-bottom")\n                    }),\n                    path: [ "M", box.x, box.bottom + offset, "L", box.right, box.bottom + offset ]\n                });\n                return hint;\n            }\n        }));\n    }\n};\n\n//src/layout/tianpan.js\n/**\n * @fileOverview\n *\n * 天盘模板\n *\n * @author: along\n * @copyright: bpd729@163.com, 2015\n */\n_p[41] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Layout = _p.r(18);\n        var Minder = _p.r(19);\n        Layout.register("tianpan", kity.createClass({\n            base: Layout,\n            doLayout: function(parent, children) {\n                if (children.length == 0) return;\n                var layout = this;\n                var pbox = parent.getContentBox();\n                var x, y, box;\n                var _theta = 5;\n                var _r = Math.max(pbox.width, 50);\n                children.forEach(function(child, index) {\n                    child.setLayoutTransform(new kity.Matrix());\n                    box = layout.getTreeBox(child);\n                    _r = Math.max(Math.max(box.width, box.height), _r);\n                });\n                _r = _r / 1.5 / Math.PI;\n                children.forEach(function(child, index) {\n                    x = _r * (Math.cos(_theta) + Math.sin(_theta) * _theta);\n                    y = _r * (Math.sin(_theta) - Math.cos(_theta) * _theta);\n                    _theta += .9 - index * .02;\n                    child.setLayoutVectorIn(new kity.Vector(1, 0));\n                    child.setVertexIn(new kity.Point(pbox.cx, pbox.cy));\n                    child.setLayoutTransform(new kity.Matrix());\n                    layout.move([ child ], x, y);\n                });\n            },\n            getOrderHint: function(node) {\n                var hint = [];\n                var box = node.getLayoutBox();\n                var offset = 5;\n                hint.push({\n                    type: "up",\n                    node: node,\n                    area: {\n                        x: box.x,\n                        y: box.top - node.getStyle("margin-top") - offset,\n                        width: box.width,\n                        height: node.getStyle("margin-top")\n                    },\n                    path: [ "M", box.x, box.top - offset, "L", box.right, box.top - offset ]\n                });\n                hint.push({\n                    type: "down",\n                    node: node,\n                    area: {\n                        x: box.x,\n                        y: box.bottom + offset,\n                        width: box.width,\n                        height: node.getStyle("margin-bottom")\n                    },\n                    path: [ "M", box.x, box.bottom + offset, "L", box.right, box.bottom + offset ]\n                });\n                return hint;\n            }\n        }));\n    }\n};\n\n//src/module/arrange.js\n_p[42] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        kity.extendClass(MinderNode, {\n            arrange: function(index) {\n                var parent = this.parent;\n                if (!parent) return;\n                var sibling = parent.children;\n                if (index < 0 || index >= sibling.length) return;\n                sibling.splice(this.getIndex(), 1);\n                sibling.splice(index, 0, this);\n                return this;\n            }\n        });\n        function asc(nodeA, nodeB) {\n            return nodeA.getIndex() - nodeB.getIndex();\n        }\n        function desc(nodeA, nodeB) {\n            return -asc(nodeA, nodeB);\n        }\n        function canArrange(km) {\n            var selected = km.getSelectedNode();\n            return selected && selected.parent && selected.parent.children.length > 1;\n        }\n        /**\n     * @command ArrangeUp\n     * @description 向上调整选中节点的位置\n     * @shortcut Alt + Up\n     * @state\n     *    0: 当前选中了具有相同父亲的节点\n     *   -1: 其它情况\n     */\n        var ArrangeUpCommand = kity.createClass("ArrangeUpCommand", {\n            base: Command,\n            execute: function(km) {\n                var nodes = km.getSelectedNodes();\n                nodes.sort(asc);\n                var lastIndexes = nodes.map(function(node) {\n                    return node.getIndex();\n                });\n                nodes.forEach(function(node, index) {\n                    node.arrange(lastIndexes[index] - 1);\n                });\n                km.layout(300);\n            },\n            queryState: function(km) {\n                var selected = km.getSelectedNode();\n                return selected ? 0 : -1;\n            }\n        });\n        /**\n     * @command ArrangeDown\n     * @description 向下调整选中节点的位置\n     * @shortcut Alt + Down\n     * @state\n     *    0: 当前选中了具有相同父亲的节点\n     *   -1: 其它情况\n     */\n        var ArrangeDownCommand = kity.createClass("ArrangeUpCommand", {\n            base: Command,\n            execute: function(km) {\n                var nodes = km.getSelectedNodes();\n                nodes.sort(desc);\n                var lastIndexes = nodes.map(function(node) {\n                    return node.getIndex();\n                });\n                nodes.forEach(function(node, index) {\n                    node.arrange(lastIndexes[index] + 1);\n                });\n                km.layout(300);\n            },\n            queryState: function(km) {\n                var selected = km.getSelectedNode();\n                return selected ? 0 : -1;\n            }\n        });\n        /**\n     * @command Arrange\n     * @description 调整选中节点的位置\n     * @param {number} index 调整后节点的新位置\n     * @state\n     *    0: 当前选中了具有相同父亲的节点\n     *   -1: 其它情况\n     */\n        var ArrangeCommand = kity.createClass("ArrangeCommand", {\n            base: Command,\n            execute: function(km, index) {\n                var nodes = km.getSelectedNodes().slice();\n                if (!nodes.length) return;\n                var ancestor = MinderNode.getCommonAncestor(nodes);\n                if (ancestor != nodes[0].parent) return;\n                var indexed = nodes.map(function(node) {\n                    return {\n                        index: node.getIndex(),\n                        node: node\n                    };\n                });\n                var asc = Math.min.apply(Math, indexed.map(function(one) {\n                    return one.index;\n                })) >= index;\n                indexed.sort(function(a, b) {\n                    return asc ? b.index - a.index : a.index - b.index;\n                });\n                indexed.forEach(function(one) {\n                    one.node.arrange(index);\n                });\n                km.layout(300);\n            },\n            queryState: function(km) {\n                var selected = km.getSelectedNode();\n                return selected ? 0 : -1;\n            }\n        });\n        Module.register("ArrangeModule", {\n            commands: {\n                arrangeup: ArrangeUpCommand,\n                arrangedown: ArrangeDownCommand,\n                arrange: ArrangeCommand\n            },\n            contextmenu: [ {\n                command: "arrangeup"\n            }, {\n                command: "arrangedown"\n            }, {\n                divider: true\n            } ],\n            commandShortcutKeys: {\n                arrangeup: "normal::alt+Up",\n                arrangedown: "normal::alt+Down"\n            }\n        });\n    }\n};\n\n//src/module/basestyle.js\n_p[43] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var TextRenderer = _p.r(61);\n        Module.register("basestylemodule", function() {\n            var km = this;\n            function getNodeDataOrStyle(node, name) {\n                return node.getData(name) || node.getStyle(name);\n            }\n            TextRenderer.registerStyleHook(function(node, textGroup) {\n                var fontWeight = getNodeDataOrStyle(node, "font-weight");\n                var fontStyle = getNodeDataOrStyle(node, "font-style");\n                var styleHash = [ fontWeight, fontStyle ].join("/");\n                textGroup.eachItem(function(index, item) {\n                    item.setFont({\n                        weight: fontWeight,\n                        style: fontStyle\n                    });\n                });\n            });\n            return {\n                commands: {\n                    /**\n                 * @command Bold\n                 * @description 加粗选中的节点\n                 * @shortcut Ctrl + B\n                 * @state\n                 *   0: 当前有选中的节点\n                 *  -1: 当前没有选中的节点\n                 *   1: 当前已选中的节点已加粗\n                 */\n                    bold: kity.createClass("boldCommand", {\n                        base: Command,\n                        execute: function(km) {\n                            var nodes = km.getSelectedNodes();\n                            if (this.queryState("bold") == 1) {\n                                nodes.forEach(function(n) {\n                                    n.setData("font-weight").render();\n                                });\n                            } else {\n                                nodes.forEach(function(n) {\n                                    n.setData("font-weight", "bold").render();\n                                });\n                            }\n                            km.layout();\n                        },\n                        queryState: function() {\n                            var nodes = km.getSelectedNodes(), result = 0;\n                            if (nodes.length === 0) {\n                                return -1;\n                            }\n                            nodes.forEach(function(n) {\n                                if (n && n.getData("font-weight")) {\n                                    result = 1;\n                                    return false;\n                                }\n                            });\n                            return result;\n                        }\n                    }),\n                    /**\n                 * @command Italic\n                 * @description 加斜选中的节点\n                 * @shortcut Ctrl + I\n                 * @state\n                 *   0: 当前有选中的节点\n                 *  -1: 当前没有选中的节点\n                 *   1: 当前已选中的节点已加斜\n                 */\n                    italic: kity.createClass("italicCommand", {\n                        base: Command,\n                        execute: function(km) {\n                            var nodes = km.getSelectedNodes();\n                            if (this.queryState("italic") == 1) {\n                                nodes.forEach(function(n) {\n                                    n.setData("font-style").render();\n                                });\n                            } else {\n                                nodes.forEach(function(n) {\n                                    n.setData("font-style", "italic").render();\n                                });\n                            }\n                            km.layout();\n                        },\n                        queryState: function() {\n                            var nodes = km.getSelectedNodes(), result = 0;\n                            if (nodes.length === 0) {\n                                return -1;\n                            }\n                            nodes.forEach(function(n) {\n                                if (n && n.getData("font-style")) {\n                                    result = 1;\n                                    return false;\n                                }\n                            });\n                            return result;\n                        }\n                    })\n                },\n                commandShortcutKeys: {\n                    bold: "ctrl+b",\n                    //bold\n                    italic: "ctrl+i"\n                }\n            };\n        });\n    }\n};\n\n//src/module/clipboard.js\n_p[44] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        Module.register("ClipboardModule", function() {\n            var km = this, _clipboardNodes = [], _selectedNodes = [];\n            function appendChildNode(parent, child) {\n                _selectedNodes.push(child);\n                km.appendNode(child, parent);\n                child.render();\n                child.setLayoutOffset(null);\n                var children = child.children.map(function(node) {\n                    return node.clone();\n                });\n                /*\n            * fixed bug: Modified on 2015.08.05\n            * 原因：粘贴递归 append 时没有清空原来父节点的子节点，而父节点被复制的时候，是连同子节点一起复制过来的\n            * 解决办法：增加了下面这一行代码\n            * by: @zhangbobell zhangbobell@163.com\n            */\n                child.clearChildren();\n                for (var i = 0, ci; ci = children[i]; i++) {\n                    appendChildNode(child, ci);\n                }\n            }\n            function sendToClipboard(nodes) {\n                if (!nodes.length) return;\n                nodes.sort(function(a, b) {\n                    return a.getIndex() - b.getIndex();\n                });\n                _clipboardNodes = nodes.map(function(node) {\n                    return node.clone();\n                });\n            }\n            /**\n         * @command Copy\n         * @description 复制当前选中的节点\n         * @shortcut Ctrl + C\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         */\n            var CopyCommand = kity.createClass("CopyCommand", {\n                base: Command,\n                execute: function(km) {\n                    sendToClipboard(km.getSelectedAncestors(true));\n                    this.setContentChanged(false);\n                }\n            });\n            /**\n         * @command Cut\n         * @description 剪切当前选中的节点\n         * @shortcut Ctrl + X\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         */\n            var CutCommand = kity.createClass("CutCommand", {\n                base: Command,\n                execute: function(km) {\n                    var ancestors = km.getSelectedAncestors();\n                    if (ancestors.length === 0) return;\n                    sendToClipboard(ancestors);\n                    km.select(MinderNode.getCommonAncestor(ancestors), true);\n                    ancestors.slice().forEach(function(node) {\n                        km.removeNode(node);\n                    });\n                    km.layout(300);\n                }\n            });\n            /**\n         * @command Paste\n         * @description 粘贴已复制的节点到每一个当前选中的节点上\n         * @shortcut Ctrl + V\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         */\n            var PasteCommand = kity.createClass("PasteCommand", {\n                base: Command,\n                execute: function(km) {\n                    if (_clipboardNodes.length) {\n                        var nodes = km.getSelectedNodes();\n                        if (!nodes.length) return;\n                        for (var i = 0, ni; ni = _clipboardNodes[i]; i++) {\n                            for (var j = 0, node; node = nodes[j]; j++) {\n                                appendChildNode(node, ni.clone());\n                            }\n                        }\n                        km.select(_selectedNodes, true);\n                        _selectedNodes = [];\n                        km.layout(300);\n                    }\n                },\n                queryState: function(km) {\n                    return km.getSelectedNode() ? 0 : -1;\n                }\n            });\n            /**\n         * @Desc: 若支持原生clipboadr事件则基于原生扩展，否则使用km的基础事件只处理节点的粘贴复制\n         * @Editor: Naixor\n         * @Date: 2015.9.20\n         */\n            if (km.supportClipboardEvent && !kity.Browser.gecko) {\n                var Copy = function(e) {\n                    this.fire("beforeCopy", e);\n                };\n                var Cut = function(e) {\n                    this.fire("beforeCut", e);\n                };\n                var Paste = function(e) {\n                    this.fire("beforePaste", e);\n                };\n                return {\n                    commands: {\n                        copy: CopyCommand,\n                        cut: CutCommand,\n                        paste: PasteCommand\n                    },\n                    clipBoardEvents: {\n                        copy: Copy.bind(km),\n                        cut: Cut.bind(km),\n                        paste: Paste.bind(km)\n                    },\n                    sendToClipboard: sendToClipboard\n                };\n            } else {\n                return {\n                    commands: {\n                        copy: CopyCommand,\n                        cut: CutCommand,\n                        paste: PasteCommand\n                    },\n                    commandShortcutKeys: {\n                        copy: "normal::ctrl+c|",\n                        cut: "normal::ctrl+x",\n                        paste: "normal::ctrl+v"\n                    },\n                    sendToClipboard: sendToClipboard\n                };\n            }\n        });\n    }\n};\n\n//src/module/dragtree.js\n_p[45] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        // 矩形的变形动画定义\n        var MoveToParentCommand = kity.createClass("MoveToParentCommand", {\n            base: Command,\n            execute: function(minder, nodes, parent) {\n                var node;\n                for (var i = 0; i < nodes.length; i++) {\n                    node = nodes[i];\n                    if (node.parent) {\n                        node.parent.removeChild(node);\n                        parent.appendChild(node);\n                        node.render();\n                    }\n                }\n                parent.expand();\n                minder.select(nodes, true);\n            }\n        });\n        var DropHinter = kity.createClass("DropHinter", {\n            base: kity.Group,\n            constructor: function() {\n                this.callBase();\n                this.rect = new kity.Rect();\n                this.addShape(this.rect);\n            },\n            render: function(target) {\n                this.setVisible(!!target);\n                if (target) {\n                    this.rect.setBox(target.getLayoutBox()).setRadius(target.getStyle("radius") || 0).stroke(target.getStyle("drop-hint-color") || "yellow", target.getStyle("drop-hint-width") || 2);\n                    this.bringTop();\n                }\n            }\n        });\n        var OrderHinter = kity.createClass("OrderHinter", {\n            base: kity.Group,\n            constructor: function() {\n                this.callBase();\n                this.area = new kity.Rect();\n                this.path = new kity.Path();\n                this.addShapes([ this.area, this.path ]);\n            },\n            render: function(hint) {\n                this.setVisible(!!hint);\n                if (hint) {\n                    this.area.setBox(hint.area);\n                    this.area.fill(hint.node.getStyle("order-hint-area-color") || "rgba(0, 255, 0, .5)");\n                    this.path.setPathData(hint.path);\n                    this.path.stroke(hint.node.getStyle("order-hint-path-color") || "#0f0", hint.node.getStyle("order-hint-path-width") || 1);\n                }\n            }\n        });\n        // 对拖动对象的一个替代盒子，控制整个拖放的逻辑，包括：\n        //    1. 从节点列表计算出拖动部分\n        //    2. 计算可以 drop 的节点，产生 drop 交互提示\n        var TreeDragger = kity.createClass("TreeDragger", {\n            constructor: function(minder) {\n                this._minder = minder;\n                this._dropHinter = new DropHinter();\n                this._orderHinter = new OrderHinter();\n                minder.getRenderContainer().addShapes([ this._dropHinter, this._orderHinter ]);\n            },\n            dragStart: function(position) {\n                // 只记录开始位置，不马上开启拖放模式\n                // 这个位置同时是拖放范围收缩时的焦点位置（中心）\n                this._startPosition = position;\n            },\n            dragMove: function(position) {\n                // 启动拖放模式需要最小的移动距离\n                var DRAG_MOVE_THRESHOLD = 10;\n                if (!this._startPosition) return;\n                var movement = kity.Vector.fromPoints(this._dragPosition || this._startPosition, position);\n                var minder = this._minder;\n                this._dragPosition = position;\n                if (!this._dragMode) {\n                    // 判断拖放模式是否该启动\n                    if (kity.Vector.fromPoints(this._dragPosition, this._startPosition).length() < DRAG_MOVE_THRESHOLD) {\n                        return;\n                    }\n                    if (!this._enterDragMode()) {\n                        return;\n                    }\n                }\n                for (var i = 0; i < this._dragSources.length; i++) {\n                    this._dragSources[i].setLayoutOffset(this._dragSources[i].getLayoutOffset().offset(movement));\n                    minder.applyLayoutResult(this._dragSources[i]);\n                }\n                if (!this._dropTest()) {\n                    this._orderTest();\n                } else {\n                    this._renderOrderHint(this._orderSucceedHint = null);\n                }\n            },\n            dragEnd: function() {\n                this._startPosition = null;\n                this._dragPosition = null;\n                if (!this._dragMode) {\n                    return;\n                }\n                this._fadeDragSources(1);\n                if (this._dropSucceedTarget) {\n                    this._dragSources.forEach(function(source) {\n                        source.setLayoutOffset(null);\n                    });\n                    this._minder.layout(-1);\n                    this._minder.execCommand("movetoparent", this._dragSources, this._dropSucceedTarget);\n                } else if (this._orderSucceedHint) {\n                    var hint = this._orderSucceedHint;\n                    var index = hint.node.getIndex();\n                    var sourceIndexes = this._dragSources.map(function(source) {\n                        // 顺便干掉布局偏移\n                        source.setLayoutOffset(null);\n                        return source.getIndex();\n                    });\n                    var maxIndex = Math.max.apply(Math, sourceIndexes);\n                    var minIndex = Math.min.apply(Math, sourceIndexes);\n                    if (index < minIndex && hint.type == "down") index++;\n                    if (index > maxIndex && hint.type == "up") index--;\n                    hint.node.setLayoutOffset(null);\n                    this._minder.execCommand("arrange", index);\n                    this._renderOrderHint(null);\n                } else {\n                    this._minder.fire("savescene");\n                }\n                this._minder.layout(300);\n                this._leaveDragMode();\n                this._minder.fire("contentchange");\n            },\n            // 进入拖放模式：\n            //    1. 计算拖放源和允许的拖放目标\n            //    2. 标记已启动\n            _enterDragMode: function() {\n                this._calcDragSources();\n                if (!this._dragSources.length) {\n                    this._startPosition = null;\n                    return false;\n                }\n                this._fadeDragSources(.5);\n                this._calcDropTargets();\n                this._calcOrderHints();\n                this._dragMode = true;\n                this._minder.setStatus("dragtree");\n                return true;\n            },\n            // 从选中的节点计算拖放源\n            //    并不是所有选中的节点都作为拖放源，如果选中节点中存在 A 和 B，\n            //    并且 A 是 B 的祖先，则 B 不作为拖放源\n            //\n            //    计算过程：\n            //       1. 将节点按照树高排序，排序后只可能是前面节点是后面节点的祖先\n            //       2. 从后往前枚举排序的结果，如果发现枚举目标之前存在其祖先，\n            //          则排除枚举目标作为拖放源，否则加入拖放源\n            _calcDragSources: function() {\n                this._dragSources = this._minder.getSelectedAncestors();\n            },\n            _fadeDragSources: function(opacity) {\n                var minder = this._minder;\n                this._dragSources.forEach(function(source) {\n                    source.getRenderContainer().setOpacity(opacity, 200);\n                    source.traverse(function(node) {\n                        if (opacity < 1) {\n                            minder.detachNode(node);\n                        } else {\n                            minder.attachNode(node);\n                        }\n                    }, true);\n                });\n            },\n            // 计算拖放目标可以释放的节点列表（释放意味着成为其子树），存在这条限制规则：\n            //    - 不能拖放到拖放目标的子树上（允许拖放到自身，因为多选的情况下可以把其它节点加入）\n            //\n            //    1. 加入当前节点（初始为根节点）到允许列表\n            //    2. 对于当前节点的每一个子节点：\n            //       (1) 如果是拖放目标的其中一个节点，忽略（整棵子树被剪枝）\n            //       (2) 如果不是拖放目标之一，以当前子节点为当前节点，回到 1 计算\n            //    3. 返回允许列表\n            //\n            _calcDropTargets: function() {\n                function findAvailableParents(nodes, root) {\n                    var availables = [], i;\n                    availables.push(root);\n                    root.getChildren().forEach(function(test) {\n                        for (i = 0; i < nodes.length; i++) {\n                            if (nodes[i] == test) return;\n                        }\n                        availables = availables.concat(findAvailableParents(nodes, test));\n                    });\n                    return availables;\n                }\n                this._dropTargets = findAvailableParents(this._dragSources, this._minder.getRoot());\n                this._dropTargetBoxes = this._dropTargets.map(function(source) {\n                    return source.getLayoutBox();\n                });\n            },\n            _calcOrderHints: function() {\n                var sources = this._dragSources;\n                var ancestor = MinderNode.getCommonAncestor(sources);\n                // 只有一个元素选中，公共祖先是其父\n                if (ancestor == sources[0]) ancestor = sources[0].parent;\n                if (sources.length === 0 || ancestor != sources[0].parent) {\n                    this._orderHints = [];\n                    return;\n                }\n                var siblings = ancestor.children;\n                this._orderHints = siblings.reduce(function(hint, sibling) {\n                    if (sources.indexOf(sibling) == -1) {\n                        hint = hint.concat(sibling.getOrderHint());\n                    }\n                    return hint;\n                }, []);\n            },\n            _leaveDragMode: function() {\n                this._dragMode = false;\n                this._dropSucceedTarget = null;\n                this._orderSucceedHint = null;\n                this._renderDropHint(null);\n                this._renderOrderHint(null);\n                this._minder.rollbackStatus();\n            },\n            _drawForDragMode: function() {\n                this._text.setContent(this._dragSources.length + " items");\n                this._text.setPosition(this._startPosition.x, this._startPosition.y + 5);\n                this._minder.getRenderContainer().addShape(this);\n            },\n            /**\n         * 通过 judge 函数判断 targetBox 和 sourceBox 的位置交叉关系\n         * @param targets -- 目标节点\n         * @param targetBoxMapper -- 目标节点与对应 Box 的映射关系\n         * @param judge -- 判断函数\n         * @returns {*}\n         * @private\n         */\n            _boxTest: function(targets, targetBoxMapper, judge) {\n                var sourceBoxes = this._dragSources.map(function(source) {\n                    return source.getLayoutBox();\n                });\n                var i, j, target, sourceBox, targetBox;\n                judge = judge || function(intersectBox, sourceBox, targetBox) {\n                    return intersectBox && !intersectBox.isEmpty();\n                };\n                for (i = 0; i < targets.length; i++) {\n                    target = targets[i];\n                    targetBox = targetBoxMapper.call(this, target, i);\n                    for (j = 0; j < sourceBoxes.length; j++) {\n                        sourceBox = sourceBoxes[j];\n                        var intersectBox = sourceBox.intersect(targetBox);\n                        if (judge(intersectBox, sourceBox, targetBox)) {\n                            return target;\n                        }\n                    }\n                }\n                return null;\n            },\n            _dropTest: function() {\n                this._dropSucceedTarget = this._boxTest(this._dropTargets, function(target, i) {\n                    return this._dropTargetBoxes[i];\n                }, function(intersectBox, sourceBox, targetBox) {\n                    function area(box) {\n                        return box.width * box.height;\n                    }\n                    if (!intersectBox) return false;\n                    /*\n                * Added by zhangbobell, 2015.9.8\n                *\n                * 增加了下面一行判断，修复了循环比较中 targetBox 为折叠节点时，intersetBox 面积为 0，\n                * 而 targetBox 的 width 和 height 均为 0\n                * 此时造成了满足以下的第二个条件而返回 true\n                * */\n                    if (!area(intersectBox)) return false;\n                    // 面积判断，交叉面积大于其中的一半\n                    if (area(intersectBox) > .5 * Math.min(area(sourceBox), area(targetBox))) return true;\n                    // 有一个边完全重合的情况，也认为两个是交叉的\n                    if (intersectBox.width + 1 >= Math.min(sourceBox.width, targetBox.width)) return true;\n                    if (intersectBox.height + 1 >= Math.min(sourceBox.height, targetBox.height)) return true;\n                    return false;\n                });\n                this._renderDropHint(this._dropSucceedTarget);\n                return !!this._dropSucceedTarget;\n            },\n            _orderTest: function() {\n                this._orderSucceedHint = this._boxTest(this._orderHints, function(hint) {\n                    return hint.area;\n                });\n                this._renderOrderHint(this._orderSucceedHint);\n                return !!this._orderSucceedHint;\n            },\n            _renderDropHint: function(target) {\n                this._dropHinter.render(target);\n            },\n            _renderOrderHint: function(hint) {\n                this._orderHinter.render(hint);\n            },\n            preventDragMove: function() {\n                this._startPosition = null;\n            }\n        });\n        Module.register("DragTree", function() {\n            var dragger;\n            return {\n                init: function() {\n                    dragger = new TreeDragger(this);\n                    window.addEventListener("mouseup", function() {\n                        dragger.dragEnd();\n                    });\n                },\n                events: {\n                    "normal.mousedown inputready.mousedown": function(e) {\n                        // 单选中根节点也不触发拖拽\n                        if (e.originEvent.button) return;\n                        if (e.getTargetNode() && e.getTargetNode() != this.getRoot()) {\n                            dragger.dragStart(e.getPosition());\n                        }\n                    },\n                    "normal.mousemove dragtree.mousemove": function(e) {\n                        dragger.dragMove(e.getPosition());\n                    },\n                    "normal.mouseup dragtree.beforemouseup": function(e) {\n                        dragger.dragEnd();\n                        //e.stopPropagation();\n                        e.preventDefault();\n                    },\n                    statuschange: function(e) {\n                        if (e.lastStatus == "textedit" && e.currentStatus == "normal") {\n                            dragger.preventDragMove();\n                        }\n                    }\n                },\n                commands: {\n                    movetoparent: MoveToParentCommand\n                }\n            };\n        });\n    }\n};\n\n//src/module/expand.js\n_p[46] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var keymap = _p.r(15);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("Expand", function() {\n            var minder = this;\n            var EXPAND_STATE_DATA = "expandState", STATE_EXPAND = "expand", STATE_COLLAPSE = "collapse";\n            // 将展开的操作和状态读取接口拓展到 MinderNode 上\n            kity.extendClass(MinderNode, {\n                /**\n             * 展开节点\n             * @param  {Policy} policy 展开的策略，默认为 KEEP_STATE\n             */\n                expand: function() {\n                    this.setData(EXPAND_STATE_DATA, STATE_EXPAND);\n                    return this;\n                },\n                /**\n             * 收起节点\n             */\n                collapse: function() {\n                    this.setData(EXPAND_STATE_DATA, STATE_COLLAPSE);\n                    return this;\n                },\n                /**\n             * 判断节点当前的状态是否为展开\n             */\n                isExpanded: function() {\n                    var expanded = this.getData(EXPAND_STATE_DATA) !== STATE_COLLAPSE;\n                    return expanded && (this.isRoot() || this.parent.isExpanded());\n                },\n                /**\n             * 判断节点当前的状态是否为收起\n             */\n                isCollapsed: function() {\n                    return !this.isExpanded();\n                }\n            });\n            /**\n         * @command Expand\n         * @description 展开当前选中的节点，保证其可见\n         * @param {bool} justParents 是否只展开到父亲\n         *     * `false` - （默认）保证选中的节点以及其子树可见\n         *     * `true` - 只保证选中的节点可见，不展开其子树\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         */\n            var ExpandCommand = kity.createClass("ExpandCommand", {\n                base: Command,\n                execute: function(km, justParents) {\n                    var node = km.getSelectedNode();\n                    if (!node) return;\n                    if (justParents) {\n                        node = node.parent;\n                    }\n                    while (node.parent) {\n                        node.expand();\n                        node = node.parent;\n                    }\n                    node.renderTree();\n                    km.layout(100);\n                },\n                queryState: function(km) {\n                    var node = km.getSelectedNode();\n                    return node && !node.isRoot() && !node.isExpanded() ? 0 : -1;\n                }\n            });\n            /**\n         * @command ExpandToLevel\n         * @description 展开脑图到指定的层级\n         * @param {number} level 指定展开到的层级，最少值为 1。\n         * @state\n         *   0: 一直可用\n         */\n            var ExpandToLevelCommand = kity.createClass("ExpandToLevelCommand", {\n                base: Command,\n                execute: function(km, level) {\n                    km.getRoot().traverse(function(node) {\n                        if (node.getLevel() < level) node.expand();\n                        if (node.getLevel() == level && !node.isLeaf()) node.collapse();\n                    });\n                    km.refresh(100);\n                },\n                enableReadOnly: true\n            });\n            /**\n         * @command Collapse\n         * @description 收起当前节点的子树\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         */\n            var CollapseCommand = kity.createClass("CollapseCommand", {\n                base: Command,\n                execute: function(km) {\n                    var node = km.getSelectedNode();\n                    if (!node) return;\n                    node.collapse();\n                    node.renderTree();\n                    km.layout();\n                },\n                queryState: function(km) {\n                    var node = km.getSelectedNode();\n                    return node && !node.isRoot() && node.isExpanded() ? 0 : -1;\n                }\n            });\n            var Expander = kity.createClass("Expander", {\n                base: kity.Group,\n                constructor: function(node) {\n                    this.callBase();\n                    this.radius = 6;\n                    this.outline = new kity.Circle(this.radius).stroke("gray").fill("white");\n                    this.sign = new kity.Path().stroke("gray");\n                    this.addShapes([ this.outline, this.sign ]);\n                    this.initEvent(node);\n                    this.setId(utils.uuid("node_expander"));\n                    this.setStyle("cursor", "pointer");\n                },\n                initEvent: function(node) {\n                    this.on("mousedown", function(e) {\n                        minder.select([ node ], true);\n                        if (node.isExpanded()) {\n                            node.collapse();\n                        } else {\n                            node.expand();\n                        }\n                        node.renderTree().getMinder().layout(100);\n                        node.getMinder().fire("contentchange");\n                        e.stopPropagation();\n                        e.preventDefault();\n                    });\n                    this.on("dblclick click mouseup", function(e) {\n                        e.stopPropagation();\n                        e.preventDefault();\n                    });\n                },\n                setState: function(state) {\n                    if (state == "hide") {\n                        this.setVisible(false);\n                        return;\n                    }\n                    this.setVisible(true);\n                    var pathData = [ "M", 1.5 - this.radius, 0, "L", this.radius - 1.5, 0 ];\n                    if (state == STATE_COLLAPSE) {\n                        pathData.push([ "M", 0, 1.5 - this.radius, "L", 0, this.radius - 1.5 ]);\n                    }\n                    this.sign.setPathData(pathData);\n                }\n            });\n            var ExpanderRenderer = kity.createClass("ExpanderRenderer", {\n                base: Renderer,\n                create: function(node) {\n                    if (node.isRoot()) return;\n                    this.expander = new Expander(node);\n                    node.getRenderContainer().prependShape(this.expander);\n                    node.expanderRenderer = this;\n                    this.node = node;\n                    return this.expander;\n                },\n                shouldRender: function(node) {\n                    return !node.isRoot();\n                },\n                update: function(expander, node, box) {\n                    if (!node.parent) return;\n                    var visible = node.parent.isExpanded();\n                    expander.setState(visible && node.children.length ? node.getData(EXPAND_STATE_DATA) : "hide");\n                    var vector = node.getLayoutVectorIn().normalize(expander.radius + node.getStyle("stroke-width"));\n                    var position = node.getVertexIn().offset(vector.reverse());\n                    this.expander.setTranslate(position);\n                }\n            });\n            return {\n                commands: {\n                    expand: ExpandCommand,\n                    expandtolevel: ExpandToLevelCommand,\n                    collapse: CollapseCommand\n                },\n                events: {\n                    layoutapply: function(e) {\n                        var r = e.node.getRenderer("ExpanderRenderer");\n                        if (r.getRenderShape()) {\n                            r.update(r.getRenderShape(), e.node);\n                        }\n                    },\n                    beforerender: function(e) {\n                        var node = e.node;\n                        var visible = !node.parent || node.parent.isExpanded();\n                        var minder = this;\n                        node.getRenderContainer().setVisible(visible);\n                        if (!visible) e.stopPropagation();\n                    },\n                    "normal.keydown": function(e) {\n                        if (this.getStatus() == "textedit") return;\n                        if (e.originEvent.keyCode == keymap["/"]) {\n                            var node = this.getSelectedNode();\n                            if (!node || node == this.getRoot()) return;\n                            var expanded = node.isExpanded();\n                            this.getSelectedNodes().forEach(function(node) {\n                                if (expanded) node.collapse(); else node.expand();\n                                node.renderTree();\n                            });\n                            this.layout(100);\n                            this.fire("contentchange");\n                            e.preventDefault();\n                            e.stopPropagationImmediately();\n                        }\n                        if (e.isShortcutKey("Alt+`")) {\n                            this.execCommand("expandtolevel", 9999);\n                        }\n                        for (var i = 1; i < 6; i++) {\n                            if (e.isShortcutKey("Alt+" + i)) {\n                                this.execCommand("expandtolevel", i);\n                            }\n                        }\n                    }\n                },\n                renderers: {\n                    outside: ExpanderRenderer\n                },\n                contextmenu: [ {\n                    command: "expandtoleaf",\n                    query: function() {\n                        return !minder.getSelectedNode();\n                    },\n                    fn: function(minder) {\n                        minder.execCommand("expandtolevel", 9999);\n                    }\n                }, {\n                    command: "expandtolevel1",\n                    query: function() {\n                        return !minder.getSelectedNode();\n                    },\n                    fn: function(minder) {\n                        minder.execCommand("expandtolevel", 1);\n                    }\n                }, {\n                    command: "expandtolevel2",\n                    query: function() {\n                        return !minder.getSelectedNode();\n                    },\n                    fn: function(minder) {\n                        minder.execCommand("expandtolevel", 2);\n                    }\n                }, {\n                    command: "expandtolevel3",\n                    query: function() {\n                        return !minder.getSelectedNode();\n                    },\n                    fn: function(minder) {\n                        minder.execCommand("expandtolevel", 3);\n                    }\n                }, {\n                    divider: true\n                } ]\n            };\n        });\n    }\n};\n\n//src/module/font.js\n_p[47] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var TextRenderer = _p.r(61);\n        function getNodeDataOrStyle(node, name) {\n            return node.getData(name) || node.getStyle(name);\n        }\n        TextRenderer.registerStyleHook(function(node, textGroup) {\n            var dataColor = node.getData("color");\n            var selectedColor = node.getStyle("selected-color");\n            var styleColor = node.getStyle("color");\n            var foreColor = dataColor || (node.isSelected() && selectedColor ? selectedColor : styleColor);\n            var fontFamily = getNodeDataOrStyle(node, "font-family");\n            var fontSize = getNodeDataOrStyle(node, "font-size");\n            textGroup.fill(foreColor);\n            textGroup.eachItem(function(index, item) {\n                item.setFont({\n                    family: fontFamily,\n                    size: fontSize\n                });\n            });\n        });\n        Module.register("fontmodule", {\n            commands: {\n                /**\n             * @command ForeColor\n             * @description 设置选中节点的字体颜色\n             * @param {string} color 表示颜色的字符串\n             * @state\n             *   0: 当前有选中的节点\n             *  -1: 当前没有选中的节点\n             * @return 如果只有一个节点选中，返回已选中节点的字体颜色；否则返回 \'mixed\'。\n             */\n                forecolor: kity.createClass("fontcolorCommand", {\n                    base: Command,\n                    execute: function(km, color) {\n                        var nodes = km.getSelectedNodes();\n                        nodes.forEach(function(n) {\n                            n.setData("color", color);\n                            n.render();\n                        });\n                    },\n                    queryState: function(km) {\n                        return km.getSelectedNodes().length === 0 ? -1 : 0;\n                    },\n                    queryValue: function(km) {\n                        if (km.getSelectedNodes().length == 1) {\n                            return km.getSelectedNodes()[0].getData("color");\n                        }\n                        return "mixed";\n                    }\n                }),\n                /**\n             * @command Background\n             * @description 设置选中节点的背景颜色\n             * @param {string} color 表示颜色的字符串\n             * @state\n             *   0: 当前有选中的节点\n             *  -1: 当前没有选中的节点\n             * @return 如果只有一个节点选中，返回已选中节点的背景颜色；否则返回 \'mixed\'。\n             */\n                background: kity.createClass("backgroudCommand", {\n                    base: Command,\n                    execute: function(km, color) {\n                        var nodes = km.getSelectedNodes();\n                        nodes.forEach(function(n) {\n                            n.setData("background", color);\n                            n.render();\n                        });\n                    },\n                    queryState: function(km) {\n                        return km.getSelectedNodes().length === 0 ? -1 : 0;\n                    },\n                    queryValue: function(km) {\n                        if (km.getSelectedNodes().length == 1) {\n                            return km.getSelectedNodes()[0].getData("background");\n                        }\n                        return "mixed";\n                    }\n                }),\n                /**\n             * @command FontFamily\n             * @description 设置选中节点的字体\n             * @param {string} family 表示字体的字符串\n             * @state\n             *   0: 当前有选中的节点\n             *  -1: 当前没有选中的节点\n             * @return 返回首个选中节点的字体\n             */\n                fontfamily: kity.createClass("fontfamilyCommand", {\n                    base: Command,\n                    execute: function(km, family) {\n                        var nodes = km.getSelectedNodes();\n                        nodes.forEach(function(n) {\n                            n.setData("font-family", family);\n                            n.render();\n                            km.layout();\n                        });\n                    },\n                    queryState: function(km) {\n                        return km.getSelectedNodes().length === 0 ? -1 : 0;\n                    },\n                    queryValue: function(km) {\n                        var node = km.getSelectedNode();\n                        if (node) return node.getData("font-family");\n                        return null;\n                    }\n                }),\n                /**\n             * @command FontSize\n             * @description 设置选中节点的字体大小\n             * @param {number} size 字体大小（px）\n             * @state\n             *   0: 当前有选中的节点\n             *  -1: 当前没有选中的节点\n             * @return 返回首个选中节点的字体大小\n             */\n                fontsize: kity.createClass("fontsizeCommand", {\n                    base: Command,\n                    execute: function(km, size) {\n                        var nodes = km.getSelectedNodes();\n                        nodes.forEach(function(n) {\n                            n.setData("font-size", size);\n                            n.render();\n                            km.layout(300);\n                        });\n                    },\n                    queryState: function(km) {\n                        return km.getSelectedNodes().length === 0 ? -1 : 0;\n                    },\n                    queryValue: function(km) {\n                        var node = km.getSelectedNode();\n                        if (node) return node.getData("font-size");\n                        return null;\n                    }\n                })\n            }\n        });\n    }\n};\n\n//src/module/hyperlink.js\n_p[48] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        // jscs:disable maximumLineLength\n        var linkShapePath = "M16.614,10.224h-1.278c-1.668,0-3.07-1.07-3.599-2.556h4.877c0.707,0,1.278-0.571,1.278-1.278V3.834 c0-0.707-0.571-1.278-1.278-1.278h-4.877C12.266,1.071,13.668,0,15.336,0h1.278c2.116,0,3.834,1.716,3.834,3.834V6.39 C20.448,8.508,18.73,10.224,16.614,10.224z M5.112,5.112c0-0.707,0.573-1.278,1.278-1.278h7.668c0.707,0,1.278,0.571,1.278,1.278 S14.765,6.39,14.058,6.39H6.39C5.685,6.39,5.112,5.819,5.112,5.112z M2.556,3.834V6.39c0,0.707,0.573,1.278,1.278,1.278h4.877 c-0.528,1.486-1.932,2.556-3.599,2.556H3.834C1.716,10.224,0,8.508,0,6.39V3.834C0,1.716,1.716,0,3.834,0h1.278 c1.667,0,3.071,1.071,3.599,2.556H3.834C3.129,2.556,2.556,3.127,2.556,3.834z";\n        Module.register("hyperlink", {\n            commands: {\n                /**\n             * @command HyperLink\n             * @description 为选中的节点添加超链接\n             * @param {string} url 超链接的 URL，设置为 null 移除\n             * @param {string} title 超链接的说明\n             * @state\n             *   0: 当前有选中的节点\n             *  -1: 当前没有选中的节点\n             * @return 返回首个选中节点的超链接信息，JSON 对象： `{url: url, title: title}`\n             */\n                hyperlink: kity.createClass("hyperlink", {\n                    base: Command,\n                    execute: function(km, url, title) {\n                        var nodes = km.getSelectedNodes();\n                        nodes.forEach(function(n) {\n                            n.setData("hyperlink", url);\n                            n.setData("hyperlinkTitle", url && title);\n                            n.render();\n                        });\n                        km.layout();\n                    },\n                    queryState: function(km) {\n                        var nodes = km.getSelectedNodes(), result = 0;\n                        if (nodes.length === 0) {\n                            return -1;\n                        }\n                        nodes.forEach(function(n) {\n                            if (n && n.getData("hyperlink")) {\n                                result = 0;\n                                return false;\n                            }\n                        });\n                        return result;\n                    },\n                    queryValue: function(km) {\n                        var node = km.getSelectedNode();\n                        return {\n                            url: node.getData("hyperlink"),\n                            title: node.getData("hyperlinkTitle")\n                        };\n                    }\n                })\n            },\n            renderers: {\n                right: kity.createClass("hyperlinkrender", {\n                    base: Renderer,\n                    create: function() {\n                        var link = new kity.HyperLink();\n                        var linkshape = new kity.Path();\n                        var outline = new kity.Rect(24, 22, -2, -6, 4).fill("rgba(255, 255, 255, 0)");\n                        linkshape.setPathData(linkShapePath).fill("#666");\n                        link.addShape(outline);\n                        link.addShape(linkshape);\n                        link.setTarget("_blank");\n                        link.setStyle("cursor", "pointer");\n                        link.on("mouseover", function() {\n                            outline.fill("rgba(255, 255, 200, .8)");\n                        }).on("mouseout", function() {\n                            outline.fill("rgba(255, 255, 255, 0)");\n                        });\n                        return link;\n                    },\n                    shouldRender: function(node) {\n                        return node.getData("hyperlink");\n                    },\n                    update: function(link, node, box) {\n                        var href = node.getData("hyperlink");\n                        link.setHref("#");\n                        var allowed = [ "^http:", "^https:", "^ftp:", "^mailto:" ];\n                        for (var i = 0; i < allowed.length; i++) {\n                            var regex = new RegExp(allowed[i]);\n                            if (regex.test(href)) {\n                                link.setHref(href);\n                                break;\n                            }\n                        }\n                        var title = node.getData("hyperlinkTitle");\n                        if (title) {\n                            title = [ title, "(", href, ")" ].join("");\n                        } else {\n                            title = href;\n                        }\n                        link.node.setAttributeNS("http://www.w3.org/1999/xlink", "title", title);\n                        var spaceRight = node.getStyle("space-right");\n                        link.setTranslate(box.right + spaceRight + 2, -5);\n                        return new kity.Box({\n                            x: box.right + spaceRight,\n                            y: -11,\n                            width: 24,\n                            height: 22\n                        });\n                    }\n                })\n            }\n        });\n    }\n};\n\n//src/module/image-viewer.js\n_p[49] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var keymap = _p.r(15);\n        var Module = _p.r(20);\n        var Command = _p.r(9);\n        Module.register("ImageViewer", function() {\n            function createEl(name, classNames, children) {\n                var el = document.createElement(name);\n                addClass(el, classNames);\n                children && children.length && children.forEach(function(child) {\n                    el.appendChild(child);\n                });\n                return el;\n            }\n            function on(el, event, handler) {\n                el.addEventListener(event, handler);\n            }\n            function addClass(el, classNames) {\n                classNames && classNames.split(" ").forEach(function(className) {\n                    el.classList.add(className);\n                });\n            }\n            function removeClass(el, classNames) {\n                classNames && classNames.split(" ").forEach(function(className) {\n                    el.classList.remove(className);\n                });\n            }\n            var ImageViewer = kity.createClass("ImageViewer", {\n                constructor: function() {\n                    var btnClose = createEl("button", "km-image-viewer-btn km-image-viewer-close");\n                    var btnSource = createEl("button", "km-image-viewer-btn km-image-viewer-source");\n                    var image = this.image = createEl("img");\n                    var toolbar = this.toolbar = createEl("div", "km-image-viewer-toolbar", [ btnSource, btnClose ]);\n                    var container = createEl("div", "km-image-viewer-container", [ image ]);\n                    var viewer = this.viewer = createEl("div", "km-image-viewer", [ toolbar, container ]);\n                    this.hotkeyHandler = this.hotkeyHandler.bind(this);\n                    on(btnClose, "click", this.close.bind(this));\n                    on(btnSource, "click", this.viewSource.bind(this));\n                    on(image, "click", this.zoomImage.bind(this));\n                    on(viewer, "contextmenu", this.toggleToolbar.bind(this));\n                    on(document, "keydown", this.hotkeyHandler);\n                },\n                dispose: function() {\n                    this.close();\n                    document.removeEventListener("remove", this.hotkeyHandler);\n                },\n                hotkeyHandler: function(e) {\n                    if (!this.actived) {\n                        return;\n                    }\n                    if (e.keyCode === keymap["esc"]) {\n                        this.close();\n                    }\n                },\n                toggleToolbar: function(e) {\n                    e && e.preventDefault();\n                    this.toolbar.classList.toggle("hidden");\n                },\n                zoomImage: function(restore) {\n                    var image = this.image;\n                    if (typeof restore === "boolean") {\n                        restore && addClass(image, "limited");\n                    } else {\n                        image.classList.toggle("limited");\n                    }\n                },\n                viewSource: function(src) {\n                    window.open(this.image.src);\n                },\n                open: function(src) {\n                    var input = document.querySelector("input");\n                    if (input) {\n                        input.focus();\n                        input.blur();\n                    }\n                    this.image.src = src;\n                    this.zoomImage(true);\n                    document.body.appendChild(this.viewer);\n                    this.actived = true;\n                },\n                close: function() {\n                    this.image.src = "";\n                    document.body.removeChild(this.viewer);\n                    this.actived = false;\n                }\n            });\n            return {\n                init: function() {\n                    this.viewer = new ImageViewer();\n                },\n                events: {\n                    "normal.dblclick": function(e) {\n                        var shape = e.kityEvent.targetShape;\n                        if (shape.__KityClassName === "Image" && shape.url) {\n                            this.viewer.open(shape.url);\n                        }\n                    }\n                }\n            };\n        });\n    }\n};\n\n//src/module/image.js\n_p[50] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("image", function() {\n            function loadImageSize(url, callback) {\n                var img = document.createElement("img");\n                img.onload = function() {\n                    callback(img.width, img.height);\n                };\n                img.onerror = function() {\n                    callback(null);\n                };\n                img.src = url;\n            }\n            function fitImageSize(width, height, maxWidth, maxHeight) {\n                var ratio = width / height, fitRatio = maxWidth / maxHeight;\n                // 宽高比大于最大尺寸的宽高比，以宽度为标准适应\n                if (width > maxWidth && ratio > fitRatio) {\n                    width = maxWidth;\n                    height = width / ratio;\n                } else if (height > maxHeight) {\n                    height = maxHeight;\n                    width = height * ratio;\n                }\n                return {\n                    width: width | 0,\n                    height: height | 0\n                };\n            }\n            /**\n         * @command Image\n         * @description 为选中的节点添加图片\n         * @param {string} url 图片的 URL，设置为 null 移除\n         * @param {string} title 图片的说明\n         * @state\n         *   0: 当前有选中的节点\n         *  -1: 当前没有选中的节点\n         * @return 返回首个选中节点的图片信息，JSON 对象： `{url: url, title: title}`\n         */\n            var ImageCommand = kity.createClass("ImageCommand", {\n                base: Command,\n                execute: function(km, url, title) {\n                    var nodes = km.getSelectedNodes();\n                    loadImageSize(url, function(width, height) {\n                        nodes.forEach(function(n) {\n                            var size = fitImageSize(width, height, km.getOption("maxImageWidth"), km.getOption("maxImageHeight"));\n                            n.setData("image", url);\n                            n.setData("imageTitle", url && title);\n                            n.setData("imageSize", url && size);\n                            n.render();\n                        });\n                        km.fire("saveScene");\n                        km.layout(300);\n                    });\n                },\n                queryState: function(km) {\n                    var nodes = km.getSelectedNodes(), result = 0;\n                    if (nodes.length === 0) {\n                        return -1;\n                    }\n                    nodes.forEach(function(n) {\n                        if (n && n.getData("image")) {\n                            result = 0;\n                            return false;\n                        }\n                    });\n                    return result;\n                },\n                queryValue: function(km) {\n                    var node = km.getSelectedNode();\n                    return {\n                        url: node.getData("image"),\n                        title: node.getData("imageTitle")\n                    };\n                }\n            });\n            var ImageRenderer = kity.createClass("ImageRenderer", {\n                base: Renderer,\n                create: function(node) {\n                    return new kity.Image(node.getData("image"));\n                },\n                shouldRender: function(node) {\n                    return node.getData("image");\n                },\n                update: function(image, node, box) {\n                    var url = node.getData("image");\n                    var title = node.getData("imageTitle");\n                    var size = node.getData("imageSize");\n                    var spaceTop = node.getStyle("space-top");\n                    if (!size) return;\n                    if (title) {\n                        image.node.setAttributeNS("http://www.w3.org/1999/xlink", "title", title);\n                    }\n                    var x = box.cx - size.width / 2;\n                    var y = box.y - size.height - spaceTop;\n                    image.setUrl(url).setX(x | 0).setY(y | 0).setWidth(size.width | 0).setHeight(size.height | 0);\n                    return new kity.Box(x | 0, y | 0, size.width | 0, size.height | 0);\n                }\n            });\n            return {\n                defaultOptions: {\n                    maxImageWidth: 200,\n                    maxImageHeight: 200\n                },\n                commands: {\n                    image: ImageCommand\n                },\n                renderers: {\n                    top: ImageRenderer\n                }\n            };\n        });\n    }\n};\n\n//src/module/keynav.js\n_p[51] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var keymap = _p.r(15);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("KeyboardModule", function() {\n            var min = Math.min, max = Math.max, abs = Math.abs, sqrt = Math.sqrt, exp = Math.exp;\n            function buildPositionNetwork(root) {\n                var pointIndexes = [], p;\n                root.traverse(function(node) {\n                    p = node.getLayoutBox();\n                    // bugfix: 不应导航到收起的节点（判断其尺寸是否存在）\n                    if (p.width && p.height) {\n                        pointIndexes.push({\n                            left: p.x,\n                            top: p.y,\n                            right: p.x + p.width,\n                            bottom: p.y + p.height,\n                            width: p.width,\n                            height: p.height,\n                            node: node\n                        });\n                    }\n                });\n                for (var i = 0; i < pointIndexes.length; i++) {\n                    findClosestPointsFor(pointIndexes, i);\n                }\n            }\n            // 这是金泉的点子，赞！\n            // 求两个不相交矩形的最近距离\n            function getCoefedDistance(box1, box2) {\n                var xMin, xMax, yMin, yMax, xDist, yDist, dist, cx, cy;\n                xMin = min(box1.left, box2.left);\n                xMax = max(box1.right, box2.right);\n                yMin = min(box1.top, box2.top);\n                yMax = max(box1.bottom, box2.bottom);\n                xDist = xMax - xMin - box1.width - box2.width;\n                yDist = yMax - yMin - box1.height - box2.height;\n                if (xDist < 0) dist = yDist; else if (yDist < 0) dist = xDist; else dist = sqrt(xDist * xDist + yDist * yDist);\n                var node1 = box1.node;\n                var node2 = box2.node;\n                // sibling\n                if (node1.parent == node2.parent) {\n                    dist /= 10;\n                }\n                // parent\n                if (node2.parent == node1) {\n                    dist /= 5;\n                }\n                return dist;\n            }\n            function findClosestPointsFor(pointIndexes, iFind) {\n                var find = pointIndexes[iFind];\n                var most = {}, quad;\n                var current, dist;\n                for (var i = 0; i < pointIndexes.length; i++) {\n                    if (i == iFind) continue;\n                    current = pointIndexes[i];\n                    dist = getCoefedDistance(current, find);\n                    // left check\n                    if (current.right < find.left) {\n                        if (!most.left || dist < most.left.dist) {\n                            most.left = {\n                                dist: dist,\n                                node: current.node\n                            };\n                        }\n                    }\n                    // right check\n                    if (current.left > find.right) {\n                        if (!most.right || dist < most.right.dist) {\n                            most.right = {\n                                dist: dist,\n                                node: current.node\n                            };\n                        }\n                    }\n                    // top check\n                    if (current.bottom < find.top) {\n                        if (!most.top || dist < most.top.dist) {\n                            most.top = {\n                                dist: dist,\n                                node: current.node\n                            };\n                        }\n                    }\n                    // bottom check\n                    if (current.top > find.bottom) {\n                        if (!most.down || dist < most.down.dist) {\n                            most.down = {\n                                dist: dist,\n                                node: current.node\n                            };\n                        }\n                    }\n                }\n                find.node._nearestNodes = {\n                    right: most.right && most.right.node || null,\n                    top: most.top && most.top.node || null,\n                    left: most.left && most.left.node || null,\n                    down: most.down && most.down.node || null\n                };\n            }\n            function navigateTo(km, direction) {\n                var referNode = km.getSelectedNode();\n                if (!referNode) {\n                    km.select(km.getRoot());\n                    buildPositionNetwork(km.getRoot());\n                    return;\n                }\n                if (!referNode._nearestNodes) {\n                    buildPositionNetwork(km.getRoot());\n                }\n                var nextNode = referNode._nearestNodes[direction];\n                if (nextNode) {\n                    km.select(nextNode, true);\n                }\n            }\n            // 稀释用\n            var lastFrame;\n            return {\n                events: {\n                    layoutallfinish: function() {\n                        var root = this.getRoot();\n                        buildPositionNetwork(root);\n                    },\n                    "normal.keydown readonly.keydown": function(e) {\n                        var minder = this;\n                        [ "left", "right", "up", "down" ].forEach(function(key) {\n                            if (e.isShortcutKey(key)) {\n                                navigateTo(minder, key == "up" ? "top" : key);\n                                e.preventDefault();\n                            }\n                        });\n                    }\n                }\n            };\n        });\n    }\n};\n\n//src/module/layout.js\n/**\n * @fileOverview\n *\n * 布局模块\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[52] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        /**\n     * @command Layout\n     * @description 设置选中节点的布局\n     *     允许使用的布局可以使用 `kityminder.Minder.getLayoutList()` 查询\n     * @param {string} name 布局的名称，设置为 null 则使用继承或默认的布局\n     * @state\n     *   0: 当前有选中的节点\n     *  -1: 当前没有选中的节点\n     * @return 返回首个选中节点的布局名称\n     */\n        var LayoutCommand = kity.createClass("LayoutCommand", {\n            base: Command,\n            execute: function(minder, name) {\n                var nodes = minder.getSelectedNodes();\n                nodes.forEach(function(node) {\n                    node.layout(name);\n                });\n            },\n            queryValue: function(minder) {\n                var node = minder.getSelectedNode();\n                if (node) {\n                    return node.getData("layout");\n                }\n            },\n            queryState: function(minder) {\n                return minder.getSelectedNode() ? 0 : -1;\n            }\n        });\n        /**\n     * @command ResetLayout\n     * @description 重设选中节点的布局，如果当前没有选中的节点，重设整个脑图的布局\n     * @state\n     *   0: 始终可用\n     * @return 返回首个选中节点的布局名称\n     */\n        var ResetLayoutCommand = kity.createClass("ResetLayoutCommand", {\n            base: Command,\n            execute: function(minder) {\n                var nodes = minder.getSelectedNodes();\n                if (!nodes.length) nodes = [ minder.getRoot() ];\n                nodes.forEach(function(node) {\n                    node.traverse(function(child) {\n                        child.resetLayoutOffset();\n                        if (!child.isRoot()) {\n                            child.setData("layout", null);\n                        }\n                    });\n                });\n                minder.layout(300);\n            },\n            enableReadOnly: true\n        });\n        Module.register("LayoutModule", {\n            commands: {\n                layout: LayoutCommand,\n                resetlayout: ResetLayoutCommand\n            },\n            contextmenu: [ {\n                command: "resetlayout"\n            }, {\n                divider: true\n            } ],\n            commandShortcutKeys: {\n                resetlayout: "Ctrl+Shift+L"\n            }\n        });\n    }\n};\n\n//src/module/node.js\n_p[53] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        /**\n     * @command AppendChildNode\n     * @description 添加子节点到选中的节点中\n     * @param {string|object} textOrData 要插入的节点的文本或数据\n     * @state\n     *    0: 当前有选中的节点\n     *   -1: 当前没有选中的节点\n     */\n        var AppendChildCommand = kity.createClass("AppendChildCommand", {\n            base: Command,\n            execute: function(km, text) {\n                var parent = km.getSelectedNode();\n                if (!parent) {\n                    return null;\n                }\n                var node = km.createNode(text, parent);\n                km.select(node, true);\n                if (parent.isExpanded()) {\n                    node.render();\n                } else {\n                    parent.expand();\n                    parent.renderTree();\n                }\n                km.layout(600);\n            },\n            queryState: function(km) {\n                var selectedNode = km.getSelectedNode();\n                return selectedNode ? 0 : -1;\n            }\n        });\n        /**\n     * @command AppendSiblingNode\n     * @description 添加选中的节点的兄弟节点\n     * @param {string|object} textOrData 要添加的节点的文本或数据\n     * @state\n     *    0: 当前有选中的节点\n     *   -1: 当前没有选中的节点\n     */\n        var AppendSiblingCommand = kity.createClass("AppendSiblingCommand", {\n            base: Command,\n            execute: function(km, text) {\n                var sibling = km.getSelectedNode();\n                var parent = sibling.parent;\n                if (!parent) {\n                    return km.execCommand("AppendChildNode", text);\n                }\n                var node = km.createNode(text, parent, sibling.getIndex() + 1);\n                node.setGlobalLayoutTransform(sibling.getGlobalLayoutTransform());\n                km.select(node, true);\n                node.render();\n                km.layout(600);\n            },\n            queryState: function(km) {\n                var selectedNode = km.getSelectedNode();\n                return selectedNode ? 0 : -1;\n            }\n        });\n        /**\n     * @command RemoveNode\n     * @description 移除选中的节点\n     * @state\n     *    0: 当前有选中的节点\n     *   -1: 当前没有选中的节点\n     */\n        var RemoveNodeCommand = kity.createClass("RemoverNodeCommand", {\n            base: Command,\n            execute: function(km) {\n                var nodes = km.getSelectedNodes();\n                var ancestor = MinderNode.getCommonAncestor.apply(null, nodes);\n                var index = nodes[0].getIndex();\n                nodes.forEach(function(node) {\n                    if (!node.isRoot()) km.removeNode(node);\n                });\n                if (nodes.length == 1) {\n                    var selectBack = ancestor.children[index - 1] || ancestor.children[index];\n                    km.select(selectBack || ancestor || km.getRoot(), true);\n                } else {\n                    km.select(ancestor || km.getRoot(), true);\n                }\n                km.layout(600);\n            },\n            queryState: function(km) {\n                var selectedNode = km.getSelectedNode();\n                return selectedNode && !selectedNode.isRoot() ? 0 : -1;\n            }\n        });\n        var AppendParentCommand = kity.createClass("AppendParentCommand", {\n            base: Command,\n            execute: function(km, text) {\n                var nodes = km.getSelectedNodes();\n                nodes.sort(function(a, b) {\n                    return a.getIndex() - b.getIndex();\n                });\n                var parent = nodes[0].parent;\n                var newParent = km.createNode(text, parent, nodes[0].getIndex());\n                nodes.forEach(function(node) {\n                    newParent.appendChild(node);\n                });\n                newParent.setGlobalLayoutTransform(nodes[nodes.length >> 1].getGlobalLayoutTransform());\n                km.select(newParent, true);\n                km.layout(600);\n            },\n            queryState: function(km) {\n                var nodes = km.getSelectedNodes();\n                if (!nodes.length) return -1;\n                var parent = nodes[0].parent;\n                if (!parent) return -1;\n                for (var i = 1; i < nodes.length; i++) {\n                    if (nodes[i].parent != parent) return -1;\n                }\n                return 0;\n            }\n        });\n        Module.register("NodeModule", function() {\n            return {\n                commands: {\n                    AppendChildNode: AppendChildCommand,\n                    AppendSiblingNode: AppendSiblingCommand,\n                    RemoveNode: RemoveNodeCommand,\n                    AppendParentNode: AppendParentCommand\n                },\n                commandShortcutKeys: {\n                    appendsiblingnode: "normal::Enter",\n                    appendchildnode: "normal::Insert|Tab",\n                    appendparentnode: "normal::Shift+Tab|normal::Shift+Insert",\n                    removenode: "normal::Del|Backspace"\n                }\n            };\n        });\n    }\n};\n\n//src/module/note.js\n/**\n * @fileOverview\n *\n * 支持节点详细信息（HTML）格式\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[54] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("NoteModule", function() {\n            var NOTE_PATH = "M9,9H3V8h6L9,9L9,9z M9,7H3V6h6V7z M9,5H3V4h6V5z M8.5,11H2V2h8v7.5 M9,12l2-2V1H1v11";\n            /**\n         * @command Note\n         * @description 设置节点的备注信息\n         * @param {string} note 要设置的备注信息，设置为 null 则移除备注信息\n         * @state\n         *    0: 当前有选中的节点\n         *   -1: 当前没有选中的节点\n         */\n            var NoteCommand = kity.createClass("NoteCommand", {\n                base: Command,\n                execute: function(minder, note) {\n                    var node = minder.getSelectedNode();\n                    node.setData("note", note);\n                    node.render();\n                    node.getMinder().layout(300);\n                },\n                queryState: function(minder) {\n                    return minder.getSelectedNodes().length === 1 ? 0 : -1;\n                },\n                queryValue: function(minder) {\n                    var node = minder.getSelectedNode();\n                    return node && node.getData("note");\n                }\n            });\n            var NoteIcon = kity.createClass("NoteIcon", {\n                base: kity.Group,\n                constructor: function() {\n                    this.callBase();\n                    this.width = 16;\n                    this.height = 17;\n                    this.rect = new kity.Rect(16, 17, .5, -8.5, 2).fill("transparent");\n                    this.path = new kity.Path().setPathData(NOTE_PATH).setTranslate(2.5, -6.5);\n                    this.addShapes([ this.rect, this.path ]);\n                    this.on("mouseover", function() {\n                        this.rect.fill("rgba(255, 255, 200, .8)");\n                    }).on("mouseout", function() {\n                        this.rect.fill("transparent");\n                    });\n                    this.setStyle("cursor", "pointer");\n                }\n            });\n            var NoteIconRenderer = kity.createClass("NoteIconRenderer", {\n                base: Renderer,\n                create: function(node) {\n                    var icon = new NoteIcon();\n                    icon.on("mousedown", function(e) {\n                        e.preventDefault();\n                        node.getMinder().fire("editnoterequest");\n                    });\n                    icon.on("mouseover", function() {\n                        node.getMinder().fire("shownoterequest", {\n                            node: node,\n                            icon: icon\n                        });\n                    });\n                    icon.on("mouseout", function() {\n                        node.getMinder().fire("hidenoterequest", {\n                            node: node,\n                            icon: icon\n                        });\n                    });\n                    return icon;\n                },\n                shouldRender: function(node) {\n                    return node.getData("note");\n                },\n                update: function(icon, node, box) {\n                    var x = box.right + node.getStyle("space-left");\n                    var y = box.cy;\n                    icon.path.fill(node.getStyle("color"));\n                    icon.setTranslate(x, y);\n                    return new kity.Box(x, Math.round(y - icon.height / 2), icon.width, icon.height);\n                }\n            });\n            return {\n                renderers: {\n                    right: NoteIconRenderer\n                },\n                commands: {\n                    note: NoteCommand\n                }\n            };\n        });\n    }\n};\n\n//src/module/outline.js\n_p[55] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        var OutlineRenderer = kity.createClass("OutlineRenderer", {\n            base: Renderer,\n            create: function(node) {\n                var outline = new kity.Rect().setId(utils.uuid("node_outline"));\n                this.bringToBack = true;\n                return outline;\n            },\n            update: function(outline, node, box) {\n                var shape = node.getStyle("shape");\n                var paddingLeft = node.getStyle("padding-left"), paddingRight = node.getStyle("padding-right"), paddingTop = node.getStyle("padding-top"), paddingBottom = node.getStyle("padding-bottom");\n                var outlineBox = {\n                    x: box.x - paddingLeft,\n                    y: box.y - paddingTop,\n                    width: box.width + paddingLeft + paddingRight,\n                    height: box.height + paddingTop + paddingBottom\n                };\n                var radius = node.getStyle("radius");\n                // 天盘图圆形的情况\n                if (shape && shape == "circle") {\n                    var p = Math.pow;\n                    var r = Math.round;\n                    radius = r(Math.sqrt(p(outlineBox.width, 2) + p(outlineBox.height, 2)) / 2);\n                    outlineBox.x = box.cx - radius;\n                    outlineBox.y = box.cy - radius;\n                    outlineBox.width = 2 * radius;\n                    outlineBox.height = 2 * radius;\n                }\n                var prefix = node.isSelected() ? node.getMinder().isFocused() ? "selected-" : "blur-selected-" : "";\n                outline.setPosition(outlineBox.x, outlineBox.y).setSize(outlineBox.width, outlineBox.height).setRadius(radius).fill(node.getData("background") || node.getStyle(prefix + "background") || node.getStyle("background")).stroke(node.getStyle(prefix + "stroke" || false), node.getStyle(prefix + "stroke-width"));\n                return new kity.Box(outlineBox);\n            }\n        });\n        var ShadowRenderer = kity.createClass("ShadowRenderer", {\n            base: Renderer,\n            create: function(node) {\n                this.bringToBack = true;\n                return new kity.Rect();\n            },\n            shouldRender: function(node) {\n                return node.getStyle("shadow");\n            },\n            update: function(shadow, node, box) {\n                shadow.setPosition(box.x + 4, box.y + 5).fill(node.getStyle("shadow"));\n                var shape = node.getStyle("shape");\n                if (!shape) {\n                    shadow.setSize(box.width, box.height);\n                    shadow.setRadius(node.getStyle("radius"));\n                } else if (shape == "circle") {\n                    var width = Math.max(box.width, box.height);\n                    shadow.setSize(width, width);\n                    shadow.setRadius(width / 2);\n                }\n            }\n        });\n        var marker = new kity.Marker();\n        marker.setWidth(10);\n        marker.setHeight(12);\n        marker.setRef(0, 0);\n        marker.setViewBox(-6, -4, 8, 10);\n        marker.addShape(new kity.Path().setPathData("M-5-3l5,3,-5,3").stroke("#33ffff"));\n        var wireframeOption = /wire/.test(window.location.href);\n        var WireframeRenderer = kity.createClass("WireframeRenderer", {\n            base: Renderer,\n            create: function() {\n                var wireframe = new kity.Group();\n                var oxy = this.oxy = new kity.Path().stroke("#f6f").setPathData("M0,-50L0,50M-50,0L50,0");\n                var box = this.wireframe = new kity.Rect().stroke("lightgreen");\n                var vectorIn = this.vectorIn = new kity.Path().stroke("#66ffff");\n                var vectorOut = this.vectorOut = new kity.Path().stroke("#66ffff");\n                vectorIn.setMarker(marker, "end");\n                vectorOut.setMarker(marker, "end");\n                return wireframe.addShapes([ oxy, box, vectorIn, vectorOut ]);\n            },\n            shouldRender: function() {\n                return wireframeOption;\n            },\n            update: function(created, node, box) {\n                this.wireframe.setPosition(box.x, box.y).setSize(box.width, box.height);\n                var pin = node.getVertexIn();\n                var pout = node.getVertexOut();\n                var vin = node.getLayoutVectorIn().normalize(30);\n                var vout = node.getLayoutVectorOut().normalize(30);\n                this.vectorIn.setPathData([ "M", pin.offset(vin.reverse()), "L", pin ]);\n                this.vectorOut.setPathData([ "M", pout, "l", vout ]);\n            }\n        });\n        Module.register("OutlineModule", function() {\n            return {\n                events: !wireframeOption ? null : {\n                    ready: function() {\n                        this.getPaper().addResource(marker);\n                    },\n                    layoutallfinish: function() {\n                        this.getRoot().traverse(function(node) {\n                            node.getRenderer("WireframeRenderer").update(null, node, node.getContentBox());\n                        });\n                    }\n                },\n                renderers: {\n                    outline: OutlineRenderer,\n                    outside: [ ShadowRenderer, WireframeRenderer ]\n                }\n            };\n        });\n    }\n};\n\n//src/module/priority.js\n_p[56] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("PriorityModule", function() {\n            var minder = this;\n            // Designed by Akikonata\n            // [MASK, BACK]\n            // var PRIORITY_COLORS = [null, [\'#FF1200\', \'#840023\'], // 1 - red\n            //     [\'#0074FF\', \'#01467F\'], // 2 - blue\n            //     [\'#00AF00\', \'#006300\'], // 3 - green\n            //     [\'#FF962E\', \'#B25000\'], // 4 - orange\n            //     [\'#A464FF\', \'#4720C4\'], // 5 - purple\n            //     [\'#A3A3A3\', \'#515151\'], // 6,7,8,9 - gray\n            //     [\'#A3A3A3\', \'#515151\'],\n            //     [\'#A3A3A3\', \'#515151\'],\n            //     [\'#A3A3A3\', \'#515151\'],\n            // ]; // hue from 1 to 5\n            var PRIORITY_COLORS = [ [ "#F85633", "#F85633" ], // 0 - red\n            [ "#3e7bbf", "#3e7bbf" ], // 1 - blue\n            [ "#2DBAAD", "#2DBAAD" ], // 2 - green\n            [ "#DD832C", "#DD832C" ] ];\n            // hue from 1 to 5\n            // jscs:disable maximumLineLength\n            var BACK_PATH = "M0,13c0,3.866,3.134,7,7,7h6c3.866,0,7-3.134,7-7V7H0V13z";\n            var MASK_PATH = "M20,10c0,3.866-3.134,7-7,7H7c-3.866,0-7-3.134-7-7V7c0-3.866,3.134-7,7-7h6c3.866,0,7,3.134,7,7V10z";\n            var PRIORITY_DATA = "priority";\n            // 优先级图标的图形\n            var PriorityIcon = kity.createClass("PriorityIcon", {\n                base: kity.Group,\n                constructor: function() {\n                    this.callBase();\n                    this.setSize(20);\n                    this.create();\n                    this.setId(utils.uuid("node_priority"));\n                },\n                setSize: function(size) {\n                    this.width = this.height = size;\n                },\n                create: function() {\n                    var white, back, mask, number;\n                    // 4 layer\n                    white = new kity.Path().setPathData(MASK_PATH).fill("white");\n                    back = new kity.Path().setPathData(BACK_PATH).setTranslate(.5, .5);\n                    mask = new kity.Path().setPathData(MASK_PATH).setOpacity(.8).setTranslate(.5, .5);\n                    number = new kity.Text().setX(this.width / 2 - .5).setY(this.height / 2).setTextAnchor("middle").setVerticalAlign("middle").setFontItalic(true).setFontSize(12).fill("white");\n                    this.addShapes([ back, mask, number ]);\n                    this.mask = mask;\n                    this.back = back;\n                    this.number = number;\n                },\n                setValue: function(value) {\n                    var back = this.back, mask = this.mask, number = this.number;\n                    var color = PRIORITY_COLORS[value - 1];\n                    if (color) {\n                        back.fill(color[1]);\n                        mask.fill(color[0]);\n                    }\n                    number.setContent("P" + (value - 1));\n                }\n            });\n            /**\n         * @command Priority\n         * @description 设置节点的优先级信息\n         * @param {number} value 要设置的优先级（添加一个优先级小图标）\n         *     取值为 0 移除优先级信息；\n         *     取值为 1 - 9 设置优先级，超过 9 的优先级不渲染\n         * @state\n         *    0: 当前有选中的节点\n         *   -1: 当前没有选中的节点\n         */\n            var PriorityCommand = kity.createClass("SetPriorityCommand", {\n                base: Command,\n                execute: function(km, value) {\n                    var nodes = km.getSelectedNodes();\n                    // 设置时间\n                    var timestamp = new Date();\n                    for (var i = 0; i < nodes.length; i++) {\n                        nodes[i].setData(PRIORITY_DATA, value || null).render();\n                    }\n                    km.layout();\n                },\n                queryValue: function(km) {\n                    var nodes = km.getSelectedNodes();\n                    var val;\n                    for (var i = 0; i < nodes.length; i++) {\n                        val = nodes[i].getData(PRIORITY_DATA);\n                        if (val) break;\n                    }\n                    return val || null;\n                },\n                queryState: function(km) {\n                    return km.getSelectedNodes().length ? 0 : -1;\n                }\n            });\n            return {\n                commands: {\n                    priority: PriorityCommand\n                },\n                renderers: {\n                    left: kity.createClass("PriorityRenderer", {\n                        base: Renderer,\n                        create: function(node) {\n                            return new PriorityIcon();\n                        },\n                        shouldRender: function(node) {\n                            return node.getData(PRIORITY_DATA);\n                        },\n                        update: function(icon, node, box) {\n                            var data = node.getData(PRIORITY_DATA);\n                            var spaceLeft = node.getStyle("space-left"), x, y;\n                            icon.setValue(data);\n                            x = box.left - icon.width - spaceLeft;\n                            y = -icon.height / 2;\n                            icon.setTranslate(x, y);\n                            return new kity.Box({\n                                x: x,\n                                y: y,\n                                width: icon.width,\n                                height: icon.height\n                            });\n                        }\n                    })\n                }\n            };\n        });\n    }\n};\n\n//src/module/progress.js\n_p[57] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("ProgressModule", function() {\n            var minder = this;\n            var PROGRESS_DATA = "progress";\n            // Designed by Akikonata\n            var BG_COLOR = "#FFED83";\n            var PIE_COLOR = "#43BC00";\n            var SHADOW_PATH = "M10,3c4.418,0,8,3.582,8,8h1c0-5.523-3.477-10-9-10S1,5.477,1,11h1C2,6.582,5.582,3,10,3z";\n            var SHADOW_COLOR = "#8E8E8E";\n            // jscs:disable maximumLineLength\n            var FRAME_PATH = "M10,0C4.477,0,0,4.477,0,10c0,5.523,4.477,10,10,10s10-4.477,10-10C20,4.477,15.523,0,10,0zM10,18c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8S14.418,18,10,18z";\n            var FRAME_GRAD = new kity.LinearGradient().pipe(function(g) {\n                g.setStartPosition(0, 0);\n                g.setEndPosition(0, 1);\n                g.addStop(0, "#fff");\n                g.addStop(1, "#ccc");\n            });\n            var CHECK_PATH = "M15.812,7.896l-6.75,6.75l-4.5-4.5L6.25,8.459l2.812,2.803l5.062-5.053L15.812,7.896z";\n            var CHECK_COLOR = "#EEE";\n            minder.getPaper().addResource(FRAME_GRAD);\n            // 进度图标的图形\n            var ProgressIcon = kity.createClass("ProgressIcon", {\n                base: kity.Group,\n                constructor: function(value) {\n                    this.callBase();\n                    this.setSize(20);\n                    this.create();\n                    this.setValue(value);\n                    this.setId(utils.uuid("node_progress"));\n                    this.translate(.5, .5);\n                },\n                setSize: function(size) {\n                    this.width = this.height = size;\n                },\n                create: function() {\n                    var bg, pie, shadow, frame, check;\n                    bg = new kity.Circle(9).fill(BG_COLOR);\n                    pie = new kity.Pie(9, 0).fill(PIE_COLOR);\n                    shadow = new kity.Path().setPathData(SHADOW_PATH).setTranslate(-10, -10).fill(SHADOW_COLOR);\n                    frame = new kity.Path().setTranslate(-10, -10).setPathData(FRAME_PATH).fill(FRAME_GRAD);\n                    check = new kity.Path().setTranslate(-10, -10).setPathData(CHECK_PATH).fill(CHECK_COLOR);\n                    this.addShapes([ bg, pie, shadow, check, frame ]);\n                    this.pie = pie;\n                    this.check = check;\n                },\n                setValue: function(value) {\n                    this.pie.setAngle(-360 * (value - 1) / 8);\n                    this.check.setVisible(value == 9);\n                }\n            });\n            /**\n         * @command Progress\n         * @description 设置节点的进度信息（添加一个进度小图标）\n         * @param {number} value 要设置的进度\n         *     取值为 0 移除进度信息；\n         *     取值为 1 表示未开始；\n         *     取值为 2 表示完成 1/8；\n         *     取值为 3 表示完成 2/8；\n         *     取值为 4 表示完成 3/8；\n         *     其余类推，取值为 9 表示全部完成\n         * @state\n         *    0: 当前有选中的节点\n         *   -1: 当前没有选中的节点\n         */\n            var ProgressCommand = kity.createClass("ProgressCommand", {\n                base: Command,\n                execute: function(km, value) {\n                    var nodes = km.getSelectedNodes();\n                    for (var i = 0; i < nodes.length; i++) {\n                        nodes[i].setData(PROGRESS_DATA, value || null).render();\n                    }\n                    km.layout();\n                },\n                queryValue: function(km) {\n                    var nodes = km.getSelectedNodes();\n                    var val;\n                    for (var i = 0; i < nodes.length; i++) {\n                        val = nodes[i].getData(PROGRESS_DATA);\n                        if (val) break;\n                    }\n                    return val || null;\n                },\n                queryState: function(km) {\n                    return km.getSelectedNodes().length ? 0 : -1;\n                }\n            });\n            return {\n                commands: {\n                    progress: ProgressCommand\n                },\n                renderers: {\n                    left: kity.createClass("ProgressRenderer", {\n                        base: Renderer,\n                        create: function(node) {\n                            return new ProgressIcon();\n                        },\n                        shouldRender: function(node) {\n                            return node.getData(PROGRESS_DATA);\n                        },\n                        update: function(icon, node, box) {\n                            var data = node.getData(PROGRESS_DATA);\n                            var spaceLeft = node.getStyle("space-left");\n                            var x, y;\n                            icon.setValue(data);\n                            x = box.left - icon.width - spaceLeft;\n                            y = -icon.height / 2;\n                            icon.setTranslate(x + icon.width / 2, y + icon.height / 2);\n                            return new kity.Box(x, y, icon.width, icon.height);\n                        }\n                    })\n                }\n            };\n        });\n    }\n};\n\n//src/module/resource.js\n_p[58] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("Resource", function() {\n            // String Hash\n            // https://github.com/drostie/sha3-js/edit/master/blake32.min.js\n            var blake32 = function() {\n                var k, g, r, l, m, o, p, q, t, w, x;\n                x = 4 * (1 << 30);\n                k = [ 1779033703, 3144134277, 1013904242, 2773480762, 1359893119, 2600822924, 528734635, 1541459225 ];\n                m = [ 608135816, 2242054355, 320440878, 57701188, 2752067618, 698298832, 137296536, 3964562569, 1160258022, 953160567, 3193202383, 887688300, 3232508343, 3380367581, 1065670069, 3041331479 ];\n                w = function(i) {\n                    if (i < 0) {\n                        i += x;\n                    }\n                    return ("00000000" + i.toString(16)).slice(-8);\n                };\n                o = [ [ 16, 50, 84, 118, 152, 186, 220, 254 ], [ 174, 132, 249, 109, 193, 32, 123, 53 ], [ 139, 12, 37, 223, 234, 99, 23, 73 ], [ 151, 19, 205, 235, 98, 165, 4, 143 ], [ 9, 117, 66, 250, 30, 203, 134, 211 ], [ 194, 166, 176, 56, 212, 87, 239, 145 ], [ 92, 241, 222, 164, 112, 54, 41, 184 ], [ 189, 231, 28, 147, 5, 79, 104, 162 ], [ 246, 158, 59, 128, 44, 125, 65, 90 ], [ 42, 72, 103, 81, 191, 233, 195, 13 ] ];\n                p = function(a, b, n) {\n                    var s = q[a] ^ q[b];\n                    q[a] = s >>> n | s << 32 - n;\n                };\n                g = function(i, a, b, c, d) {\n                    var u = l + o[r][i] % 16, v = l + (o[r][i] >> 4);\n                    a %= 4;\n                    b = 4 + b % 4;\n                    c = 8 + c % 4;\n                    d = 12 + d % 4;\n                    q[a] += q[b] + (t[u] ^ m[v % 16]);\n                    p(d, a, 16);\n                    q[c] += q[d];\n                    p(b, c, 12);\n                    q[a] += q[b] + (t[v] ^ m[u % 16]);\n                    p(d, a, 8);\n                    q[c] += q[d];\n                    p(b, c, 7);\n                };\n                return function(a, b) {\n                    if (!(b instanceof Array && b.length === 4)) {\n                        b = [ 0, 0, 0, 0 ];\n                    }\n                    var c, d, e, L, f, h, j, i;\n                    d = k.slice(0);\n                    c = m.slice(0, 8);\n                    for (r = 0; r < 4; r += 1) {\n                        c[r] ^= b[r];\n                    }\n                    e = a.length * 16;\n                    f = e % 512 > 446 || e % 512 === 0 ? 0 : e;\n                    if (e % 512 === 432) {\n                        a += "老";\n                    } else {\n                        a += "耀";\n                        while (a.length % 32 !== 27) {\n                            a += "\\0";\n                        }\n                        a += "";\n                    }\n                    t = [];\n                    for (i = 0; i < a.length; i += 2) {\n                        t.push(a.charCodeAt(i) * 65536 + a.charCodeAt(i + 1));\n                    }\n                    t.push(0);\n                    t.push(e);\n                    h = t.length - 16;\n                    j = 0;\n                    for (l = 0; l < t.length; l += 16) {\n                        j += 512;\n                        L = l === h ? f : Math.min(e, j);\n                        q = d.concat(c);\n                        q[12] ^= L;\n                        q[13] ^= L;\n                        for (r = 0; r < 10; r += 1) {\n                            for (i = 0; i < 8; i += 1) {\n                                if (i < 4) {\n                                    g(i, i, i, i, i);\n                                } else {\n                                    g(i, i, i + 1, i + 2, i + 3);\n                                }\n                            }\n                        }\n                        for (i = 0; i < 8; i += 1) {\n                            d[i] ^= b[i % 4] ^ q[i] ^ q[i + 8];\n                        }\n                    }\n                    return d.map(w).join("");\n                };\n            }();\n            /**\n         * 自动使用的颜色序列\n         */\n            var RESOURCE_COLOR_SERIES = [ 51, 303, 75, 200, 157, 0, 26, 254 ].map(function(h) {\n                return kity.Color.createHSL(h, 100, 85);\n            });\n            /**\n         * 在 Minder 上拓展一些关于资源的支持接口\n         */\n            kity.extendClass(Minder, {\n                /**\n             * 获取字符串的哈希值\n             *\n             * @param {String} str\n             * @return {Number} hashCode\n             */\n                getHashCode: function(str) {\n                    str = blake32(str);\n                    var hash = 1315423911, i, ch;\n                    for (i = str.length - 1; i >= 0; i--) {\n                        ch = str.charCodeAt(i);\n                        hash ^= (hash << 5) + ch + (hash >> 2);\n                    }\n                    return hash & 2147483647;\n                },\n                /**\n             * 获取脑图中某个资源对应的颜色\n             *\n             * 如果存在同名资源，则返回已经分配给该资源的颜色，否则分配给该资源一个颜色，并且返回\n             *\n             * 如果资源数超过颜色序列数量，返回哈希颜色\n             *\n             * @param {String} resource 资源名称\n             * @return {Color}\n             */\n                getResourceColor: function(resource) {\n                    var colorMapping = this._getResourceColorIndexMapping();\n                    var nextIndex;\n                    if (!Object.prototype.hasOwnProperty.call(colorMapping, resource)) {\n                        // 找不到找下个可用索引\n                        nextIndex = this._getNextResourceColorIndex();\n                        colorMapping[resource] = nextIndex;\n                    }\n                    // 资源过多，找不到可用索引颜色，统一返回哈希函数得到的颜色\n                    return RESOURCE_COLOR_SERIES[colorMapping[resource]] || kity.Color.createHSL(Math.floor(this.getHashCode(resource) / 2147483647 * 359), 100, 85);\n                },\n                /**\n             * 获得已使用的资源的列表\n             *\n             * @return {Array}\n             */\n                getUsedResource: function() {\n                    var mapping = this._getResourceColorIndexMapping();\n                    var used = [], resource;\n                    for (resource in mapping) {\n                        if (Object.prototype.hasOwnProperty.call(mapping, resource)) {\n                            used.push(resource);\n                        }\n                    }\n                    return used;\n                },\n                /**\n             * 获取脑图下一个可用的资源颜色索引\n             *\n             * @return {int}\n             */\n                _getNextResourceColorIndex: function() {\n                    // 获取现有颜色映射\n                    //     resource => color_index\n                    var colorMapping = this._getResourceColorIndexMapping();\n                    var resource, used, i;\n                    used = [];\n                    // 抽取已经使用的值到 used 数组\n                    for (resource in colorMapping) {\n                        if (Object.prototype.hasOwnProperty.call(colorMapping, resource)) {\n                            used.push(colorMapping[resource]);\n                        }\n                    }\n                    // 枚举所有的可用值，如果还没被使用，返回\n                    for (i = 0; i < RESOURCE_COLOR_SERIES.length; i++) {\n                        if (!~used.indexOf(i)) return i;\n                    }\n                    // 没有可用的颜色了\n                    return -1;\n                },\n                // 获取现有颜色映射\n                //     resource => color_index\n                _getResourceColorIndexMapping: function() {\n                    return this._resourceColorMapping || (this._resourceColorMapping = {});\n                }\n            });\n            /**\n         * @class 设置资源的命令\n         *\n         * @example\n         *\n         * // 设置选中节点资源为 "张三"\n         * minder.execCommand(\'resource\', [\'张三\']);\n         *\n         * // 添加资源 "李四" 到选中节点\n         * var resource = minder.queryCommandValue();\n         * resource.push(\'李四\');\n         * minder.execCommand(\'resource\', resource);\n         *\n         * // 清除选中节点的资源\n         * minder.execCommand(\'resource\', null);\n         */\n            var ResourceCommand = kity.createClass("ResourceCommand", {\n                base: Command,\n                execute: function(minder, resource) {\n                    var nodes = minder.getSelectedNodes();\n                    if (typeof resource == "string") {\n                        resource = [ resource ];\n                    }\n                    nodes.forEach(function(node) {\n                        node.setData("resource", resource).render();\n                    });\n                    minder.layout(200);\n                },\n                queryValue: function(minder) {\n                    var nodes = minder.getSelectedNodes();\n                    var resource = [];\n                    nodes.forEach(function(node) {\n                        var nodeResource = node.getData("resource");\n                        if (!nodeResource) return;\n                        nodeResource.forEach(function(name) {\n                            if (!~resource.indexOf(name)) {\n                                resource.push(name);\n                            }\n                        });\n                    });\n                    return resource;\n                },\n                queryState: function(km) {\n                    return km.getSelectedNode() ? 0 : -1;\n                }\n            });\n            /**\n         * @class 资源的覆盖图形\n         *\n         * 该类为一个资源以指定的颜色渲染一个动态的覆盖图形\n         */\n            var ResourceOverlay = kity.createClass("ResourceOverlay", {\n                base: kity.Group,\n                constructor: function() {\n                    this.callBase();\n                    var text, rect;\n                    rect = this.rect = new kity.Rect().setRadius(4);\n                    text = this.text = new kity.Text().setFontSize(12).setVerticalAlign("middle");\n                    this.addShapes([ rect, text ]);\n                },\n                setValue: function(resourceName, color) {\n                    var paddingX = 8, paddingY = 4, borderRadius = 4;\n                    var text, box, rect;\n                    text = this.text;\n                    if (resourceName == this.lastResourceName) {\n                        box = this.lastBox;\n                    } else {\n                        text.setContent(resourceName);\n                        box = text.getBoundaryBox();\n                        this.lastResourceName = resourceName;\n                        this.lastBox = box;\n                    }\n                    text.setX(paddingX).fill(color.dec("l", 70));\n                    rect = this.rect;\n                    rect.setPosition(0, box.y - paddingY);\n                    this.width = Math.round(box.width + paddingX * 2);\n                    this.height = Math.round(box.height + paddingY * 2);\n                    rect.setSize(this.width, this.height);\n                    rect.fill(color);\n                }\n            });\n            /**\n         * @class 资源渲染器\n         */\n            var ResourceRenderer = kity.createClass("ResourceRenderer", {\n                base: Renderer,\n                create: function(node) {\n                    this.overlays = [];\n                    return new kity.Group();\n                },\n                shouldRender: function(node) {\n                    return node.getData("resource") && node.getData("resource").length;\n                },\n                update: function(container, node, box) {\n                    var spaceRight = node.getStyle("space-right");\n                    var overlays = this.overlays;\n                    /*  修复 resource 数组中出现 null 的 bug\n                 *  @Author zhangbobell\n                 *  @date 2016-01-15\n                 */\n                    var resource = node.getData("resource").filter(function(ele) {\n                        return ele !== null;\n                    });\n                    if (resource.length === 0) {\n                        return;\n                    }\n                    var minder = node.getMinder();\n                    var i, overlay, x;\n                    x = 0;\n                    for (i = 0; i < resource.length; i++) {\n                        x += spaceRight;\n                        overlay = overlays[i];\n                        if (!overlay) {\n                            overlay = new ResourceOverlay();\n                            overlays.push(overlay);\n                            container.addShape(overlay);\n                        }\n                        overlay.setVisible(true);\n                        overlay.setValue(resource[i], minder.getResourceColor(resource[i]));\n                        overlay.setTranslate(x, -1);\n                        x += overlay.width;\n                    }\n                    while (overlay = overlays[i++]) overlay.setVisible(false);\n                    container.setTranslate(box.right, 0);\n                    return new kity.Box({\n                        x: box.right,\n                        y: Math.round(-overlays[0].height / 2),\n                        width: x,\n                        height: overlays[0].height\n                    });\n                }\n            });\n            return {\n                commands: {\n                    resource: ResourceCommand\n                },\n                renderers: {\n                    right: ResourceRenderer\n                }\n            };\n        });\n    }\n};\n\n//src/module/select.js\n_p[59] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("Select", function() {\n            var minder = this;\n            var rc = minder.getRenderContainer();\n            // 在实例上渲染框选矩形、计算框选范围的对象\n            var marqueeActivator = function() {\n                // 记录选区的开始位置（mousedown的位置）\n                var startPosition = null;\n                // 选区的图形\n                var marqueeShape = new kity.Path();\n                // 标记是否已经启动框选状态\n                //    并不是 mousedown 发生之后就启动框选状态，而是检测到移动了一定的距离（MARQUEE_MODE_THRESHOLD）之后\n                var marqueeMode = false;\n                var MARQUEE_MODE_THRESHOLD = 10;\n                return {\n                    selectStart: function(e) {\n                        // 只接受左键\n                        if (e.originEvent.button || e.originEvent.altKey) return;\n                        // 清理不正确状态\n                        if (startPosition) {\n                            return this.selectEnd();\n                        }\n                        startPosition = e.getPosition(rc).round();\n                    },\n                    selectMove: function(e) {\n                        if (minder.getStatus() == "textedit") {\n                            return;\n                        }\n                        if (!startPosition) return;\n                        var p1 = startPosition, p2 = e.getPosition(rc);\n                        // 检测是否要进入选区模式\n                        if (!marqueeMode) {\n                            // 距离没达到阈值，退出\n                            if (kity.Vector.fromPoints(p1, p2).length() < MARQUEE_MODE_THRESHOLD) {\n                                return;\n                            }\n                            // 已经达到阈值，记录下来并且重置选区形状\n                            marqueeMode = true;\n                            rc.addShape(marqueeShape);\n                            marqueeShape.fill(minder.getStyle("marquee-background")).stroke(minder.getStyle("marquee-stroke")).setOpacity(.8).getDrawer().clear();\n                        }\n                        var marquee = new kity.Box(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y), selectedNodes = [];\n                        // 使其犀利\n                        marquee.left = Math.round(marquee.left);\n                        marquee.top = Math.round(marquee.top);\n                        marquee.right = Math.round(marquee.right);\n                        marquee.bottom = Math.round(marquee.bottom);\n                        // 选区形状更新\n                        marqueeShape.getDrawer().pipe(function() {\n                            this.clear();\n                            this.moveTo(marquee.left, marquee.top);\n                            this.lineTo(marquee.right, marquee.top);\n                            this.lineTo(marquee.right, marquee.bottom);\n                            this.lineTo(marquee.left, marquee.bottom);\n                            this.close();\n                        });\n                        // 计算选中范围\n                        minder.getRoot().traverse(function(node) {\n                            var renderBox = node.getLayoutBox();\n                            if (!renderBox.intersect(marquee).isEmpty()) {\n                                selectedNodes.push(node);\n                            }\n                        });\n                        // 应用选中范围\n                        minder.select(selectedNodes, true);\n                        // 清除多余的东西\n                        window.getSelection().removeAllRanges();\n                    },\n                    selectEnd: function(e) {\n                        if (startPosition) {\n                            startPosition = null;\n                        }\n                        if (marqueeMode) {\n                            marqueeShape.fadeOut(200, "ease", 0, function() {\n                                if (marqueeShape.remove) marqueeShape.remove();\n                            });\n                            marqueeMode = false;\n                        }\n                    }\n                };\n            }();\n            var lastDownNode = null, lastDownPosition = null;\n            return {\n                init: function() {\n                    window.addEventListener("mouseup", function() {\n                        marqueeActivator.selectEnd();\n                    });\n                },\n                events: {\n                    mousedown: function(e) {\n                        var downNode = e.getTargetNode();\n                        // 没有点中节点：\n                        //     清除选中状态，并且标记选区开始位置\n                        if (!downNode) {\n                            this.removeAllSelectedNodes();\n                            marqueeActivator.selectStart(e);\n                            this.setStatus("normal");\n                        } else if (e.isShortcutKey("Ctrl")) {\n                            this.toggleSelect(downNode);\n                        } else if (!downNode.isSelected()) {\n                            this.select(downNode, true);\n                        } else if (!this.isSingleSelect()) {\n                            lastDownNode = downNode;\n                            lastDownPosition = e.getPosition();\n                        }\n                    },\n                    mousemove: marqueeActivator.selectMove,\n                    mouseup: function(e) {\n                        var upNode = e.getTargetNode();\n                        // 如果 mouseup 发生在 lastDownNode 外，是无需理会的\n                        if (upNode && upNode == lastDownNode) {\n                            var upPosition = e.getPosition();\n                            var movement = kity.Vector.fromPoints(lastDownPosition, upPosition);\n                            if (movement.length() < 1) this.select(lastDownNode, true);\n                            lastDownNode = null;\n                        }\n                        // 清理一下选择状态\n                        marqueeActivator.selectEnd(e);\n                    },\n                    //全选操作\n                    "normal.keydown": function(e) {\n                        if (e.isShortcutKey("ctrl+a")) {\n                            var selectedNodes = [];\n                            this.getRoot().traverse(function(node) {\n                                selectedNodes.push(node);\n                            });\n                            this.select(selectedNodes, true);\n                            e.preventDefault();\n                        }\n                    }\n                }\n            };\n        });\n    }\n};\n\n//src/module/style.js\n_p[60] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("StyleModule", function() {\n            var styleNames = [ "font-size", "font-family", "font-weight", "font-style", "background", "color" ];\n            var styleClipBoard = null;\n            function hasStyle(node) {\n                var data = node.getData();\n                for (var i = 0; i < styleNames.length; i++) {\n                    if (styleNames[i] in data) return true;\n                }\n            }\n            return {\n                commands: {\n                    /**\n                 * @command CopyStyle\n                 * @description 拷贝选中节点的当前样式，包括字体、字号、粗体、斜体、背景色、字体色\n                 * @state\n                 *   0: 当前有选中的节点\n                 *  -1: 当前没有选中的节点\n                 */\n                    copystyle: kity.createClass("CopyStyleCommand", {\n                        base: Command,\n                        execute: function(minder) {\n                            var node = minder.getSelectedNode();\n                            var nodeData = node.getData();\n                            styleClipBoard = {};\n                            styleNames.forEach(function(name) {\n                                if (name in nodeData) styleClipBoard[name] = nodeData[name]; else {\n                                    styleClipBoard[name] = null;\n                                    delete styleClipBoard[name];\n                                }\n                            });\n                            return styleClipBoard;\n                        },\n                        queryState: function(minder) {\n                            var nodes = minder.getSelectedNodes();\n                            if (nodes.length !== 1) return -1;\n                            return hasStyle(nodes[0]) ? 0 : -1;\n                        }\n                    }),\n                    /**\n                 * @command PasteStyle\n                 * @description 粘贴已拷贝的样式到选中的节点上，包括字体、字号、粗体、斜体、背景色、字体色\n                 * @state\n                 *   0: 当前有选中的节点，并且已经有复制的样式\n                 *  -1: 当前没有选中的节点，或者没有复制的样式\n                 */\n                    pastestyle: kity.createClass("PastStyleCommand", {\n                        base: Command,\n                        execute: function(minder) {\n                            minder.getSelectedNodes().forEach(function(node) {\n                                for (var name in styleClipBoard) {\n                                    if (styleClipBoard.hasOwnProperty(name)) node.setData(name, styleClipBoard[name]);\n                                }\n                            });\n                            minder.renderNodeBatch(minder.getSelectedNodes());\n                            minder.layout(300);\n                            return styleClipBoard;\n                        },\n                        queryState: function(minder) {\n                            return styleClipBoard && minder.getSelectedNodes().length ? 0 : -1;\n                        }\n                    }),\n                    /**\n                 * @command ClearStyle\n                 * @description 移除选中节点的样式，包括字体、字号、粗体、斜体、背景色、字体色\n                 * @state\n                 *   0: 当前有选中的节点，并且至少有一个设置了至少一种样式\n                 *  -1: 其它情况\n                 */\n                    clearstyle: kity.createClass("ClearStyleCommand", {\n                        base: Command,\n                        execute: function(minder) {\n                            minder.getSelectedNodes().forEach(function(node) {\n                                styleNames.forEach(function(name) {\n                                    node.setData(name);\n                                });\n                            });\n                            minder.renderNodeBatch(minder.getSelectedNodes());\n                            minder.layout(300);\n                            return styleClipBoard;\n                        },\n                        queryState: function(minder) {\n                            var nodes = minder.getSelectedNodes();\n                            if (!nodes.length) return -1;\n                            for (var i = 0; i < nodes.length; i++) {\n                                if (hasStyle(nodes[i])) return 0;\n                            }\n                            return -1;\n                        }\n                    })\n                }\n            };\n        });\n    }\n};\n\n//src/module/text.js\n_p[61] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        /**\n     * 针对不同系统、不同浏览器、不同字体做居中兼容性处理\n     * 暂时未增加Linux的处理\n     */\n        var FONT_ADJUST = {\n            safari: {\n                "微软雅黑,Microsoft YaHei": -.17,\n                "楷体,楷体_GB2312,SimKai": -.1,\n                "隶书, SimLi": -.1,\n                "comic sans ms": -.23,\n                "impact,chicago": -.15,\n                "times new roman": -.1,\n                "arial black,avant garde": -.17,\n                default: 0\n            },\n            ie: {\n                10: {\n                    "微软雅黑,Microsoft YaHei": -.17,\n                    "comic sans ms": -.17,\n                    "impact,chicago": -.08,\n                    "times new roman": .04,\n                    "arial black,avant garde": -.17,\n                    default: -.15\n                },\n                11: {\n                    "微软雅黑,Microsoft YaHei": -.17,\n                    "arial,helvetica,sans-serif": -.17,\n                    "comic sans ms": -.17,\n                    "impact,chicago": -.08,\n                    "times new roman": .04,\n                    "sans-serif": -.16,\n                    "arial black,avant garde": -.17,\n                    default: -.15\n                }\n            },\n            edge: {\n                "微软雅黑,Microsoft YaHei": -.15,\n                "arial,helvetica,sans-serif": -.17,\n                "comic sans ms": -.17,\n                "impact,chicago": -.08,\n                "sans-serif": -.16,\n                "arial black,avant garde": -.17,\n                default: -.15\n            },\n            sg: {\n                "微软雅黑,Microsoft YaHei": -.15,\n                "arial,helvetica,sans-serif": -.05,\n                "comic sans ms": -.22,\n                "impact,chicago": -.16,\n                "times new roman": -.03,\n                "arial black,avant garde": -.22,\n                default: -.15\n            },\n            chrome: {\n                Mac: {\n                    "andale mono": -.05,\n                    "comic sans ms": -.3,\n                    "impact,chicago": -.13,\n                    "times new roman": -.1,\n                    "arial black,avant garde": -.17,\n                    default: 0\n                },\n                Win: {\n                    "微软雅黑,Microsoft YaHei": -.15,\n                    "arial,helvetica,sans-serif": -.02,\n                    "arial black,avant garde": -.2,\n                    "comic sans ms": -.2,\n                    "impact,chicago": -.12,\n                    "times new roman": -.02,\n                    default: -.15\n                },\n                Lux: {\n                    "andale mono": -.05,\n                    "comic sans ms": -.3,\n                    "impact,chicago": -.13,\n                    "times new roman": -.1,\n                    "arial black,avant garde": -.17,\n                    default: 0\n                }\n            },\n            firefox: {\n                Mac: {\n                    "微软雅黑,Microsoft YaHei": -.2,\n                    "宋体,SimSun": .05,\n                    "comic sans ms": -.2,\n                    "impact,chicago": -.15,\n                    "arial black,avant garde": -.17,\n                    "times new roman": -.1,\n                    default: .05\n                },\n                Win: {\n                    "微软雅黑,Microsoft YaHei": -.16,\n                    "andale mono": -.17,\n                    "arial,helvetica,sans-serif": -.17,\n                    "comic sans ms": -.22,\n                    "impact,chicago": -.23,\n                    "times new roman": -.22,\n                    "sans-serif": -.22,\n                    "arial black,avant garde": -.17,\n                    default: -.16\n                },\n                Lux: {\n                    "宋体,SimSun": -.2,\n                    "微软雅黑,Microsoft YaHei": -.2,\n                    "黑体, SimHei": -.2,\n                    "隶书, SimLi": -.2,\n                    "楷体,楷体_GB2312,SimKai": -.2,\n                    "andale mono": -.2,\n                    "arial,helvetica,sans-serif": -.2,\n                    "comic sans ms": -.2,\n                    "impact,chicago": -.2,\n                    "times new roman": -.2,\n                    "sans-serif": -.2,\n                    "arial black,avant garde": -.2,\n                    default: -.16\n                }\n            }\n        };\n        var TextRenderer = kity.createClass("TextRenderer", {\n            base: Renderer,\n            create: function() {\n                return new kity.Group().setId(utils.uuid("node_text"));\n            },\n            update: function(textGroup, node) {\n                function getDataOrStyle(name) {\n                    return node.getData(name) || node.getStyle(name);\n                }\n                var nodeText = node.getText();\n                var textArr = nodeText ? nodeText.split("\\n") : [ " " ];\n                var lineHeight = node.getStyle("line-height");\n                var fontSize = getDataOrStyle("font-size");\n                var fontFamily = getDataOrStyle("font-family") || "default";\n                var height = lineHeight * fontSize * textArr.length - (lineHeight - 1) * fontSize;\n                var yStart = -height / 2;\n                var Browser = kity.Browser;\n                var adjust;\n                if (Browser.chrome || Browser.opera || Browser.bd || Browser.lb === "chrome") {\n                    adjust = FONT_ADJUST["chrome"][Browser.platform][fontFamily];\n                } else if (Browser.gecko) {\n                    adjust = FONT_ADJUST["firefox"][Browser.platform][fontFamily];\n                } else if (Browser.sg) {\n                    adjust = FONT_ADJUST["sg"][fontFamily];\n                } else if (Browser.safari) {\n                    adjust = FONT_ADJUST["safari"][fontFamily];\n                } else if (Browser.ie) {\n                    adjust = FONT_ADJUST["ie"][Browser.version][fontFamily];\n                } else if (Browser.edge) {\n                    adjust = FONT_ADJUST["edge"][fontFamily];\n                } else if (Browser.lb) {\n                    // 猎豹浏览器的ie内核兼容性模式下\n                    adjust = .9;\n                }\n                textGroup.setTranslate(0, (adjust || 0) * fontSize);\n                var rBox = new kity.Box(), r = Math.round;\n                this.setTextStyle(node, textGroup);\n                var textLength = textArr.length;\n                var textGroupLength = textGroup.getItems().length;\n                var i, ci, textShape, text;\n                if (textLength < textGroupLength) {\n                    for (i = textLength, ci; ci = textGroup.getItem(i); ) {\n                        textGroup.removeItem(i);\n                    }\n                } else if (textLength > textGroupLength) {\n                    var growth = textLength - textGroupLength;\n                    while (growth--) {\n                        textShape = new kity.Text().setAttr("text-rendering", "inherit");\n                        if (kity.Browser.ie || kity.Browser.edge) {\n                            textShape.setVerticalAlign("top");\n                        } else {\n                            textShape.setAttr("dominant-baseline", "text-before-edge");\n                        }\n                        textGroup.addItem(textShape);\n                    }\n                }\n                for (i = 0, text, textShape; text = textArr[i], textShape = textGroup.getItem(i); i++) {\n                    textShape.setContent(text);\n                    if (kity.Browser.ie || kity.Browser.edge) {\n                        textShape.fixPosition();\n                    }\n                }\n                this.setTextStyle(node, textGroup);\n                var textHash = node.getText() + [ "font-size", "font-name", "font-weight", "font-style" ].map(getDataOrStyle).join("/");\n                if (node._currentTextHash == textHash && node._currentTextGroupBox) return node._currentTextGroupBox;\n                node._currentTextHash = textHash;\n                return function() {\n                    textGroup.eachItem(function(i, textShape) {\n                        var y = yStart + i * fontSize * lineHeight;\n                        textShape.setY(y);\n                        var bbox = textShape.getBoundaryBox();\n                        rBox = rBox.merge(new kity.Box(0, y, bbox.height && bbox.width || 1, fontSize));\n                    });\n                    var nBox = new kity.Box(r(rBox.x), r(rBox.y), r(rBox.width), r(rBox.height));\n                    node._currentTextGroupBox = nBox;\n                    return nBox;\n                };\n            },\n            setTextStyle: function(node, text) {\n                var hooks = TextRenderer._styleHooks;\n                hooks.forEach(function(hook) {\n                    hook(node, text);\n                });\n            }\n        });\n        var TextCommand = kity.createClass({\n            base: Command,\n            execute: function(minder, text) {\n                var node = minder.getSelectedNode();\n                if (node) {\n                    node.setText(text);\n                    node.render();\n                    minder.layout();\n                }\n            },\n            queryState: function(minder) {\n                return minder.getSelectedNodes().length == 1 ? 0 : -1;\n            },\n            queryValue: function(minder) {\n                var node = minder.getSelectedNode();\n                return node ? node.getText() : null;\n            }\n        });\n        utils.extend(TextRenderer, {\n            _styleHooks: [],\n            registerStyleHook: function(fn) {\n                TextRenderer._styleHooks.push(fn);\n            }\n        });\n        kity.extendClass(MinderNode, {\n            getTextGroup: function() {\n                return this.getRenderer("TextRenderer").getRenderShape();\n            }\n        });\n        Module.register("text", {\n            commands: {\n                text: TextCommand\n            },\n            renderers: {\n                center: TextRenderer\n            }\n        });\n        module.exports = TextRenderer;\n    }\n};\n\n//src/module/view.js\n_p[62] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        var ViewDragger = kity.createClass("ViewDragger", {\n            constructor: function(minder) {\n                this._minder = minder;\n                this._enabled = false;\n                this._bind();\n                var me = this;\n                this._minder.getViewDragger = function() {\n                    return me;\n                };\n                this.setEnabled(false);\n            },\n            isEnabled: function() {\n                return this._enabled;\n            },\n            setEnabled: function(value) {\n                var paper = this._minder.getPaper();\n                paper.setStyle("cursor", value ? "pointer" : "default");\n                paper.setStyle("cursor", value ? "-webkit-grab" : "default");\n                this._enabled = value;\n            },\n            timeline: function() {\n                return this._moveTimeline;\n            },\n            move: function(offset, duration) {\n                var minder = this._minder;\n                var targetPosition = this.getMovement().offset(offset);\n                this.moveTo(targetPosition, duration);\n            },\n            moveTo: function(position, duration) {\n                if (duration) {\n                    var dragger = this;\n                    if (this._moveTimeline) this._moveTimeline.stop();\n                    this._moveTimeline = this._minder.getRenderContainer().animate(new kity.Animator(this.getMovement(), position, function(target, value) {\n                        dragger.moveTo(value);\n                    }), duration, "easeOutCubic").timeline();\n                    this._moveTimeline.on("finish", function() {\n                        dragger._moveTimeline = null;\n                    });\n                    return this;\n                }\n                this._minder.getRenderContainer().setTranslate(position.round());\n                this._minder.fire("viewchange");\n            },\n            getMovement: function() {\n                var translate = this._minder.getRenderContainer().transform.translate;\n                return translate ? translate[0] : new kity.Point();\n            },\n            getView: function() {\n                var minder = this._minder;\n                var c = minder._lastClientSize || {\n                    width: minder.getRenderTarget().clientWidth,\n                    height: minder.getRenderTarget().clientHeight\n                };\n                var m = this.getMovement();\n                var box = new kity.Box(0, 0, c.width, c.height);\n                var viewMatrix = minder.getPaper().getViewPortMatrix();\n                return viewMatrix.inverse().translate(-m.x, -m.y).transformBox(box);\n            },\n            _bind: function() {\n                var dragger = this, isTempDrag = false, lastPosition = null, currentPosition = null;\n                function dragEnd(e) {\n                    if (!lastPosition) return;\n                    lastPosition = null;\n                    e.stopPropagation();\n                    // 临时拖动需要还原状态\n                    if (isTempDrag) {\n                        dragger.setEnabled(false);\n                        isTempDrag = false;\n                        if (dragger._minder.getStatus() == "hand") dragger._minder.rollbackStatus();\n                    }\n                    var paper = dragger._minder.getPaper();\n                    paper.setStyle("cursor", dragger._minder.getStatus() == "hand" ? "-webkit-grab" : "default");\n                    dragger._minder.fire("viewchanged");\n                }\n                this._minder.on("normal.mousedown normal.touchstart " + "inputready.mousedown inputready.touchstart " + "readonly.mousedown readonly.touchstart", function(e) {\n                    if (e.originEvent.button == 2) {\n                        e.originEvent.preventDefault();\n                    }\n                    // 点击未选中的根节点临时开启\n                    if (e.getTargetNode() == this.getRoot() || e.originEvent.button == 2 || e.originEvent.altKey) {\n                        lastPosition = e.getPosition("view");\n                        isTempDrag = true;\n                    }\n                }).on("normal.mousemove normal.touchmove " + "readonly.mousemove readonly.touchmove " + "inputready.mousemove inputready.touchmove", function(e) {\n                    if (e.type == "touchmove") {\n                        e.preventDefault();\n                    }\n                    if (!isTempDrag) return;\n                    var offset = kity.Vector.fromPoints(lastPosition, e.getPosition("view"));\n                    if (offset.length() > 10) {\n                        this.setStatus("hand", true);\n                        var paper = dragger._minder.getPaper();\n                        paper.setStyle("cursor", "-webkit-grabbing");\n                    }\n                }).on("hand.beforemousedown hand.beforetouchstart", function(e) {\n                    // 已经被用户打开拖放模式\n                    if (dragger.isEnabled()) {\n                        lastPosition = e.getPosition("view");\n                        e.stopPropagation();\n                        var paper = dragger._minder.getPaper();\n                        paper.setStyle("cursor", "-webkit-grabbing");\n                    }\n                }).on("hand.beforemousemove hand.beforetouchmove", function(e) {\n                    if (lastPosition) {\n                        currentPosition = e.getPosition("view");\n                        // 当前偏移加上历史偏移\n                        var offset = kity.Vector.fromPoints(lastPosition, currentPosition);\n                        dragger.move(offset);\n                        e.stopPropagation();\n                        e.preventDefault();\n                        e.originEvent.preventDefault();\n                        lastPosition = currentPosition;\n                    }\n                }).on("mouseup touchend", dragEnd);\n                window.addEventListener("mouseup", dragEnd);\n                this._minder.on("contextmenu", function(e) {\n                    e.preventDefault();\n                });\n            }\n        });\n        Module.register("View", function() {\n            var km = this;\n            /**\n         * @command Hand\n         * @description 切换抓手状态，抓手状态下，鼠标拖动将拖动视野，而不是创建选区\n         * @state\n         *   0: 当前不是抓手状态\n         *   1: 当前是抓手状态\n         */\n            var ToggleHandCommand = kity.createClass("ToggleHandCommand", {\n                base: Command,\n                execute: function(minder) {\n                    if (minder.getStatus() != "hand") {\n                        minder.setStatus("hand", true);\n                    } else {\n                        minder.rollbackStatus();\n                    }\n                    this.setContentChanged(false);\n                },\n                queryState: function(minder) {\n                    return minder.getStatus() == "hand" ? 1 : 0;\n                },\n                enableReadOnly: true\n            });\n            /**\n         * @command Camera\n         * @description 设置当前视野的中心位置到某个节点上\n         * @param {kityminder.MinderNode} focusNode 要定位的节点\n         * @param {number} duration 设置视野移动的动画时长（单位 ms），设置为 0 不使用动画\n         * @state\n         *   0: 始终可用\n         */\n            var CameraCommand = kity.createClass("CameraCommand", {\n                base: Command,\n                execute: function(km, focusNode) {\n                    focusNode = focusNode || km.getRoot();\n                    var viewport = km.getPaper().getViewPort();\n                    var offset = focusNode.getRenderContainer().getRenderBox("view");\n                    var dx = viewport.center.x - offset.x - offset.width / 2, dy = viewport.center.y - offset.y;\n                    var dragger = km._viewDragger;\n                    var duration = km.getOption("viewAnimationDuration");\n                    dragger.move(new kity.Point(dx, dy), duration);\n                    this.setContentChanged(false);\n                },\n                enableReadOnly: true\n            });\n            /**\n         * @command Move\n         * @description 指定方向移动当前视野\n         * @param {string} dir 移动方向\n         *    取值为 \'left\'，视野向左移动一半\n         *    取值为 \'right\'，视野向右移动一半\n         *    取值为 \'up\'，视野向上移动一半\n         *    取值为 \'down\'，视野向下移动一半\n         * @param {number} duration 视野移动的动画时长（单位 ms），设置为 0 不使用动画\n         * @state\n         *   0: 始终可用\n         */\n            var MoveCommand = kity.createClass("MoveCommand", {\n                base: Command,\n                execute: function(km, dir) {\n                    var dragger = km._viewDragger;\n                    var size = km._lastClientSize;\n                    var duration = km.getOption("viewAnimationDuration");\n                    switch (dir) {\n                      case "up":\n                        dragger.move(new kity.Point(0, size.height / 2), duration);\n                        break;\n\n                      case "down":\n                        dragger.move(new kity.Point(0, -size.height / 2), duration);\n                        break;\n\n                      case "left":\n                        dragger.move(new kity.Point(size.width / 2, 0), duration);\n                        break;\n\n                      case "right":\n                        dragger.move(new kity.Point(-size.width / 2, 0), duration);\n                        break;\n                    }\n                },\n                enableReadOnly: true\n            });\n            return {\n                init: function() {\n                    this._viewDragger = new ViewDragger(this);\n                },\n                commands: {\n                    hand: ToggleHandCommand,\n                    camera: CameraCommand,\n                    move: MoveCommand\n                },\n                events: {\n                    statuschange: function(e) {\n                        this._viewDragger.setEnabled(e.currentStatus == "hand");\n                    },\n                    mousewheel: function(e) {\n                        var dx, dy;\n                        e = e.originEvent;\n                        if (e.ctrlKey || e.shiftKey) return;\n                        if ("wheelDeltaX" in e) {\n                            dx = e.wheelDeltaX || 0;\n                            dy = e.wheelDeltaY || 0;\n                        } else {\n                            dx = 0;\n                            dy = e.wheelDelta;\n                        }\n                        this._viewDragger.move({\n                            x: dx / 2.5,\n                            y: dy / 2.5\n                        });\n                        var me = this;\n                        clearTimeout(this._mousewheeltimer);\n                        this._mousewheeltimer = setTimeout(function() {\n                            me.fire("viewchanged");\n                        }, 100);\n                        e.preventDefault();\n                    },\n                    "normal.dblclick readonly.dblclick": function(e) {\n                        if (e.kityEvent.targetShape instanceof kity.Paper) {\n                            this.execCommand("camera", this.getRoot(), 800);\n                        }\n                    },\n                    "paperrender finishInitHook": function() {\n                        if (!this.getRenderTarget()) {\n                            return;\n                        }\n                        this.execCommand("camera", null, 0);\n                        this._lastClientSize = {\n                            width: this.getRenderTarget().clientWidth,\n                            height: this.getRenderTarget().clientHeight\n                        };\n                    },\n                    resize: function(e) {\n                        var a = {\n                            width: this.getRenderTarget().clientWidth,\n                            height: this.getRenderTarget().clientHeight\n                        }, b = this._lastClientSize;\n                        this._viewDragger.move(new kity.Point((a.width - b.width) / 2 | 0, (a.height - b.height) / 2 | 0));\n                        this._lastClientSize = a;\n                    },\n                    "selectionchange layoutallfinish": function(e) {\n                        var selected = this.getSelectedNode();\n                        var minder = this;\n                        /*\n                    * Added by zhangbobell 2015.9.9\n                    * windows 10 的 edge 浏览器在全部动画停止后，优先级图标不显示 text，\n                    * 因此再次触发一次 render 事件，让浏览器重绘\n                    * */\n                        if (kity.Browser.edge) {\n                            this.fire("paperrender");\n                        }\n                        if (!selected) return;\n                        var dragger = this._viewDragger;\n                        var timeline = dragger.timeline();\n                        /*\n                    * Added by zhangbobell 2015.09.25\n                    * 如果之前有动画，那么就先暂时返回，等之前动画结束之后再次执行本函数\n                    * 以防止 view 动画变动了位置，导致本函数执行的时候位置计算不对\n                    *\n                    * fixed bug : 初始化的时候中心节点位置不固定（有的时候在左上角，有的时候在中心）\n                    * */\n                        if (timeline) {\n                            timeline.on("finish", function() {\n                                minder.fire("selectionchange");\n                            });\n                            return;\n                        }\n                        var view = dragger.getView();\n                        var focus = selected.getLayoutBox();\n                        var space = 50;\n                        var dx = 0, dy = 0;\n                        if (focus.right > view.right) {\n                            dx += view.right - focus.right - space;\n                        } else if (focus.left < view.left) {\n                            dx += view.left - focus.left + space;\n                        }\n                        if (focus.bottom > view.bottom) {\n                            dy += view.bottom - focus.bottom - space;\n                        }\n                        if (focus.top < view.top) {\n                            dy += view.top - focus.top + space;\n                        }\n                        if (dx || dy) dragger.move(new kity.Point(dx, dy), 100);\n                    }\n                }\n            };\n        });\n    }\n};\n\n//src/module/zoom.js\n_p[63] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var utils = _p.r(33);\n        var Minder = _p.r(19);\n        var MinderNode = _p.r(21);\n        var Command = _p.r(9);\n        var Module = _p.r(20);\n        var Renderer = _p.r(27);\n        Module.register("Zoom", function() {\n            var me = this;\n            var timeline;\n            function setTextRendering() {\n                var value = me._zoomValue >= 100 ? "optimize-speed" : "geometricPrecision";\n                me.getRenderContainer().setAttr("text-rendering", value);\n            }\n            function fixPaperCTM(paper) {\n                var node = paper.shapeNode;\n                var ctm = node.getCTM();\n                var matrix = new kity.Matrix(ctm.a, ctm.b, ctm.c, ctm.d, (ctm.e | 0) + .5, (ctm.f | 0) + .5);\n                node.setAttribute("transform", "matrix(" + matrix.toString() + ")");\n            }\n            kity.extendClass(Minder, {\n                zoom: function(value) {\n                    var paper = this.getPaper();\n                    var viewport = paper.getViewPort();\n                    viewport.zoom = value / 100;\n                    viewport.center = {\n                        x: viewport.center.x,\n                        y: viewport.center.y\n                    };\n                    paper.setViewPort(viewport);\n                    if (value == 100) fixPaperCTM(paper);\n                },\n                getZoomValue: function() {\n                    return this._zoomValue;\n                }\n            });\n            function zoomMinder(minder, value) {\n                var paper = minder.getPaper();\n                var viewport = paper.getViewPort();\n                if (!value) return;\n                setTextRendering();\n                var duration = minder.getOption("zoomAnimationDuration");\n                if (minder.getRoot().getComplex() > 200 || !duration) {\n                    minder._zoomValue = value;\n                    minder.zoom(value);\n                    minder.fire("viewchange");\n                } else {\n                    var animator = new kity.Animator({\n                        beginValue: minder._zoomValue,\n                        finishValue: value,\n                        setter: function(target, value) {\n                            target.zoom(value);\n                        }\n                    });\n                    minder._zoomValue = value;\n                    if (timeline) {\n                        timeline.pause();\n                    }\n                    timeline = animator.start(minder, duration, "easeInOutSine");\n                    timeline.on("finish", function() {\n                        minder.fire("viewchange");\n                    });\n                }\n                minder.fire("zoom", {\n                    zoom: value\n                });\n            }\n            /**\n         * @command Zoom\n         * @description 缩放当前的视野到一定的比例（百分比）\n         * @param {number} value 设置的比例，取值 100 则为原尺寸\n         * @state\n         *   0: 始终可用\n         */\n            var ZoomCommand = kity.createClass("Zoom", {\n                base: Command,\n                execute: zoomMinder,\n                queryValue: function(minder) {\n                    return minder._zoomValue;\n                }\n            });\n            /**\n         * @command ZoomIn\n         * @description 放大当前的视野到下一个比例等级（百分比）\n         * @shortcut =\n         * @state\n         *   0: 如果当前脑图的配置中还有下一个比例等级\n         *  -1: 其它情况\n         */\n            var ZoomInCommand = kity.createClass("ZoomInCommand", {\n                base: Command,\n                execute: function(minder) {\n                    zoomMinder(minder, this.nextValue(minder));\n                },\n                queryState: function(minder) {\n                    return +!this.nextValue(minder);\n                },\n                nextValue: function(minder) {\n                    var stack = minder.getOption("zoom"), i;\n                    for (i = 0; i < stack.length; i++) {\n                        if (stack[i] > minder._zoomValue) return stack[i];\n                    }\n                    return 0;\n                },\n                enableReadOnly: true\n            });\n            /**\n         * @command ZoomOut\n         * @description 缩小当前的视野到上一个比例等级（百分比）\n         * @shortcut -\n         * @state\n         *   0: 如果当前脑图的配置中还有上一个比例等级\n         *  -1: 其它情况\n         */\n            var ZoomOutCommand = kity.createClass("ZoomOutCommand", {\n                base: Command,\n                execute: function(minder) {\n                    zoomMinder(minder, this.nextValue(minder));\n                },\n                queryState: function(minder) {\n                    return +!this.nextValue(minder);\n                },\n                nextValue: function(minder) {\n                    var stack = minder.getOption("zoom"), i;\n                    for (i = stack.length - 1; i >= 0; i--) {\n                        if (stack[i] < minder._zoomValue) return stack[i];\n                    }\n                    return 0;\n                },\n                enableReadOnly: true\n            });\n            return {\n                init: function() {\n                    this._zoomValue = 100;\n                    this.setDefaultOptions({\n                        zoom: [ 10, 20, 50, 100, 200 ]\n                    });\n                    setTextRendering();\n                },\n                commands: {\n                    zoomin: ZoomInCommand,\n                    zoomout: ZoomOutCommand,\n                    zoom: ZoomCommand\n                },\n                events: {\n                    "normal.mousewheel readonly.mousewheel": function(e) {\n                        if (!e.originEvent.ctrlKey && !e.originEvent.metaKey) return;\n                        var delta = e.originEvent.wheelDelta;\n                        var me = this;\n                        // 稀释\n                        if (Math.abs(delta) > 100) {\n                            clearTimeout(this._wheelZoomTimeout);\n                        } else {\n                            return;\n                        }\n                        this._wheelZoomTimeout = setTimeout(function() {\n                            var value;\n                            var lastValue = me.getPaper()._zoom || 1;\n                            if (delta > 0) {\n                                me.execCommand("zoomin");\n                            } else if (delta < 0) {\n                                me.execCommand("zoomout");\n                            }\n                        }, 100);\n                        e.originEvent.preventDefault();\n                    }\n                },\n                commandShortcutKeys: {\n                    zoomin: "ctrl+=",\n                    zoomout: "ctrl+-"\n                }\n            };\n        });\n    }\n};\n\n//src/protocol/json.js\n_p[64] = {\n    value: function(require, exports, module) {\n        var data = _p.r(12);\n        data.registerProtocol("json", module.exports = {\n            fileDescription: "KityMinder 格式",\n            fileExtension: ".km",\n            dataType: "text",\n            mineType: "application/json",\n            encode: function(json) {\n                return JSON.stringify(json);\n            },\n            decode: function(local) {\n                return JSON.parse(local);\n            }\n        });\n    }\n};\n\n//src/protocol/markdown.js\n_p[65] = {\n    value: function(require, exports, module) {\n        var data = _p.r(12);\n        var LINE_ENDING_SPLITER = /\\r\\n|\\r|\\n/;\n        var EMPTY_LINE = "";\n        var NOTE_MARK_START = "\\x3c!--Note--\\x3e";\n        var NOTE_MARK_CLOSE = "\\x3c!--/Note--\\x3e";\n        function encode(json) {\n            return _build(json, 1).join("\\n");\n        }\n        function _build(node, level) {\n            var lines = [];\n            level = level || 1;\n            var sharps = _generateHeaderSharp(level);\n            lines.push(sharps + " " + node.data.text);\n            lines.push(EMPTY_LINE);\n            var note = node.data.note;\n            if (note) {\n                var hasSharp = /^#/.test(note);\n                if (hasSharp) {\n                    lines.push(NOTE_MARK_START);\n                    note = note.replace(/^#+/gm, function($0) {\n                        return sharps + $0;\n                    });\n                }\n                lines.push(note);\n                if (hasSharp) {\n                    lines.push(NOTE_MARK_CLOSE);\n                }\n                lines.push(EMPTY_LINE);\n            }\n            if (node.children) node.children.forEach(function(child) {\n                lines = lines.concat(_build(child, level + 1));\n            });\n            return lines;\n        }\n        function _generateHeaderSharp(level) {\n            var sharps = "";\n            while (level--) sharps += "#";\n            return sharps;\n        }\n        function decode(markdown) {\n            var json, parentMap = {}, lines, line, lineInfo, level, node, parent, noteProgress, codeBlock;\n            // 一级标题转换 `{title}\\n===` => `# {title}`\n            markdown = markdown.replace(/^(.+)\\n={3,}/, function($0, $1) {\n                return "# " + $1;\n            });\n            lines = markdown.split(LINE_ENDING_SPLITER);\n            // 按行分析\n            for (var i = 0; i < lines.length; i++) {\n                line = lines[i];\n                lineInfo = _resolveLine(line);\n                // 备注标记处理\n                if (lineInfo.noteClose) {\n                    noteProgress = false;\n                    continue;\n                } else if (lineInfo.noteStart) {\n                    noteProgress = true;\n                    continue;\n                }\n                // 代码块处理\n                codeBlock = lineInfo.codeBlock ? !codeBlock : codeBlock;\n                // 备注条件：备注标签中，非标题定义，或标题越位\n                if (noteProgress || codeBlock || !lineInfo.level || lineInfo.level > level + 1) {\n                    if (node) _pushNote(node, line);\n                    continue;\n                }\n                // 标题处理\n                level = lineInfo.level;\n                node = _initNode(lineInfo.content, parentMap[level - 1]);\n                parentMap[level] = node;\n            }\n            _cleanUp(parentMap[1]);\n            return parentMap[1];\n        }\n        function _initNode(text, parent) {\n            var node = {\n                data: {\n                    text: text,\n                    note: ""\n                }\n            };\n            if (parent) {\n                if (parent.children) parent.children.push(node); else parent.children = [ node ];\n            }\n            return node;\n        }\n        function _pushNote(node, line) {\n            node.data.note += line + "\\n";\n        }\n        function _isEmpty(line) {\n            return !/\\S/.test(line);\n        }\n        function _resolveLine(line) {\n            var match = /^(#+)?\\s*(.*)$/.exec(line);\n            return {\n                level: match[1] && match[1].length || null,\n                content: match[2],\n                noteStart: line == NOTE_MARK_START,\n                noteClose: line == NOTE_MARK_CLOSE,\n                codeBlock: /^\\s*```/.test(line)\n            };\n        }\n        function _cleanUp(node) {\n            if (!/\\S/.test(node.data.note)) {\n                node.data.note = null;\n                delete node.data.note;\n            } else {\n                var notes = node.data.note.split("\\n");\n                while (notes.length && !/\\S/.test(notes[0])) notes.shift();\n                while (notes.length && !/\\S/.test(notes[notes.length - 1])) notes.pop();\n                node.data.note = notes.join("\\n");\n            }\n            if (node.children) node.children.forEach(_cleanUp);\n        }\n        data.registerProtocol("markdown", module.exports = {\n            fileDescription: "Markdown/GFM 格式",\n            fileExtension: ".md",\n            mineType: "text/markdown",\n            dataType: "text",\n            encode: function(json) {\n                return encode(json.root);\n            },\n            decode: function(markdown) {\n                return decode(markdown);\n            }\n        });\n    }\n};\n\n//src/protocol/png.js\n_p[66] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var data = _p.r(12);\n        var Promise = _p.r(25);\n        var DomURL = window.URL || window.webkitURL || window;\n        function loadImage(info, callback) {\n            return new Promise(function(resolve, reject) {\n                var image = document.createElement("img");\n                image.onload = function() {\n                    resolve({\n                        element: this,\n                        x: info.x,\n                        y: info.y,\n                        width: info.width,\n                        height: info.height\n                    });\n                };\n                image.onerror = function(err) {\n                    reject(err);\n                };\n                image.crossOrigin = "anonymous";\n                image.src = info.url;\n            });\n        }\n        /**\n     * xhrLoadImage: 通过 xhr 加载保存在 BOS 上的图片\n     * @note: BOS 上的 CORS 策略是取 headers 里面的 Origin 字段进行判断\n     *        而通过 image 的 src 的方式是无法传递 origin 的，因此需要通过 xhr 进行\n     */\n        function xhrLoadImage(info, callback) {\n            return Promise(function(resolve, reject) {\n                var xmlHttp = new XMLHttpRequest();\n                xmlHttp.open("GET", info.url + "?_=" + Date.now(), true);\n                xmlHttp.responseType = "blob";\n                xmlHttp.onreadystatechange = function() {\n                    if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {\n                        var blob = xmlHttp.response;\n                        var image = document.createElement("img");\n                        image.src = DomURL.createObjectURL(blob);\n                        image.onload = function() {\n                            DomURL.revokeObjectURL(image.src);\n                            resolve({\n                                element: image,\n                                x: info.x,\n                                y: info.y,\n                                width: info.width,\n                                height: info.height\n                            });\n                        };\n                    }\n                };\n                xmlHttp.send();\n            });\n        }\n        function getSVGInfo(minder) {\n            var paper = minder.getPaper(), paperTransform, domContainer = paper.container, svgXml, svgContainer, svgDom, renderContainer = minder.getRenderContainer(), renderBox = renderContainer.getRenderBox(), width = renderBox.width + 1, height = renderBox.height + 1, blob, svgUrl, img;\n            // 保存原始变换，并且移动到合适的位置\n            paperTransform = paper.shapeNode.getAttribute("transform");\n            paper.shapeNode.setAttribute("transform", "translate(0.5, 0.5)");\n            renderContainer.translate(-renderBox.x, -renderBox.y);\n            // 获取当前的 XML 代码\n            svgXml = paper.container.innerHTML;\n            // 回复原始变换及位置\n            renderContainer.translate(renderBox.x, renderBox.y);\n            paper.shapeNode.setAttribute("transform", paperTransform);\n            // 过滤内容\n            svgContainer = document.createElement("div");\n            svgContainer.innerHTML = svgXml;\n            svgDom = svgContainer.querySelector("svg");\n            svgDom.setAttribute("width", renderBox.width + 1);\n            svgDom.setAttribute("height", renderBox.height + 1);\n            svgDom.setAttribute("style", \'font-family: Arial, "Microsoft Yahei","Heiti SC";\');\n            svgContainer = document.createElement("div");\n            svgContainer.appendChild(svgDom);\n            svgXml = svgContainer.innerHTML;\n            // Dummy IE\n            svgXml = svgXml.replace(\' xmlns="http://www.w3.org/2000/svg" \' + \'xmlns:NS1="" NS1:ns1:xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:NS2="" NS2:xmlns:ns1=""\', "");\n            // svg 含有 &nbsp; 符号导出报错 Entity \'nbsp\' not defined ,含有控制字符触发Load Image 会触发报错\n            svgXml = svgXml.replace(/&nbsp;|[\\x00-\\x1F\\x7F-\\x9F]/g, "");\n            // fix title issue in safari\n            // @ http://stackoverflow.com/questions/30273775/namespace-prefix-ns1-for-href-on-tagelement-is-not-defined-setattributens\n            svgXml = svgXml.replace(/NS\\d+:title/gi, "xlink:title");\n            blob = new Blob([ svgXml ], {\n                type: "image/svg+xml"\n            });\n            svgUrl = DomURL.createObjectURL(blob);\n            //svgUrl = \'data:image/svg+xml;charset=utf-8,\' + encodeURIComponent(svgXml);\n            var imagesInfo = [];\n            // 遍历取出图片信息\n            traverse(minder.getRoot());\n            function traverse(node) {\n                var nodeData = node.data;\n                if (nodeData.image) {\n                    minder.renderNode(node);\n                    var nodeData = node.data;\n                    var imageUrl = nodeData.image;\n                    var imageSize = nodeData.imageSize;\n                    var imageRenderBox = node.getRenderBox("ImageRenderer", minder.getRenderContainer());\n                    var imageInfo = {\n                        url: imageUrl,\n                        width: imageSize.width,\n                        height: imageSize.height,\n                        x: -renderContainer.getBoundaryBox().x + imageRenderBox.x,\n                        y: -renderContainer.getBoundaryBox().y + imageRenderBox.y\n                    };\n                    imagesInfo.push(imageInfo);\n                }\n                // 若节点折叠，则直接返回\n                if (nodeData.expandState === "collapse") {\n                    return;\n                }\n                var children = node.getChildren();\n                for (var i = 0; i < children.length; i++) {\n                    traverse(children[i]);\n                }\n            }\n            return {\n                width: width,\n                height: height,\n                dataUrl: svgUrl,\n                xml: svgXml,\n                imagesInfo: imagesInfo\n            };\n        }\n        function encode(json, minder, option) {\n            var resultCallback;\n            /* 绘制 PNG 的画布及上下文 */\n            var canvas = document.createElement("canvas");\n            var ctx = canvas.getContext("2d");\n            /* 尝试获取背景图片 URL 或背景颜色 */\n            var bgDeclare = minder.getStyle("background").toString();\n            var bgUrl = /url\\(\\"(.+)\\"\\)/.exec(bgDeclare);\n            var bgColor = kity.Color.parse(bgDeclare);\n            /* 获取 SVG 文件内容 */\n            var svgInfo = getSVGInfo(minder);\n            var width = option && option.width && option.width > svgInfo.width ? option.width : svgInfo.width;\n            var height = option && option.height && option.height > svgInfo.height ? option.height : svgInfo.height;\n            var offsetX = option && option.width && option.width > svgInfo.width ? (option.width - svgInfo.width) / 2 : 0;\n            var offsetY = option && option.height && option.height > svgInfo.height ? (option.height - svgInfo.height) / 2 : 0;\n            var svgDataUrl = svgInfo.dataUrl;\n            var imagesInfo = svgInfo.imagesInfo;\n            /* 画布的填充大小 */\n            var padding = 20;\n            canvas.width = width + padding * 2;\n            canvas.height = height + padding * 2;\n            function fillBackground(ctx, style) {\n                ctx.save();\n                ctx.fillStyle = style;\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n                ctx.restore();\n            }\n            function drawImage(ctx, image, x, y, width, height) {\n                if (width && height) {\n                    ctx.drawImage(image, x + padding, y + padding, width, height);\n                } else {\n                    ctx.drawImage(image, x + padding, y + padding);\n                }\n            }\n            function generateDataUrl(canvas) {\n                return canvas.toDataURL("image/png");\n            }\n            // 加载节点上的图片\n            function loadImages(imagesInfo) {\n                var imagePromises = imagesInfo.map(function(imageInfo) {\n                    return xhrLoadImage(imageInfo);\n                });\n                return Promise.all(imagePromises);\n            }\n            function drawSVG() {\n                var svgData = {\n                    url: svgDataUrl\n                };\n                return loadImage(svgData).then(function($image) {\n                    drawImage(ctx, $image.element, offsetX, offsetY, $image.width, $image.height);\n                    return loadImages(imagesInfo);\n                }).then(function($images) {\n                    for (var i = 0; i < $images.length; i++) {\n                        drawImage(ctx, $images[i].element, $images[i].x + offsetX, $images[i].y + offsetY, $images[i].width, $images[i].height);\n                    }\n                    DomURL.revokeObjectURL(svgDataUrl);\n                    document.body.appendChild(canvas);\n                    var pngBase64 = generateDataUrl(canvas);\n                    document.body.removeChild(canvas);\n                    return pngBase64;\n                }, function(err) {\n                    // 这里处理 reject，出错基本上是因为跨域，\n                    // 出错后依然导出，只不过没有图片。\n                    alert("脑图的节点中包含跨域图片，导出的 png 中节点图片不显示，你可以替换掉这些跨域的图片并重试。");\n                    DomURL.revokeObjectURL(svgDataUrl);\n                    document.body.appendChild(canvas);\n                    var pngBase64 = generateDataUrl(canvas);\n                    document.body.removeChild(canvas);\n                    return pngBase64;\n                });\n            }\n            if (bgUrl) {\n                var bgInfo = {\n                    url: bgUrl[1]\n                };\n                return loadImage(bgInfo).then(function($image) {\n                    fillBackground(ctx, ctx.createPattern($image.element, "repeat"));\n                    return drawSVG();\n                });\n            } else {\n                fillBackground(ctx, bgColor.toString());\n                return drawSVG();\n            }\n        }\n        data.registerProtocol("png", module.exports = {\n            fileDescription: "PNG 图片",\n            fileExtension: ".png",\n            mineType: "image/png",\n            dataType: "base64",\n            encode: encode\n        });\n    }\n};\n\n//src/protocol/svg.js\n_p[67] = {\n    value: function(require, exports, module) {\n        var data = _p.r(12);\n        /**\n     * 导出svg时删除全部svg元素中的transform\n     * @auth Naixor\n     * @method removeTransform\n     * @param  {[type]}        svgDom [description]\n     * @return {[type]}               [description]\n     */\n        function cleanSVG(svgDom, x, y) {\n            function getTransformToElement(target, source) {\n                var matrix;\n                try {\n                    matrix = source.getScreenCTM().inverse();\n                } catch (e) {\n                    throw new Error("Can not inverse source element\' ctm.");\n                }\n                return matrix.multiply(target.getScreenCTM());\n            }\n            function dealWithPath(d, dealWithPattern) {\n                if (!(dealWithPattern instanceof Function)) {\n                    dealWithPattern = function() {};\n                }\n                var strArr = [], pattern = [], cache = [];\n                for (var i = 0, l = d.length; i < l; i++) {\n                    switch (d[i]) {\n                      case "M":\n                      case "L":\n                      case "T":\n                      case "S":\n                      case "A":\n                      case "C":\n                      case "H":\n                      case "V":\n                      case "Q":\n                        {\n                            if (cache.length) {\n                                pattern.push(cache.join(""));\n                                cache = [];\n                            }\n                            // 脑图的path格式真奇怪...偶尔就给我蹦出来一个"..V123 C..", 那空格几个意思 - -\n                            if (pattern[pattern.length - 1] === ",") {\n                                pattern.pop();\n                            }\n                            if (pattern.length) {\n                                dealWithPattern(pattern);\n                                strArr.push(pattern.join(""));\n                                pattern = [];\n                            }\n                            pattern.push(d[i]);\n                            break;\n                        }\n\n                      case "Z":\n                      case "z":\n                        {\n                            pattern.push(cache.join(""), d[i]);\n                            dealWithPattern(pattern);\n                            strArr.push(pattern.join(""));\n                            cache = [];\n                            pattern = [];\n                            break;\n                        }\n\n                      case ".":\n                      case "e":\n                        {\n                            cache.push(d[i]);\n                            break;\n                        }\n\n                      case "-":\n                        {\n                            if (d[i - 1] !== "e") {\n                                if (cache.length) {\n                                    pattern.push(cache.join(""), ",");\n                                }\n                                cache = [];\n                            }\n                            cache.push("-");\n                            break;\n                        }\n\n                      case " ":\n                      case ",":\n                        {\n                            if (cache.length) {\n                                pattern.push(cache.join(""), ",");\n                                cache = [];\n                            }\n                            break;\n                        }\n\n                      default:\n                        {\n                            if (/\\d/.test(d[i])) {\n                                cache.push(d[i]);\n                            } else {\n                                // m a c s q h v l t z情况\n                                if (cache.length) {\n                                    pattern.push(cache.join(""), d[i]);\n                                    cache = [];\n                                } else {\n                                    // 脑图的path格式真奇怪...偶尔就给我蹦出来一个"..V123 c..", 那空格几个意思 - -\n                                    if (pattern[pattern.length - 1] === ",") {\n                                        pattern.pop();\n                                    }\n                                    pattern.push(d[i]);\n                                }\n                            }\n                            if (i + 1 === l) {\n                                if (cache.length) {\n                                    pattern.push(cache.join(""));\n                                }\n                                dealWithPattern(pattern);\n                                strArr.push(pattern.join(""));\n                                cache = null;\n                                pattern = null;\n                            }\n                        }\n                    }\n                }\n                return strArr.join("");\n            }\n            function replaceWithNode(svgNode, parentX, parentY) {\n                if (!svgNode) {\n                    return;\n                }\n                if (svgNode.tagName === "defs") {\n                    return;\n                }\n                if (svgNode.getAttribute("fill") === "transparent") {\n                    svgNode.setAttribute("fill", "none");\n                }\n                if (svgNode.getAttribute("marker-end")) {\n                    svgNode.removeAttribute("marker-end");\n                }\n                parentX = parentX || 0;\n                parentY = parentY || 0;\n                if (svgNode.getAttribute("transform")) {\n                    var ctm = getTransformToElement(svgNode, svgNode.parentElement);\n                    parentX -= ctm.e;\n                    parentY -= ctm.f;\n                    svgNode.removeAttribute("transform");\n                }\n                switch (svgNode.tagName.toLowerCase()) {\n                  case "g":\n                    break;\n\n                  case "path":\n                    {\n                        var d = svgNode.getAttribute("d");\n                        if (d) {\n                            d = dealWithPath(d, function(pattern) {\n                                switch (pattern[0]) {\n                                  case "V":\n                                    {\n                                        pattern[1] = +pattern[1] - parentY;\n                                        break;\n                                    }\n\n                                  case "H":\n                                    {\n                                        pattern[1] = +pattern[1] - parentX;\n                                        break;\n                                    }\n\n                                  case "M":\n                                  case "L":\n                                  case "T":\n                                    {\n                                        pattern[1] = +pattern[1] - parentX;\n                                        pattern[3] = +pattern[3] - parentY;\n                                        break;\n                                    }\n\n                                  case "Q":\n                                  case "S":\n                                    {\n                                        pattern[1] = +pattern[1] - parentX;\n                                        pattern[3] = +pattern[3] - parentY;\n                                        pattern[5] = +pattern[5] - parentX;\n                                        pattern[7] = +pattern[7] - parentY;\n                                        break;\n                                    }\n\n                                  case "A":\n                                    {\n                                        pattern[11] = +pattern[11] - parentX;\n                                        pattern[13] = +pattern[13] - parentY;\n                                        break;\n                                    }\n\n                                  case "C":\n                                    {\n                                        pattern[1] = +pattern[1] - parentX;\n                                        pattern[3] = +pattern[3] - parentY;\n                                        pattern[5] = +pattern[5] - parentX;\n                                        pattern[7] = +pattern[7] - parentY;\n                                        pattern[9] = +pattern[9] - parentX;\n                                        pattern[11] = +pattern[11] - parentY;\n                                    }\n                                }\n                            });\n                            svgNode.setAttribute("d", d);\n                            svgNode.removeAttribute("transform");\n                        }\n                        return;\n                    }\n\n                  case "image":\n                  case "text":\n                    {\n                        if (parentX && parentY) {\n                            var x = +svgNode.getAttribute("x") || 0, y = +svgNode.getAttribute("y") || 0;\n                            svgNode.setAttribute("x", x - parentX);\n                            svgNode.setAttribute("y", y - parentY);\n                        }\n                        if (svgNode.getAttribute("dominant-baseline")) {\n                            svgNode.removeAttribute("dominant-baseline");\n                            svgNode.setAttribute("dy", ".8em");\n                        }\n                        svgNode.removeAttribute("transform");\n                        return;\n                    }\n                }\n                if (svgNode.children) {\n                    for (var i = 0, l = svgNode.children.length; i < l; i++) {\n                        replaceWithNode(svgNode.children[i], parentX, parentY);\n                    }\n                }\n            }\n            svgDom.style.visibility = "hidden";\n            replaceWithNode(svgDom, x || 0, y || 0);\n            svgDom.style.visibility = "visible";\n        }\n        data.registerProtocol("svg", module.exports = {\n            fileDescription: "SVG 矢量图",\n            fileExtension: ".svg",\n            mineType: "image/svg+xml",\n            dataType: "text",\n            encode: function(json, minder) {\n                var paper = minder.getPaper(), paperTransform = paper.shapeNode.getAttribute("transform"), svgXml, svgContainer, svgDom, renderContainer = minder.getRenderContainer(), renderBox = renderContainer.getRenderBox(), transform = renderContainer.getTransform(), width = renderBox.width, height = renderBox.height, padding = 20;\n                paper.shapeNode.setAttribute("transform", "translate(0.5, 0.5)");\n                svgXml = paper.container.innerHTML;\n                paper.shapeNode.setAttribute("transform", paperTransform);\n                svgContainer = document.createElement("div");\n                document.body.appendChild(svgContainer);\n                svgContainer.innerHTML = svgXml;\n                svgDom = svgContainer.querySelector("svg");\n                svgDom.setAttribute("width", width + padding * 2 | 0);\n                svgDom.setAttribute("height", height + padding * 2 | 0);\n                svgDom.setAttribute("style", "background: " + minder.getStyle("background"));\n                //"font-family: Arial, Microsoft Yahei, Heiti SC; " +\n                svgDom.setAttribute("viewBox", [ 0, 0, width + padding * 2 | 0, height + padding * 2 | 0 ].join(" "));\n                tempSvgContainer = document.createElement("div");\n                cleanSVG(svgDom, renderBox.x - padding | 0, renderBox.y - padding | 0);\n                document.body.removeChild(svgContainer);\n                tempSvgContainer.appendChild(svgDom);\n                // need a xml with width and height\n                svgXml = tempSvgContainer.innerHTML;\n                // svg 含有 &nbsp; 符号导出报错 Entity \'nbsp\' not defined\n                svgXml = svgXml.replace(/&nbsp;/g, "&#xa0;");\n                // svg 含有 &nbsp; 符号导出报错 Entity \'nbsp\' not defined\n                return svgXml;\n            }\n        });\n    }\n};\n\n//src/protocol/text.js\n_p[68] = {\n    value: function(require, exports, module) {\n        var data = _p.r(12);\n        var Browser = _p.r(17).Browser;\n        /**\n     * @Desc: 增加对不容浏览器下节点中文本\\t匹配的处理，不同浏览器下\\t无法正确匹配，导致无法使用TAB来批量导入节点\n     * @Editor: Naixor\n     * @Date: 2015.9.17\n     */\n        var LINE_ENDING = "\\r", LINE_ENDING_SPLITER = /\\r\\n|\\r|\\n/, TAB_CHAR = function(Browser) {\n            if (Browser.gecko) {\n                return {\n                    REGEXP: new RegExp("^(\\t|" + String.fromCharCode(160, 160, 32, 160) + ")"),\n                    DELETE: new RegExp("^(\\t|" + String.fromCharCode(160, 160, 32, 160) + ")+")\n                };\n            } else if (Browser.ie || Browser.edge) {\n                // ie系列和edge比较特别，\\t在div中会被直接转义成SPACE故只好使用SPACE来做处理\n                return {\n                    REGEXP: new RegExp("^(" + String.fromCharCode(32) + "|" + String.fromCharCode(160) + ")"),\n                    DELETE: new RegExp("^(" + String.fromCharCode(32) + "|" + String.fromCharCode(160) + ")+")\n                };\n            } else {\n                return {\n                    REGEXP: /^(\\t|\\x20{4})/,\n                    DELETE: /^(\\t|\\x20{4})+/\n                };\n            }\n        }(Browser);\n        function repeat(s, n) {\n            var result = "";\n            while (n--) result += s;\n            return result;\n        }\n        /**\n     * 对节点text中的换行符进行处理\n     * @method encodeWrap\n     * @param  {String}   nodeText MinderNode.data.text\n     * @return {String}            \\n -> \'\\n\'; \\\\n -> \'\\\\n\'\n     */\n        function encodeWrap(nodeText) {\n            if (!nodeText) {\n                return "";\n            }\n            var textArr = [], WRAP_TEXT = [ "\\\\", "n" ];\n            for (var i = 0, j = 0, l = nodeText.length; i < l; i++) {\n                if (nodeText[i] === "\\n" || nodeText[i] === "\\r") {\n                    textArr.push("\\\\n");\n                    j = 0;\n                    continue;\n                }\n                if (nodeText[i] === WRAP_TEXT[j]) {\n                    j++;\n                    if (j === 2) {\n                        j = 0;\n                        textArr.push("\\\\\\\\n");\n                    }\n                    continue;\n                }\n                switch (j) {\n                  case 0:\n                    {\n                        textArr.push(nodeText[i]);\n                        break;\n                    }\n\n                  case 1:\n                    {\n                        textArr.push(nodeText[i - 1], nodeText[i]);\n                    }\n                }\n                j = 0;\n            }\n            return textArr.join("");\n        }\n        /**\n     * 将文本内容中的\'\\n\'和\'\\\\n\'分别转换成\\n和\\\\n\n     * @method decodeWrap\n     * @param  {[type]}   text [description]\n     * @return {[type]}        [description]\n     */\n        function decodeWrap(text) {\n            if (!text) {\n                return "";\n            }\n            var textArr = [], WRAP_TEXT = [ "\\\\", "\\\\", "n" ];\n            for (var i = 0, j = 0, l = text.length; i < l; i++) {\n                if (text[i] === WRAP_TEXT[j]) {\n                    j++;\n                    if (j === 3) {\n                        j = 0;\n                        textArr.push("\\\\n");\n                    }\n                    continue;\n                }\n                switch (j) {\n                  case 0:\n                    {\n                        textArr.push(text[i]);\n                        j = 0;\n                        break;\n                    }\n\n                  case 1:\n                    {\n                        if (text[i] === "n") {\n                            textArr.push("\\n");\n                        } else {\n                            textArr.push(text[i - 1], text[i]);\n                        }\n                        j = 0;\n                        break;\n                    }\n\n                  case 2:\n                    {\n                        textArr.push(text[i - 2]);\n                        if (text[i] !== "\\\\") {\n                            j = 0;\n                            textArr.push(text[i - 1], text[i]);\n                        }\n                        break;\n                    }\n                }\n            }\n            return textArr.join("");\n        }\n        function encode(json, level) {\n            var local = "";\n            level = level || 0;\n            local += repeat("\\t", level);\n            local += encodeWrap(json.data.text) + LINE_ENDING;\n            if (json.children) {\n                json.children.forEach(function(child) {\n                    local += encode(child, level + 1);\n                });\n            }\n            return local;\n        }\n        function isEmpty(line) {\n            return !/\\S/.test(line);\n        }\n        function getLevel(line) {\n            var level = 0;\n            while (TAB_CHAR.REGEXP.test(line)) {\n                line = line.replace(TAB_CHAR.REGEXP, "");\n                level++;\n            }\n            return level;\n        }\n        function getNode(line) {\n            return {\n                data: {\n                    text: decodeWrap(line.replace(TAB_CHAR.DELETE, ""))\n                }\n            };\n        }\n        function decode(local) {\n            var json, parentMap = {}, lines = local.split(LINE_ENDING_SPLITER), line, level, node;\n            function addChild(parent, child) {\n                var children = parent.children || (parent.children = []);\n                children.push(child);\n            }\n            for (var i = 0; i < lines.length; i++) {\n                line = lines[i];\n                if (isEmpty(line)) continue;\n                level = getLevel(line);\n                node = getNode(line);\n                if (level === 0) {\n                    if (json) {\n                        throw new Error("Invalid local format");\n                    }\n                    json = node;\n                } else {\n                    if (!parentMap[level - 1]) {\n                        throw new Error("Invalid local format");\n                    }\n                    addChild(parentMap[level - 1], node);\n                }\n                parentMap[level] = node;\n            }\n            return json;\n        }\n        /**\n     * @Desc: 增加一个将当前选中节点转换成text的方法\n     * @Editor: Naixor\n     * @Date: 2015.9.21\n     */\n        function Node2Text(node) {\n            function exportNode(node) {\n                var exported = {};\n                exported.data = node.getData();\n                var childNodes = node.getChildren();\n                exported.children = [];\n                for (var i = 0; i < childNodes.length; i++) {\n                    exported.children.push(exportNode(childNodes[i]));\n                }\n                return exported;\n            }\n            if (!node) return;\n            if (/^\\s*$/.test(node.data.text)) {\n                node.data.text = "分支主题";\n            }\n            return encode(exportNode(node));\n        }\n        data.registerProtocol("text", module.exports = {\n            fileDescription: "大纲文本",\n            fileExtension: ".txt",\n            dataType: "text",\n            mineType: "text/plain",\n            encode: function(json) {\n                return encode(json.root, 0);\n            },\n            decode: function(local) {\n                return decode(local);\n            },\n            Node2Text: function(node) {\n                return Node2Text(node);\n            }\n        });\n    }\n};\n\n//src/template/default.js\n/**\n * @fileOverview\n *\n * 默认模板 - 脑图模板\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[69] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("default", {\n            getLayout: function(node) {\n                if (node.getData("layout")) return node.getData("layout");\n                var level = node.getLevel();\n                // 根节点\n                if (level === 0) {\n                    return "mind";\n                }\n                // 一级节点\n                if (level === 1) {\n                    return node.getLayoutPointPreview().x > 0 ? "right" : "left";\n                }\n                return node.parent.getLayout();\n            },\n            getConnect: function(node) {\n                if (node.getLevel() == 1) return "arc";\n                return "under";\n            }\n        });\n    }\n};\n\n//src/template/filetree.js\n/**\n * @fileOverview\n *\n * 文件夹模板\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[70] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("filetree", {\n            getLayout: function(node) {\n                if (node.getData("layout")) return node.getData("layout");\n                if (node.isRoot()) return "bottom";\n                return "filetree-down";\n            },\n            getConnect: function(node) {\n                if (node.getLevel() == 1) {\n                    return "poly";\n                }\n                return "l";\n            }\n        });\n    }\n};\n\n//src/template/fish-bone.js\n/**\n * @fileOverview\n *\n * 默认模板 - 鱼骨头模板\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[71] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("fish-bone", {\n            getLayout: function(node) {\n                if (node.getData("layout")) return node.getData("layout");\n                var level = node.getLevel();\n                // 根节点\n                if (level === 0) {\n                    return "fish-bone-master";\n                }\n                // 一级节点\n                if (level === 1) {\n                    return "fish-bone-slave";\n                }\n                return node.getLayoutPointPreview().y > 0 ? "filetree-up" : "filetree-down";\n            },\n            getConnect: function(node) {\n                switch (node.getLevel()) {\n                  case 1:\n                    return "fish-bone-master";\n\n                  case 2:\n                    return "line";\n\n                  default:\n                    return "l";\n                }\n            }\n        });\n    }\n};\n\n//src/template/right.js\n/**\n * @fileOverview\n *\n * 往右布局结构模板\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[72] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("right", {\n            getLayout: function(node) {\n                return node.getData("layout") || "right";\n            },\n            getConnect: function(node) {\n                if (node.getLevel() == 1) return "arc";\n                return "bezier";\n            }\n        });\n    }\n};\n\n//src/template/structure.js\n/**\n * @fileOverview\n *\n * 组织结构图模板\n *\n * @author: techird\n * @copyright: Baidu FEX, 2014\n */\n_p[73] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("structure", {\n            getLayout: function(node) {\n                return node.getData("layout") || "bottom";\n            },\n            getConnect: function(node) {\n                return "poly";\n            }\n        });\n    }\n};\n\n//src/template/tianpan.js\n/**\n * @fileOverview\n *\n * 天盘模板\n *\n * @author: along\n * @copyright: bpd729@163.com, 2015\n */\n_p[74] = {\n    value: function(require, exports, module) {\n        var template = _p.r(31);\n        template.register("tianpan", {\n            getLayout: function(node) {\n                if (node.getData("layout")) return node.getData("layout");\n                var level = node.getLevel();\n                // 根节点\n                if (level === 0) {\n                    return "tianpan";\n                }\n                return node.parent.getLayout();\n            },\n            getConnect: function(node) {\n                return "arc_tp";\n            }\n        });\n    }\n};\n\n//src/theme/default.js\n_p[75] = {\n    value: function(require, exports, module) {\n        var theme = _p.r(32);\n        [ "classic", "classic-compact" ].forEach(function(name) {\n            var compact = name == "classic-compact";\n            /* jscs:disable maximumLineLength */\n            theme.register(name, {\n                background: \'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat\',\n                "root-color": "#430",\n                "root-background": "#e9df98",\n                "root-stroke": "#e9df98",\n                "root-font-size": 24,\n                "root-padding": compact ? [ 10, 25 ] : [ 15, 25 ],\n                "root-margin": compact ? [ 15, 25 ] : [ 30, 100 ],\n                "root-radius": 30,\n                "root-space": 10,\n                "root-shadow": "rgba(0, 0, 0, .25)",\n                "main-color": "#333",\n                "main-background": "#a4c5c0",\n                "main-stroke": "#a4c5c0",\n                "main-font-size": 16,\n                "main-padding": compact ? [ 5, 15 ] : [ 6, 20 ],\n                "main-margin": compact ? [ 5, 10 ] : 20,\n                "main-radius": 10,\n                "main-space": 5,\n                "main-shadow": "rgba(0, 0, 0, .25)",\n                "sub-color": "white",\n                "sub-background": "transparent",\n                "sub-stroke": "none",\n                "sub-font-size": 12,\n                "sub-padding": [ 5, 10 ],\n                "sub-margin": compact ? [ 5, 10 ] : [ 15, 20 ],\n                "sub-tree-margin": 30,\n                "sub-radius": 5,\n                "sub-space": 5,\n                "connect-color": "white",\n                "connect-width": 2,\n                "main-connect-width": 3,\n                "connect-radius": 5,\n                "selected-background": "rgb(254, 219, 0)",\n                "selected-stroke": "rgb(254, 219, 0)",\n                "selected-color": "black",\n                "marquee-background": "rgba(255,255,255,.3)",\n                "marquee-stroke": "white",\n                "drop-hint-color": "yellow",\n                "sub-drop-hint-width": 2,\n                "main-drop-hint-width": 4,\n                "root-drop-hint-width": 4,\n                "order-hint-area-color": "rgba(0, 255, 0, .5)",\n                "order-hint-path-color": "#0f0",\n                "order-hint-path-width": 1,\n                "text-selection-color": "rgb(27,171,255)",\n                "line-height": 1.5\n            });\n        });\n    }\n};\n\n//src/theme/fish.js\n_p[76] = {\n    value: function(require, exports, module) {\n        var theme = _p.r(32);\n        theme.register("fish", {\n            background: \'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat\',\n            "root-color": "#430",\n            "root-background": "#e9df98",\n            "root-stroke": "#e9df98",\n            "root-font-size": 24,\n            "root-padding": [ 35, 35 ],\n            "root-margin": 30,\n            "root-radius": 100,\n            "root-space": 10,\n            "root-shadow": "rgba(0, 0, 0, .25)",\n            "main-color": "#333",\n            "main-background": "#a4c5c0",\n            "main-stroke": "#a4c5c0",\n            "main-font-size": 16,\n            "main-padding": [ 6, 20 ],\n            "main-margin": [ 20, 20 ],\n            "main-radius": 5,\n            "main-space": 5,\n            "main-shadow": "rgba(0, 0, 0, .25)",\n            "sub-color": "black",\n            "sub-background": "white",\n            "sub-stroke": "white",\n            "sub-font-size": 12,\n            "sub-padding": [ 5, 10 ],\n            "sub-margin": [ 10 ],\n            "sub-radius": 5,\n            "sub-space": 5,\n            "connect-color": "white",\n            "connect-width": 3,\n            "main-connect-width": 3,\n            "connect-radius": 5,\n            "selected-background": "rgb(254, 219, 0)",\n            "selected-stroke": "rgb(254, 219, 0)",\n            "marquee-background": "rgba(255,255,255,.3)",\n            "marquee-stroke": "white",\n            "drop-hint-color": "yellow",\n            "drop-hint-width": 4,\n            "order-hint-area-color": "rgba(0, 255, 0, .5)",\n            "order-hint-path-color": "#0f0",\n            "order-hint-path-width": 1,\n            "text-selection-color": "rgb(27,171,255)",\n            "line-height": 1.5\n        });\n    }\n};\n\n//src/theme/fresh.js\n_p[77] = {\n    value: function(require, exports, module) {\n        var kity = _p.r(17);\n        var theme = _p.r(32);\n        function hsl(h, s, l) {\n            return kity.Color.createHSL(h, s, l);\n        }\n        function generate(h, compat) {\n            return {\n                background: "#fbfbfb",\n                "root-color": "white",\n                "root-background": hsl(h, 37, 60),\n                "root-stroke": hsl(h, 37, 60),\n                "root-font-size": 16,\n                "root-padding": compat ? [ 6, 12 ] : [ 12, 24 ],\n                "root-margin": compat ? 10 : [ 30, 100 ],\n                "root-radius": 5,\n                "root-space": 10,\n                "main-color": "black",\n                "main-background": hsl(h, 33, 95),\n                "main-stroke": hsl(h, 37, 60),\n                "main-stroke-width": 1,\n                "main-font-size": 14,\n                "main-padding": [ 6, 20 ],\n                "main-margin": compat ? 8 : 20,\n                "main-radius": 3,\n                "main-space": 5,\n                "sub-color": "black",\n                "sub-background": "transparent",\n                "sub-stroke": "none",\n                "sub-font-size": 12,\n                "sub-padding": compat ? [ 3, 5 ] : [ 5, 10 ],\n                "sub-margin": compat ? [ 4, 8 ] : [ 15, 20 ],\n                "sub-radius": 5,\n                "sub-space": 5,\n                "connect-color": hsl(h, 37, 60),\n                "connect-width": 1,\n                "connect-radius": 5,\n                "selected-stroke": hsl(h, 26, 30),\n                "selected-stroke-width": "3",\n                "blur-selected-stroke": hsl(h, 10, 60),\n                "marquee-background": hsl(h, 100, 80).set("a", .1),\n                "marquee-stroke": hsl(h, 37, 60),\n                "drop-hint-color": hsl(h, 26, 35),\n                "drop-hint-width": 5,\n                "order-hint-area-color": hsl(h, 100, 30).set("a", .5),\n                "order-hint-path-color": hsl(h, 100, 25),\n                "order-hint-path-width": 1,\n                "text-selection-color": hsl(h, 100, 20),\n                "line-height": 1.5\n            };\n        }\n        var plans = {\n            red: 0,\n            soil: 25,\n            green: 122,\n            blue: 204,\n            purple: 246,\n            pink: 334\n        };\n        var name;\n        for (name in plans) {\n            theme.register("fresh-" + name, generate(plans[name]));\n            theme.register("fresh-" + name + "-compat", generate(plans[name], true));\n        }\n    }\n};\n\n//src/theme/snow.js\n_p[78] = {\n    value: function(require, exports, module) {\n        var theme = _p.r(32);\n        [ "snow", "snow-compact" ].forEach(function(name) {\n            var compact = name == "snow-compact";\n            /* jscs:disable maximumLineLength */\n            theme.register(name, {\n                background: \'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat\',\n                "root-color": "#430",\n                "root-background": "#e9df98",\n                "root-stroke": "#e9df98",\n                "root-font-size": 24,\n                "root-padding": compact ? [ 5, 10 ] : [ 15, 25 ],\n                "root-margin": compact ? 15 : 30,\n                "root-radius": 5,\n                "root-space": 10,\n                "root-shadow": "rgba(0, 0, 0, .25)",\n                "main-color": "#333",\n                "main-background": "#a4c5c0",\n                "main-stroke": "#a4c5c0",\n                "main-font-size": 16,\n                "main-padding": compact ? [ 4, 10 ] : [ 6, 20 ],\n                "main-margin": compact ? [ 5, 10 ] : [ 20, 40 ],\n                "main-radius": 5,\n                "main-space": 5,\n                "main-shadow": "rgba(0, 0, 0, .25)",\n                "sub-color": "black",\n                "sub-background": "white",\n                "sub-stroke": "white",\n                "sub-font-size": 12,\n                "sub-padding": [ 5, 10 ],\n                "sub-margin": compact ? [ 5, 10 ] : [ 10, 20 ],\n                "sub-radius": 5,\n                "sub-space": 5,\n                "connect-color": "white",\n                "connect-width": 2,\n                "main-connect-width": 3,\n                "connect-radius": 5,\n                "selected-background": "rgb(254, 219, 0)",\n                "selected-stroke": "rgb(254, 219, 0)",\n                "marquee-background": "rgba(255,255,255,.3)",\n                "marquee-stroke": "white",\n                "drop-hint-color": "yellow",\n                "drop-hint-width": 4,\n                "order-hint-area-color": "rgba(0, 255, 0, .5)",\n                "order-hint-path-color": "#0f0",\n                "order-hint-path-width": 1,\n                "text-selection-color": "rgb(27,171,255)",\n                "line-height": 1.5\n            });\n        });\n    }\n};\n\n//src/theme/tianpan.js\n_p[79] = {\n    value: function(require, exports, module) {\n        var theme = _p.r(32);\n        [ "tianpan", "tianpan-compact" ].forEach(function(name) {\n            var compact = name == "tianpan-compact";\n            theme.register(name, {\n                background: \'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat\',\n                "root-color": "#430",\n                "root-background": "#e9df98",\n                "root-stroke": "#e9df98",\n                "root-font-size": 25,\n                "root-padding": compact ? 15 : 20,\n                "root-margin": compact ? [ 15, 25 ] : 100,\n                "root-radius": 30,\n                "root-space": 10,\n                "root-shadow": "rgba(0, 0, 0, .25)",\n                "root-shape": "circle",\n                "main-color": "#333",\n                "main-background": "#a4c5c0",\n                "main-stroke": "#a4c5c0",\n                "main-font-size": 15,\n                "main-padding": compact ? 10 : 12,\n                "main-margin": compact ? 10 : 12,\n                "main-radius": 10,\n                "main-space": 5,\n                "main-shadow": "rgba(0, 0, 0, .25)",\n                "main-shape": "circle",\n                "sub-color": "#333",\n                "sub-background": "#99ca6a",\n                "sub-stroke": "#a4c5c0",\n                "sub-font-size": 13,\n                "sub-padding": 5,\n                "sub-margin": compact ? 6 : 10,\n                "sub-tree-margin": 30,\n                "sub-radius": 5,\n                "sub-space": 5,\n                "sub-shadow": "rgba(0, 0, 0, .25)",\n                "sub-shape": "circle",\n                "connect-color": "white",\n                "connect-width": 2,\n                "main-connect-width": 3,\n                "connect-radius": 5,\n                "selected-background": "rgb(254, 219, 0)",\n                "selected-stroke": "rgb(254, 219, 0)",\n                "selected-color": "black",\n                "marquee-background": "rgba(255,255,255,.3)",\n                "marquee-stroke": "white",\n                "drop-hint-color": "yellow",\n                "sub-drop-hint-width": 2,\n                "main-drop-hint-width": 4,\n                "root-drop-hint-width": 4,\n                "order-hint-area-color": "rgba(0, 255, 0, .5)",\n                "order-hint-path-color": "#0f0",\n                "order-hint-path-width": 1,\n                "text-selection-color": "rgb(27,171,255)",\n                "line-height": 1.4\n            });\n        });\n    }\n};\n\n//src/theme/wire.js\n_p[80] = {\n    value: function(require, exports, module) {\n        var theme = _p.r(32);\n        theme.register("wire", {\n            background: "black",\n            color: "#999",\n            stroke: "none",\n            padding: 10,\n            margin: 20,\n            "font-size": 14,\n            "connect-color": "#999",\n            "connect-width": 1,\n            "selected-background": "#999",\n            "selected-color": "black",\n            "marquee-background": "rgba(255,255,255,.3)",\n            "marquee-stroke": "white",\n            "drop-hint-color": "yellow",\n            "sub-drop-hint-width": 2,\n            "main-drop-hint-width": 4,\n            "root-drop-hint-width": 4,\n            "order-hint-area-color": "rgba(0, 255, 0, .5)",\n            "order-hint-path-color": "#0f0",\n            "order-hint-path-width": 1,\n            "text-selection-color": "rgb(27,171,255)",\n            "line-height": 1.5\n        });\n    }\n};\n\nvar moduleMapping = {\n    "expose-kityminder": 34\n};\n\nfunction use(name) {\n    _p.r([ moduleMapping[name] ]);\n}\nuse(\'expose-kityminder\');\n})();\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("8oxB")))\n\n//# sourceURL=webpack:///./kityminder-core/dist/kityminder.core.js?')},oOAV:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var png = __webpack_require__(\"HRQ7\");\n  var svg = __webpack_require__(\"AsA8\");\n  var json = __webpack_require__(\"JqqP\");\n  var plain = __webpack_require__(\"GX2X\");\n  var md = __webpack_require__(\"403d\");\n  var mm = __webpack_require__(\"CYm2\");\n\n  function ExportRuntime() {\n    var minder = this.minder;\n    var hotbox = this.hotbox;\n    var exps = [{ label: '.json', key: 'j', cmd: exportJson }, { label: '.png', key: 'p', cmd: exportImage }, { label: '.svg', key: 's', cmd: exportSVG }, { label: '.txt', key: 't', cmd: exportTextTree }, { label: '.md', key: 'm', cmd: exportMarkdown }, { label: '.mm', key: 'f', cmd: exportFreeMind }];\n\n    var main = hotbox.state('main');\n    main.button({\n      position: 'top',\n      label: '导出',\n      key: 'E',\n      enable: canExp,\n      next: 'exp'\n    });\n\n    var exp = hotbox.state('exp');\n    exps.forEach(function (item) {\n      exp.button({\n        position: 'ring',\n        label: item.label,\n        key: null,\n        action: item.cmd\n      });\n    });\n\n    exp.button({\n      position: 'center',\n      label: '取消',\n      key: 'esc',\n      next: 'back'\n    });\n\n    function canExp() {\n      return true;\n    }\n\n    function exportJson() {\n      json.exportJson(minder);\n    }\n\n    function exportImage() {\n      png.exportPNGImage(minder);\n    }\n\n    function exportSVG() {\n      svg.exportSVG(minder);\n    }\n\n    function exportTextTree() {\n      plain.exportTextTree(minder);\n    }\n\n    function exportMarkdown() {\n      md.exportMarkdown(minder);\n    }\n\n    function exportFreeMind() {\n      mm.exportFreeMind(minder);\n    }\n  }\n\n  return module.exports = ExportRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/exports.js?")},qZ1r:function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/views/login.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},t3Un:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("vDqi");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("X4fA");\n/* harmony import */ var element_ui__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("X3IP");\n/* harmony import */ var element_ui__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(element_ui__WEBPACK_IMPORTED_MODULE_2__);\nvar _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };\n\n\n\n\n\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.baseURL = "http://182.92.113.4:4000";\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.timeout = 10000;\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.withCredentials = false;\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.headers[\'X-Requested-With\'] = \'XMLHttpRequest\';\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.headers.post[\'Content-Type\'] = \'application/json\';\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.headers[\'Access-Control-Allow-Origin\'] = \'*\';\n\n// 响应拦截\n\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.interceptors.request.use(function (config) {\n  config.headers[\'Authorization\'] = Object(_utils_auth__WEBPACK_IMPORTED_MODULE_1__[/* getToken */ "a"])();\n  return config;\n}, function (error) {\n  console.log(error);\n  Promise.reject(error);\n});\n\naxios__WEBPACK_IMPORTED_MODULE_0___default.a.interceptors.response.use(function (res) {\n  if (_typeof(res.data) !== \'object\') {\n    element_ui__WEBPACK_IMPORTED_MODULE_2__["Message"].error(\'服务端异常！\');\n    return Promise.reject(res);\n  }\n  if (res.data.code != "00000") {\n    if (res.data.message) {\n      element_ui__WEBPACK_IMPORTED_MODULE_2__["Message"].error(res.data.message);\n    }\n\n    return Promise.reject(res.data);\n  }\n\n  return Promise.resolve(res.data);\n}, function (error) {\n  element_ui__WEBPACK_IMPORTED_MODULE_2__["Message"].error(\'网络异常！\');\n  console.log(error);\n  Promise.reject(error);\n});\n\n/* harmony default export */ __webpack_exports__["a"] = (axios__WEBPACK_IMPORTED_MODULE_0___default.a);\n\n//# sourceURL=webpack:///./src/utils/request.js?')},vaHd:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, module) {\n  var key = __webpack_require__(\"/qK9\");\n  var hotbox = __webpack_require__(\"bSn8\");\n\n  function ReceiverRuntime() {\n    var fsm = this.fsm;\n    var minder = this.minder;\n    var me = this;\n\n    // 接收事件的 div\n    var element = document.createElement('div');\n    element.contentEditable = true;\n    element.setAttribute(\"tabindex\", -1);\n    element.classList.add('receiver');\n    element.onkeydown = element.onkeypress = element.onkeyup = dispatchKeyEvent;\n    this.container.appendChild(element);\n\n    // receiver 对象\n    var receiver = {\n      element: element,\n      selectAll: function selectAll() {\n        // 保证有被选中的\n        if (!element.innerHTML) element.innerHTML = '&nbsp;';\n        var range = document.createRange();\n        var selection = window.getSelection();\n        range.selectNodeContents(element);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        element.focus();\n      },\n      enable: function enable() {\n        element.setAttribute(\"contenteditable\", true);\n      },\n      disable: function disable() {\n        element.setAttribute(\"contenteditable\", false);\n      },\n      fixFFCaretDisappeared: function fixFFCaretDisappeared() {\n        element.removeAttribute(\"contenteditable\");\n        element.setAttribute(\"contenteditable\", \"true\");\n        element.blur();\n        element.focus();\n      },\n      onblur: function onblur(handler) {\n        element.onblur = handler;\n      }\n    };\n    receiver.selectAll();\n    minder.on('beforemousedown', receiver.selectAll);\n    minder.on('receiverfocus', receiver.selectAll);\n    minder.on('readonly', function () {\n      // 屏蔽minder的事件接受，删除receiver和hotbox\n      minder.disable();\n      editor.receiver.element.parentElement.removeChild(editor.receiver.element);\n      editor.hotbox.$container.removeChild(editor.hotbox.$element);\n    });\n\n    // 侦听器，接收到的事件会派发给所有侦听器\n    var listeners = [];\n\n    // 侦听指定状态下的事件，如果不传 state，侦听所有状态\n    receiver.listen = function (state, listener) {\n      if (arguments.length == 1) {\n        listener = state;\n        state = '*';\n      }\n      listener.notifyState = state;\n      listeners.push(listener);\n    };\n\n    function dispatchKeyEvent(e) {\n      e.is = function (keyExpression) {\n        var subs = keyExpression.split('|');\n        for (var i = 0; i < subs.length; i++) {\n          if (key.is(this, subs[i])) return true;\n        }\n        return false;\n      };\n      var listener, jumpState;\n      for (var i = 0; i < listeners.length; i++) {\n\n        listener = listeners[i];\n        // 忽略不在侦听状态的侦听器\n        if (listener.notifyState != '*' && listener.notifyState != fsm.state()) {\n          continue;\n        }\n\n        if (listener.call(null, e)) {\n          return;\n        }\n      }\n    }\n\n    this.receiver = receiver;\n  }\n\n  return module.exports = ReceiverRuntime;\n}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n//# sourceURL=webpack:///./src/script/runtime/receiver.js?")},"ws/B":function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/views/find.vue?./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader??ref--7-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src!./node_modules/vue-loader/lib??vue-loader-options")},xeH2:function(module,exports){eval("module.exports = jQuery;\n\n//# sourceURL=webpack:///external_%22jQuery%22?")}},[["Vtdi",3,0]]]);